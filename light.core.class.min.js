/*
 * light.core.class.js Library for JavaScript v0.4.9.1
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 09-09-2012
 */
(function(t,B,q,u,C){function x(){}function h(){function b(){var c=0===+this,k=arguments,e=u,h=new p,f=h,n=c?k[0]:{a:h};if(w){w=y(w,D,b);var l=function(){};l.prototype=e=w.call(q,n);f=new l}E||(h.parent=e);if(w||c)r(h,function(i,a){if(typeof a==="function"&&!E){f[i]=function(){var i=n.a.parent,b=n.a.__class__;n.a.parent=h.parent;n.a.__class__=f.__class__;var g=a.apply(this===f||this==t?n.a:this,arguments);n.a.__class__=b;n.a.parent=i;return g};f[i].toString=function(){return a.toString()}}else f[i]=
a}),n.a=c?n.a:f;E||(f.__class__=f.__static__=b);for(e=0;e<B;e++)z[e]=y(z[e],D,b),r(z[e].call(q,n),function(i,a){f[i]===C&&(f[i]=a)},1);if(!c&&0!==j)if(F){if(G){if(a===q){a="StaticClass"+M+F++;var m=[],s=0,v=["Class "+a];r(f,function(i,a){var d=i.indexOf("$")===0?1:i.indexOf("get ")===0?2:i.indexOf("set ")===0?3:i==="toString"?4:a&&typeof a==="object"&&(a.set||a.get)?5:0;if(d){d!==4&&(j[i]=a);var b=d===4?"("+i+")":(s=1)&&d===1?i.substring(1):d===5?i:i.split(" ").pop();d!==3&&v.push("Public "+(d===
4?"Default ":"")+"Property Get ["+b+"]","Call VBCorrectVal("+(d===1?f.__get?'me.[__get].call(me,"'+b+'")':"":j[i]&&(d!==5||j[i].get)?(d===4?"me":"[(accessors)]")+".["+i+"]"+(d===5?".get":"")+".call(me)":"window.undefined")+",["+b+"])","End Property");d&1&&v.push("Public Property Let ["+b+"](val)",d=(d===1?f.__set?'Call me.[__set].call(me,"'+b+'",val)':"":j[i]&&(d!==5||j[i].set)?"Call [(accessors)].["+i+"]"+(d===5?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+b+"](val)",d)}if(!d||
d===4){if(m.length===50){v.push("Public ["+m.join("],[")+"]");m.length=0}m[m.length]=i}},1);s?(v.push("Public ["+m.join("],[")+"]","Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+a+"FactoryJS()","End Sub","End Class","Function "+a+"Factory()","Set "+a+"Factory=New "+a,"End Function"),t[a+"FactoryJS"]=function(){return g},execVBScript(v.join("\n"))):(j=0,a=u);m=v=u}a&&(g={},r(j,function(a){g[a]=f[a]}),n.a=t[a+"Factory"](),r(f,function(a,b){j.hasOwnProperty(a)||(n.a[a]=
b)},1),f=n.a)}}else if(r(o?f:j,function(a,b){var d=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(d){if(o){j[a]=b;g++}b=f[a];H.call(f,a)&&delete f[a];var c=d===1?a.substring(1):d===5?a:a.split(" ").pop(),e={enumerable:1,configurable:1,set:u,get:u};if(d!==3)e.get=function(){return((d===1?f.__get:d===5?b.get:b)||x).call(this,d===1?c:C)};if(d&1)e.set=function(a){((d===1?f.__set:d===5?b.set:b)||x).call(this,d===1?c:a,d===1?a:C)};if(I){var h=
Object.getOwnPropertyDescriptor(f,c);e.get=e.get||h&&h.get||x;e.set=e.set||h&&h.set||x;I(f,c,e)}else{d!==3&&f.__defineGetter__(c,e.get);d&1&&f.__defineSetter__(c,e.set)}}},o?1:0),o&&!(o=0)&&0===g)j=0;return new (c?function(){return f}:function(){f.constructor&&f.constructor!==Object.prototype.constructor&&f.constructor.apply(f,k);return f})}var o=1,j={},g=0,a=q,c=arguments,l=c.length-1,p=c[l--]||{},s={"extends":1,"implements":1},k="object"===typeof c[l]?c[l--]:{},m=k["static"]||(k.context||k["extends"]||
k["implements"]?{}:k),A="function"===typeof c[l]||"string"===typeof c[l-1]?c[l--]:"",e=(c[l--]||"").replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),D=c[l--]||k.context||h.defaultContext||h,J=!(e[0]in s)&&e.shift()||"",K=(l=e.shift())in s&&(s=e.shift())?s.split(","):[],c="extends"===l?(l=e.shift(),K.shift()):"",e="implements"===l?K.concat((s=e.shift())?s.split(","):[]):K,w=k["extends"]||A||c,e=k["implements"]||e,z=e instanceof Array?e:[e],B=z.length,E=k.disableStatement;
if("function"!==typeof p)var L=p,p=function(){return L};b.toString=function(){return"[class "+(J||"Object")+"]"};r(m,function(a,c){b[a]=c});if(b.className=J){k=D;m=(e=J.split(".")).shift();do 0===e.length?k[m]=b:(m in k||(k[m]={}),k=k[m]);while(m=e.shift())}return b}var M=(new Date).getTime(),L=Object.prototype.toString,I=Object.defineProperty,H=Object.prototype.hasOwnProperty,A=t.document.getElementsByTagName("script");(A[A.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,"");var G=+((t.eval&&eval("/*@cc_on 1;@*/")&&
/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),F=(I||Object.prototype.__defineGetter__)&&(!G||8<G)?0:1,N=!{toString:1}.propertyIsEnumerable("toString"),r,y,p="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");h.classByName=y=function(b,o,j){var g,a=b,c=o=o||h.defaultContext||h;if("string"===typeof a){for(a=a.split(".");(g=a.shift())&&(c=c[g]););a=c}if(!a&&j&&!("function"===typeof h.autoload&&(a=h.autoload.call(o,b,j)||y(b,o))))throw Error("Parent class '"+
b+"' not Initialized or Undefined");return a};h.ownEach=r=function(b,h,j){var g,a,c=p.length;if("[object Array]"===L.call(b)){c=b.length;for(g=0;g<c&&!(a=b[g],h.call(b[g],j?a:g,j?g:a)===q);g++);}else{for(g in b)if(a=b[g],(j&&a!==Object.prototype[g]||H.call(b,g))&&h.call(a,g,a)===q){c=q;break}if(c&&N)for(g=0;g<c&&!(a=b[p[g]],(H.call(b,p[g])||j&&a!=u&&a!==Object.prototype[p[g]])&&h.call(a,p[g],a)===q);g++);}};h.instanceOf=function(b,h){for(;b&&b.__class__!=u;){if(b.__class__===h)return B;b=b.parent}return q};
r(["classByName","ownEach","instanceOf"],function(b,o){h[o].toString=h.toString=function(){return"[object Function]"}});F&&!("execVBscript"in t)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");t.Class=h})(window,!0,!1,null);
