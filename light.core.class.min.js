/*
 * light.core.class.min.js Library for JavaScript v0.5.0
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 19-01-2013
 */
(function(t,x,r,v,E){function C(b,k){return function(){throw Error("'"+b+"' property is "+(k?"read":"write")+"-only");}}function p(){function b(){var h=P,j=0===+this,m=arguments,p=v,o=new D,d=o,n=j?m[0]:{a:o},w=!j||m[1]===E?O:m[1];if(h){for(var B=function(){};h--;)"string"===typeof y[h]&&(y[h]=F(y[h],Q,b)),h===P-1?B.prototype=p=y[h].call(r,n,w):(delete B.prototype.constructor,delete B.prototype.__construct,s(y[h].call(r,n,w),function(g,e){B.prototype[g]=e},1));d=new B}w||(o.parent=p);if(z||j)c=function(g,
e,f){g[e]=function(){var g=n.a.parent,e=n.a.__class__;n.a.parent=o.parent;n.a.__class__=d.__class__;var a=f.apply(this===d||this==t?n.a:this,arguments);n.a.__class__=e;n.a.parent=g;return a};g[e].toString=function(){return f.toString()}},s(o,function(g,e){"function"===typeof e&&!w?c(d,g,e):(!w&&e&&"object"===typeof e&&("set"in e&&"function"===typeof e.set&&c(e,"set",e.set),"get"in e&&"function"===typeof e.get&&c(e,"get",e.get)),d[g]=e)}),n.a=j?n.a:d;j&&q in d&&(d.constructor=d[q]);w||(d.__class__=
b);if(!j&&0!==l)if(G){if(H){if(a===r){a="StaticClass"+R+G++;var u=[],x=0,A=["Class "+a];s(d,function(g,e){var f=0===g.indexOf("$")?1:0===g.indexOf("get ")?2:0===g.indexOf("set ")?3:"toString"===g?4:e&&"object"===typeof e&&(e.set||e.get)?5:0;if(f){var a=4===f?g:(x=1)&&1===f?g.substring(1):5===f?g:g.split(" ").pop();l[g]=e;3!==f&&A.push("Public "+(4===f?"Default ":"")+"Property Get ["+a+"]","Call VBCorrectVal("+(1===f?d.__get?'me.[__get].call(me,"'+a+'")':"":l[g]&&(5!==f||l[g].get)?"[(accessors)].["+
g+"]"+(5===f?".get":"")+".call(me)":"window.undefined")+",["+a+"])","End Property");if(f&1||4===f)A.push("Public Property Let ["+a+"](val)",f=(1===f?d.__set?'Call me.[__set].call(me,"'+a+'",val)':"":4===f?"Set [(accessors)].["+g+"]=val":l[g]&&(5!==f||l[g].set)?"Call [(accessors)].["+g+"]"+(5===f?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+a+"](val)",f)}f||(50===u.length&&(A.push("Public ["+u.join("],[")+"]"),u.length=0),u[u.length]=g)},1);x?(A.push((u.length?"Public ["+
u.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+a+"FactoryJS()","End Sub","End Class","Function "+a+"Factory()","Set "+a+"Factory=New "+a,"End Function"),t[a+"FactoryJS"]=function(){return i},execVBScript(A.join("\n"))):(l=0,a=v);u=A=v}a&&(i={},s(l,function(g){i[g]=d[g]}),n.a=t[a+"Factory"](),s(d,function(g,a){l.hasOwnProperty(g)||((!z||w)&&"function"===typeof a?(n.a[g]=function(){return a.apply(this===d||this==t?n.a:this,arguments)},n.a[g].toString=
function(){return a.toString()}):n.a[g]=a)},1),d=n.a)}}else if(s(k?d:l,function(a,e){var f=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:e&&"object"===typeof e&&(e.set||e.get)?5:0;if(f){k&&(l[a]=e,i++);e=d[a];I.call(d,a)&&delete d[a];var b=1===f?a.substring(1):5===f?a:a.split(" ").pop(),c={enumerable:1,configurable:1,set:v,get:v};3!==f&&(c.get=function(){return((f===1?d.__get:f===5?e.get:e)||C(b,0)).call(this,f===1?b:E)});f&1&&(c.set=function(a){((f===1?d.__set:f===5?e.set:
e)||C(b,1)).call(this,f===1?b:a,f===1?a:E)});if(J){var h=Object.getOwnPropertyDescriptor(d,b);c.get=c.get||h&&h.get||C(b,0);c.set=c.set||h&&h.set||C(b,1);J(d,b,c)}else 3!==f&&d.__defineGetter__(b,c.get),f&1&&d.__defineSetter__(b,c.set)}},k?1:0),k&&!(k=0)&&0===i)l=0;return new (j?function(){return d}:function(){q in d?d[q].apply(d,m):"__construct"in d?d.__construct.apply(d,m):d.constructor&&d.constructor!==Object.prototype.constructor&&d.constructor.apply(d,m);return d})}var k=1,l={},i=0,a=r,c=arguments,
q,j=c.length-1,D=c[j--]||{},m={"extends":1,"implements":1},h="object"===typeof c[j]&&c[j]?c[j--]:{},x=h.statics||(h.context||h["extends"]||h["implements"]||h.disableStatement?{}:h),K="function"===typeof c[j]||"string"===typeof c[j-1]?c[j--]:"",o=((c[j--]||"")+("string"==typeof K?" extends "+K:"")).replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),Q=c[j--]||h.context||p.defaultContext||t,L=!(o[0]in m)&&o.shift()||"",M=(j=o.shift())in m&&(m=o.shift())?m.split(","):[],N="extends"===
j?(j=o.shift(),M.shift()):"",o="implements"===j?M.concat((m=o.shift())?m.split(","):[]):M,z=h["extends"]||N||K,m=h["implements"]||o,y=m instanceof Array?(z&&m.unshift(z),m):z&&[z,m]||[m],P=y.length,O=h.disableStatement;if("function"!==typeof D)var S=D,D=function(){return S};b.toString=function(){return"[class "+(L||"Object")+"]"};s(x,function(a,c){b[a]=c});if(b.className=L){h=Q;c=(o=L.split(".")).shift();do 0===o.length?h[q=c]=b:(c in h||(h[c]={}),h=h[c]);while(c=o.shift())}return b}var s,F,R=(new Date).getTime(),
N=Object.prototype.toString,J=Object.defineProperty,I=Object.prototype.hasOwnProperty,H=+((t.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),G=(J||Object.prototype.__defineGetter__)&&(!H||8<H)?0:1,O=!{toString:1}.propertyIsEnumerable("toString"),q="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");p.classByName=F=function(b,k,l){var i,a=b,c=k=k||p.defaultContext||p;if("string"===typeof a){for(a=a.split(".");(i=
a.shift())&&(c=c[i]););a=c}if(!a&&l&&!("function"===typeof p.autoload&&(a=p.autoload.call(k,b,l)||F(b,k))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return a};p.ownEach=s=function(b,k,l){var i,a,c=q.length;if("[object Array]"===N.call(b)){c=b.length;for(i=0;i<c&&!(a=b[i],k.call(b[i],l?a:i,l?i:a)===r);i++);}else{for(i in b)if(a=b[i],(l&&a!==Object.prototype[i]||I.call(b,i))&&k.call(a,i,a)===r){c=r;break}if(c&&O)for(i=0;i<c&&!(a=b[q[i]],(I.call(b,q[i])||l&&a!=v&&a!==Object.prototype[q[i]])&&
k.call(a,q[i],a)===r);i++);}};p.instanceOf=function(b,k){for(;b&&b.__class__!=v;){if(b.__class__===k)return x;b=b.parent}return r};s(["classByName","ownEach","instanceOf"],function(b,k){p[k].toString=p.toString=function(){return"[object Function]"}});G&&!("execVBscript"in t)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");t.Class=p})(window,!0,!1,null);
