/*
 * light.core.class.min.js Library for JavaScript v0.5.6
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 03-02-2013
 */
(function(s,E,u,v,F){function D(d,l){return function(){throw Error("'"+d+"' property is "+(l?"read":"write")+"-only");}}function w(){}function i(){function d(){for(var h=G,j=0===+this,i=arguments,p=v,o=new r,t=i[2]||v,f=t||o,m=j?i[0]:{a:o},z=!j||i[1]===F||H!==F?H:i[1];h--;)"string"===typeof C[h]&&(C[h]=I(C[h],P,d)),w.prototype=p=C[h].call(u,m,z,t),0<h&&!z&&(p.constructor=function(){}),f=t=new w;z||(o.parent=p);if(G||j)e=function(b,c,k){b[c]=function(){var c=m.a.parent,b=m.a.__class__;m.a.parent=o.parent;
m.a.__class__=f.__class__;var a=k.apply(this===f||this==s?m.a:this,arguments);m.a.__class__=b;m.a.parent=c;return a};b[c].toString=function(){return k.toString()}},x(o,function(b,c){"function"===typeof c&&!z?e(f,b,c):(!z&&c&&"object"===typeof c&&("set"in c&&"function"===typeof c.set&&e(c,"set",c.set),"get"in c&&"function"===typeof c.get&&e(c,"get",c.get)),f[b]=c)}),m.a=j?m.a:f;z||(j&&n in f&&(f.constructor=f[n]),f.__class__=d);if(!j&&0!==q)if(J){if(K){if(a===u){a="StaticClass"+T+J++;var y=[],A=0,
B=["Class "+a];x(f,function(b,c){var k=b.indexOf("$")===0?1:b.indexOf("get ")===0?2:b.indexOf("set ")===0?3:b==="toString"?4:c&&typeof c==="object"&&(c.set||c.get)?5:0;if(k){var a=k===4?b:(A=1)&&k===1?b.substring(1):k===5?b:b.split(" ").pop();q[b]=k;k!==3&&B.push("Public "+(k===4?"Default ":"")+"Property Get ["+a+"]","Call VBCorrectVal("+(k===1?f.__get?'me.[__get].call(me,"'+a+'")':"":c&&(k!==5||c.get)?"[(accessors)].["+b+"]"+(k===5?".get":"")+".call(me,[(accessors)].["+b+"])":"window.undefined")+
",["+a+"])","End Property");k!==2&&B.push("Public Property Let ["+a+"](val)",k=(k===1?f.__set?'Call me.[__set].call(me,"'+a+'",val)':"":k===4?"Set [(accessors)].["+b+"]=val":c&&(k!==5||c.set)?"Call [(accessors)].["+b+"]"+(k===5?".set":"")+".call(me,val,[(accessors)].["+b+"])":"")+"\nEnd Property","Public Property Set ["+a+"](val)",k)}if(!k){if(y.length===50){B.push("Public ["+y.join("],[")+"]");y.length=0}y[y.length]=b}},1);A?(B.push((y.length?"Public ["+y.join("],[")+"]\n":"")+"Private [(accessors)]",
"Private Sub Class_Initialize()","Set [(accessors)]="+a+"FactoryJS()","End Sub","End Class","Function "+a+"Factory()","Set "+a+"Factory=New "+a,"End Function"),s[a+"FactoryJS"]=function(){return g},execVBScript(B.join("\n"))):(q=0,a=v);y=B=v}a&&(g={},m.a=s[a+"Factory"](),x(f,function(b,c){if(q.hasOwnProperty(b))if(q[b]===5){w.prototype=f[b];g[b]=new w}else g[b]=f[b];else if((!G||z)&&typeof c==="function"){m.a[b]=function(){return c.apply(this===f||this==s?m.a:this,arguments)};m.a[b].toString=function(){return c.toString()}}else m.a[b]=
c},1),f=m.a)}}else if(x(l?f:q,function(b,c){var a=!l?c:b.indexOf("$")===0?1:b.indexOf("get ")===0?2:b.indexOf("set ")===0?3:c&&typeof c==="object"&&(c.set||c.get)?5:0;if(a){if(l){q[b]=a;g++}c=f[b];if(a===5){w.prototype=c;c=new w}L.call(f,b)&&delete f[b];var d=a===1?b.substring(1):a===5?b:b.split(" ").pop(),e={enumerable:1,configurable:1,set:v,get:v};if(a!==3)e.get=function(){return((a===1?f.__get:a===5?c.get:c)||D(d,0)).call(this,a===1?d:c)};if(a!==2)e.set=function(b){((a===1?f.__set:a===5?c.set:
c)||D(d,1)).call(this,a===1?d:b,a===1?b:c)};if(M){var h=Object.getOwnPropertyDescriptor(f,d);e.get=e.get||h&&h.get||D(d,0);e.set=e.set||h&&h.set||D(d,1);M(f,d,e)}else{a!==3&&f.__defineGetter__(d,e.get);a!==2&&f.__defineSetter__(d,e.set)}}},l?1:0),l&&!(l=0)&&0===g)q=0;return new (j?function(){return f}:function(){n in f?f[n].apply(f,i):f.constructor&&f.constructor!==Object.prototype.constructor&&f.constructor.apply(f,i);return f})}var l=1,q={},g=0,a=u,n,e=arguments,h=e.length-1,r=e[h--]||{},E=this instanceof
i,j=!e[h]||e[h]instanceof A||"object"!==typeof e[h]?{}:e[h--],t=j["extends"],H=j.compact,o=j["implements"],Q=j.context,O=j.statics||(Q||t||o||H!==F?{}:j),R="function"===typeof e[h]?[e[h--]]:e[h]instanceof A?e[h--]:"string"===typeof e[h-1]&&(""+e[h--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[],p="string"===typeof e[h]&&e[h--].split(/extends|implements|,/g)||[],P=e[h--]||Q||i.defaultContext||s,N=(p.shift()||"").replace(/^\s+|\s+$/g,
""),h=t instanceof A?t:t?[t]:[],o=o instanceof A?o:o?[o]:[],p=(j=p.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?j.split(","):[],C=p.concat.apply(p,R.concat.apply(R,h.concat.apply(h,o))),G=C.length;if("function"!==typeof r)var S=r,r=function(){w.prototype=S.constructor.prototype;e=new w;x(S,function(a,d){e[a]=d});return e};d.toString=function(){return"[class "+(N||"Object")+"]"};x(O,function(a,e){d[a]=e});if(d.className=N){j=P;e=(p=N.split(".")).shift();do 0===p.length?j[n=e]=
d:(e in j||(j[e]={}),j=j[e]);while(e=p.shift())}return E?new d:d}var A=s.Array,x,I,T=(new Date).getTime(),O=Object.prototype.toString,M=Object.defineProperty,L=Object.prototype.hasOwnProperty,K=+((s.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),J=(M||Object.prototype.__defineGetter__)&&(!K||8<K)?0:1,U=!{toString:1}.propertyIsEnumerable("toString"),r="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");i.classByName=
I=function(d,l,q){var g,a=d,n=l=l||i.defaultContext||i;if("string"===typeof a){for(a=a.split(".");(g=a.shift())&&(n=n[g]););a=n}if(!a&&q&&!("function"===typeof i.autoload&&(a=i.autoload.call(l,d,q)||I(d,l))))throw Error("Parent class '"+d+"' not Initialized or Undefined");return a};i.ownEach=x=function(d,l,i){var g,a,n=r.length;if("[object Array]"===O.call(d)){n=d.length;for(g=0;g<n&&!(a=d[g],l.call(d[g],i?a:g,i?g:a)===u);g++);}else{for(g in d)if(a=d[g],(i&&a!==Object.prototype[g]||L.call(d,g))&&
l.call(a,g,a)===u){n=u;break}if(n&&U)for(g=0;g<n&&!(a=d[r[g]],(L.call(d,r[g])||i&&a!=v&&a!==Object.prototype[r[g]])&&l.call(a,r[g],a)===u);g++);}};i.instanceOf=function(d,i){for(;d&&d.__class__!=v;){if(d.__class__===i)return E;d=d.parent}return u};x(["classByName","ownEach","instanceOf"],function(d,l){i[l].toString=i.toString=function(){return"[object Function]"}});J&&!("execVBscript"in s)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript");s.Class=i})(window,!0,!1,null);
