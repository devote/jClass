/*
 * light.core.class.min.js Library for JavaScript v0.5.2
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 29-01-2013
 */
(function(q,v,r,s,D){function B(c,k){return function(){throw Error("'"+c+"' property is "+(k?"read":"write")+"-only");}}function o(){function c(){for(var e=M,f=0===+this,i=arguments,o=s,m=new C,v=i[2]||s,d=v||m,n=f?i[0]:{a:m},w=!f||i[1]===D?P:i[1];e--;)"string"===typeof A[e]&&(A[e]=E(A[e],N,c)),a=function(){},a.prototype=o=A[e].call(r,n,w,v),0<e&&(delete a.prototype.__construct,delete a.prototype.constructor),d=v=new a;w||(m.parent=o);if(x||f)a=function(h,j,O){h[j]=function(){var h=n.a.parent,j=n.a.__class__;
n.a.parent=m.parent;n.a.__class__=d.__class__;var a=O.apply(this===d||this==q?n.a:this,arguments);n.a.__class__=j;n.a.parent=h;return a};h[j].toString=function(){return O.toString()}},t(m,function(h,j){"function"===typeof j&&!w?a(d,h,j):(!w&&j&&"object"===typeof j&&("set"in j&&"function"===typeof j.set&&a(j,"set",j.set),"get"in j&&"function"===typeof j.get&&a(j,"get",j.get)),d[h]=j)}),n.a=f?n.a:d;f&&p in d&&(d.constructor=d[p]);w||(d.__class__=c);if(!f&&0!==l)if(F){if(G){if(b===r){b="StaticClass"+
Q+F++;var u=[],z=0,y=["Class "+b];t(d,function(h,j){var a=0===h.indexOf("$")?1:0===h.indexOf("get ")?2:0===h.indexOf("set ")?3:"toString"===h?4:j&&"object"===typeof j&&(j.set||j.get)?5:0;if(a){var b=4===a?h:(z=1)&&1===a?h.substring(1):5===a?h:h.split(" ").pop();l[h]=j;3!==a&&y.push("Public "+(4===a?"Default ":"")+"Property Get ["+b+"]","Call VBCorrectVal("+(1===a?d.__get?'me.[__get].call(me,"'+b+'")':"":l[h]&&(5!==a||l[h].get)?"[(accessors)].["+h+"]"+(5===a?".get":"")+".call(me)":"window.undefined")+
",["+b+"])","End Property");if(a&1||4===a)y.push("Public Property Let ["+b+"](val)",a=(1===a?d.__set?'Call me.[__set].call(me,"'+b+'",val)':"":4===a?"Set [(accessors)].["+h+"]=val":l[h]&&(5!==a||l[h].set)?"Call [(accessors)].["+h+"]"+(5===a?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+b+"](val)",a)}a||(50===u.length&&(y.push("Public ["+u.join("],[")+"]"),u.length=0),u[u.length]=h)},1);z?(y.push((u.length?"Public ["+u.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()",
"Set [(accessors)]="+b+"FactoryJS()","End Sub","End Class","Function "+b+"Factory()","Set "+b+"Factory=New "+b,"End Function"),q[b+"FactoryJS"]=function(){return g},execVBScript(y.join("\n"))):(l=0,b=s);u=y=s}b&&(g={},t(l,function(a){g[a]=d[a]}),n.a=q[b+"Factory"](),t(d,function(a,b){l.hasOwnProperty(a)||((!x||w)&&"function"===typeof b?(n.a[a]=function(){return b.apply(this===d||this==q?n.a:this,arguments)},n.a[a].toString=function(){return b.toString()}):n.a[a]=b)},1),d=n.a)}}else if(t(k?d:l,function(a,
b){var c=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:b&&"object"===typeof b&&(b.set||b.get)?5:0;if(c){k&&(l[a]=b,g++);b=d[a];H.call(d,a)&&delete d[a];var e=1===c?a.substring(1):5===c?a:a.split(" ").pop(),f={enumerable:1,configurable:1,set:s,get:s};3!==c&&(f.get=function(){return((c===1?d.__get:c===5?b.get:b)||B(e,0)).call(this,c===1?e:D)});c&1&&(f.set=function(a){((c===1?d.__set:c===5?b.set:b)||B(e,1)).call(this,c===1?e:a,c===1?a:D)});if(I){var i=Object.getOwnPropertyDescriptor(d,
e);f.get=f.get||i&&i.get||B(e,0);f.set=f.set||i&&i.set||B(e,1);I(d,e,f)}else 3!==c&&d.__defineGetter__(e,f.get),c&1&&d.__defineSetter__(e,f.set)}},k?1:0),k&&!(k=0)&&0===g)l=0;return new (f?function(){return d}:function(){p in d?d[p].apply(d,i):"__construct"in d?d.__construct.apply(d,i):d.constructor&&d.constructor!==Object.prototype.constructor&&d.constructor.apply(d,i);return d})}var k=1,l={},g=0,b=r,a=arguments,p,f=a.length-1,C=a[f--]||{},i={"extends":1,"implements":1},e="object"===typeof a[f]&&
a[f]?a[f--]:{},v=e.statics||(e.context||e["extends"]||e["implements"]||e.disableStatement?{}:e),z="function"===typeof a[f]||"string"===typeof a[f-1]?a[f--]:"",m=((a[f--]||"")+("string"==typeof z?" extends "+z:"")).replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),N=a[f--]||e.context||o.defaultContext||q,J=!(m[0]in i)&&m.shift()||"",K=(f=m.shift())in i&&(i=m.shift())?i.split(","):[],L="extends"===f?(f=m.shift(),K.shift()):"",m="implements"===f?K.concat((i=m.shift())?i.split(","):
[]):K,x=e["extends"]||L||z,i=e["implements"]||m,A=i instanceof Array?(x&&i.unshift(x),i):x&&[x,i]||[i],M=A.length,P=e.disableStatement;if("function"!==typeof C)var R=C,C=function(){return R};c.toString=function(){return"[class "+(J||"Object")+"]"};t(v,function(a,b){c[a]=b});if(c.className=J){e=N;a=(m=J.split(".")).shift();do 0===m.length?e[p=a]=c:(a in e||(e[a]={}),e=e[a]);while(a=m.shift())}return c}var t,E,Q=(new Date).getTime(),L=Object.prototype.toString,I=Object.defineProperty,H=Object.prototype.hasOwnProperty,
G=+((q.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),F=(I||Object.prototype.__defineGetter__)&&(!G||8<G)?0:1,M=!{toString:1}.propertyIsEnumerable("toString"),p="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");o.classByName=E=function(c,k,l){var g,b=c,a=k=k||o.defaultContext||o;if("string"===typeof b){for(b=b.split(".");(g=b.shift())&&(a=a[g]););b=a}if(!b&&l&&!("function"===typeof o.autoload&&(b=o.autoload.call(k,
c,l)||E(c,k))))throw Error("Parent class '"+c+"' not Initialized or Undefined");return b};o.ownEach=t=function(c,k,l){var g,b,a=p.length;if("[object Array]"===L.call(c)){a=c.length;for(g=0;g<a&&!(b=c[g],k.call(c[g],l?b:g,l?g:b)===r);g++);}else{for(g in c)if(b=c[g],(l&&b!==Object.prototype[g]||H.call(c,g))&&k.call(b,g,b)===r){a=r;break}if(a&&M)for(g=0;g<a&&!(b=c[p[g]],(H.call(c,p[g])||l&&b!=s&&b!==Object.prototype[p[g]])&&k.call(b,p[g],b)===r);g++);}};o.instanceOf=function(c,k){for(;c&&c.__class__!=
s;){if(c.__class__===k)return v;c=c.parent}return r};t(["classByName","ownEach","instanceOf"],function(c,k){o[k].toString=o.toString=function(){return"[object Function]"}});F&&!("execVBscript"in q)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");q.Class=o})(window,!0,!1,null);
