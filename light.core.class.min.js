/*
 * light.core.class.min.js Library for JavaScript v0.5.5.1
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 30-01-2013
 */
(function(r,x,s,t,M){function A(c,k){return function(){throw Error("'"+c+"' property is "+(k?"read":"write")+"-only");}}function p(){function c(){for(var f=C,e=0===+this,i=arguments,p=t,m=new B,o=i[2]||t,d=o||m,n=e?i[0]:{a:m},w=!e||i[1]===M||N!==M?N:i[1];f--;)"string"===typeof z[f]&&(z[f]=D(z[f],O,c)),a=function(){},a.prototype=p=z[f].call(s,n,w,o),0<f&&!w&&(a.prototype.constructor=function(){}),d=o=new a;w||(m.parent=p);if(C||e)a=function(h,j,a){h[j]=function(){var h=n.a.parent,j=n.a.__class__;n.a.parent=
m.parent;n.a.__class__=d.__class__;var b=a.apply(this===d||this==r?n.a:this,arguments);n.a.__class__=j;n.a.parent=h;return b};h[j].toString=function(){return a.toString()}},u(m,function(h,j){"function"===typeof j&&!w?a(d,h,j):(!w&&j&&"object"===typeof j&&("set"in j&&"function"===typeof j.set&&a(j,"set",j.set),"get"in j&&"function"===typeof j.get&&a(j,"get",j.get)),d[h]=j)}),n.a=e?n.a:d;w||(e&&q in d&&(d.constructor=d[q]),d.__class__=c);if(!e&&0!==l)if(E){if(F){if(b===s){b="StaticClass"+P+E++;var v=
[],x=0,y=["Class "+b];u(d,function(h,j){var a=h.indexOf("$")===0?1:h.indexOf("get ")===0?2:h.indexOf("set ")===0?3:h==="toString"?4:j&&typeof j==="object"&&(j.set||j.get)?5:0;if(a){var b=a===4?h:(x=1)&&a===1?h.substring(1):a===5?h:h.split(" ").pop();l[h]=j;a!==3&&y.push("Public "+(a===4?"Default ":"")+"Property Get ["+b+"]","Call VBCorrectVal("+(a===1?d.__get?'me.[__get].call(me,"'+b+'")':"":l[h]&&(a!==5||l[h].get)?"[(accessors)].["+h+"]"+(a===5?".get":"")+".call(me,[(accessors)].["+h+"])":"window.undefined")+
",["+b+"])","End Property");if(a&1||a===4)y.push("Public Property Let ["+b+"](val)",a=(a===1?d.__set?'Call me.[__set].call(me,"'+b+'",val)':"":a===4?"Set [(accessors)].["+h+"]=val":l[h]&&(a!==5||l[h].set)?"Call [(accessors)].["+h+"]"+(a===5?".set":"")+".call(me,val,[(accessors)].["+h+"])":"")+"\nEnd Property","Public Property Set ["+b+"](val)",a)}if(!a){if(v.length===50){y.push("Public ["+v.join("],[")+"]");v.length=0}v[v.length]=h}},1);x?(y.push((v.length?"Public ["+v.join("],[")+"]\n":"")+"Private [(accessors)]",
"Private Sub Class_Initialize()","Set [(accessors)]="+b+"FactoryJS()","End Sub","End Class","Function "+b+"Factory()","Set "+b+"Factory=New "+b,"End Function"),r[b+"FactoryJS"]=function(){return g},execVBScript(y.join("\n"))):(l=0,b=t);v=y=t}b&&(g={},u(l,function(a){g[a]=d[a]}),n.a=r[b+"Factory"](),u(d,function(a,b){if(!l.hasOwnProperty(a))if((!C||w)&&typeof b==="function"){n.a[a]=function(){return b.apply(this===d||this==r?n.a:this,arguments)};n.a[a].toString=function(){return b.toString()}}else n.a[a]=
b},1),d=n.a)}}else if(u(k?d:l,function(a,b){var c=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(c){if(k){l[a]=b;g++}b=d[a];G.call(d,a)&&delete d[a];var e=c===1?a.substring(1):c===5?a:a.split(" ").pop(),f={enumerable:1,configurable:1,set:t,get:t};if(c!==3)f.get=function(){return((c===1?d.__get:c===5?b.get:b)||A(e,0)).call(this,c===1?e:b)};if(c&1)f.set=function(a){((c===1?d.__set:c===5?b.set:b)||A(e,1)).call(this,c===1?e:a,c===1?a:
b)};if(H){var i=Object.getOwnPropertyDescriptor(d,e);f.get=f.get||i&&i.get||A(e,0);f.set=f.set||i&&i.set||A(e,1);H(d,e,f)}else{c!==3&&d.__defineGetter__(e,f.get);c&1&&d.__defineSetter__(e,f.set)}}},k?1:0),k&&!(k=0)&&0===g)l=0;return new (e?function(){return d}:function(){q in d?d[q].apply(d,i):d.constructor&&d.constructor!==Object.prototype.constructor&&d.constructor.apply(d,i);return d})}var k=1,l={},g=0,b=s,a=arguments,q,f=a.length-1,B=a[f--]||{},m={"extends":1,"implements":1},e="object"===typeof a[f]&&
a[f]&&!(a[f]instanceof Array)?a[f--]:{},x=e.statics||(e.context||e["extends"]||e["implements"]||e.compact?{}:e),i="function"===typeof a[f]||"string"===typeof a[f-1]||a[f]&&a[f]instanceof Array?a[f--]:"",o=((a[f--]||"")+(i&&"string"==typeof i?" extends "+i:"")).replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),O=a[f--]||e.context||p.defaultContext||r,I=!(o[0]in m)&&o.shift()||"",J=(f=o.shift())in m&&(m=o.shift())?m.split(","):i instanceof Array?i:[],K="extends"===f?(f=o.shift(),
J.shift()):"",o="implements"===f?J.concat((m=o.shift())?m.split(","):[]):J,m=e["extends"]||K||"string"===typeof i&&i,i=e["implements"]||o,z=i instanceof Array?(m&&i.unshift(m),i):m&&[m,i]||[i],C=z.length,N=e.compact;if("function"!==typeof B)var L=B,B=function(){return L};c.toString=function(){return"[class "+(I||"Object")+"]"};u(x,function(a,b){c[a]=b});if(c.className=I){e=O;a=(o=I.split(".")).shift();do 0===o.length?e[q=a]=c:(a in e||(e[a]={}),e=e[a]);while(a=o.shift())}return c}var u,D,P=(new Date).getTime(),
K=Object.prototype.toString,H=Object.defineProperty,G=Object.prototype.hasOwnProperty,F=+((r.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),E=(H||Object.prototype.__defineGetter__)&&(!F||8<F)?0:1,L=!{toString:1}.propertyIsEnumerable("toString"),q="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");p.classByName=D=function(c,k,l){var g,b=c,a=k=k||p.defaultContext||p;if("string"===typeof b){for(b=b.split(".");(g=
b.shift())&&(a=a[g]););b=a}if(!b&&l&&!("function"===typeof p.autoload&&(b=p.autoload.call(k,c,l)||D(c,k))))throw Error("Parent class '"+c+"' not Initialized or Undefined");return b};p.ownEach=u=function(c,k,l){var g,b,a=q.length;if("[object Array]"===K.call(c)){a=c.length;for(g=0;g<a&&!(b=c[g],k.call(c[g],l?b:g,l?g:b)===s);g++);}else{for(g in c)if(b=c[g],(l&&b!==Object.prototype[g]||G.call(c,g))&&k.call(b,g,b)===s){a=s;break}if(a&&L)for(g=0;g<a&&!(b=c[q[g]],(G.call(c,q[g])||l&&b!=t&&b!==Object.prototype[q[g]])&&
k.call(b,q[g],b)===s);g++);}};p.instanceOf=function(c,k){for(;c&&c.__class__!=t;){if(c.__class__===k)return x;c=c.parent}return s};u(["classByName","ownEach","instanceOf"],function(c,k){p[k].toString=p.toString=function(){return"[object Function]"}});E&&!("execVBscript"in r)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");r.Class=p})(window,!0,!1,null);
