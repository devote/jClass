/*
 * light.core.class.min.js Library for JavaScript v0.5.1
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 27-01-2013
 */
(function(t,x,r,v,D){function B(d,j){return function(){throw Error("'"+d+"' property is "+(j?"read":"write")+"-only");}}function p(){function d(){for(var f=O,i=0===+this,l=arguments,p=v,n=new C,c=n,m=i?l[0]:{a:n},w=!i||l[1]===D?N:l[1];f--;)("string"===typeof y[f]&&(y[f]=E(y[f],P,d)),f===O-1?(a=function(){},a.prototype=y[f].call(r,m,w)):s(y[f].call(r,m,w),function(h,c){a.prototype[h]=c},1),0===f)?(p=a.prototype,c=new a):(delete a.prototype.__construct,delete a.prototype.constructor,c=new a,a=function(){},
a.prototype=c);w||(n.parent=p);if(z||i)a=function(h,a,e){h[a]=function(){var h=m.a.parent,a=m.a.__class__;m.a.parent=n.parent;m.a.__class__=c.__class__;var o=e.apply(this===c||this==t?m.a:this,arguments);m.a.__class__=a;m.a.parent=h;return o};h[a].toString=function(){return e.toString()}},s(n,function(h,o){"function"===typeof o&&!w?a(c,h,o):(!w&&o&&"object"===typeof o&&("set"in o&&"function"===typeof o.set&&a(o,"set",o.set),"get"in o&&"function"===typeof o.get&&a(o,"get",o.get)),c[h]=o)}),m.a=i?m.a:
c;i&&q in c&&(c.constructor=c[q]);w||(c.__class__=d);if(!i&&0!==k)if(F){if(G){if(b===r){b="StaticClass"+Q+F++;var u=[],x=0,A=["Class "+b];s(c,function(h,a){var e=0===h.indexOf("$")?1:0===h.indexOf("get ")?2:0===h.indexOf("set ")?3:"toString"===h?4:a&&"object"===typeof a&&(a.set||a.get)?5:0;if(e){var b=4===e?h:(x=1)&&1===e?h.substring(1):5===e?h:h.split(" ").pop();k[h]=a;3!==e&&A.push("Public "+(4===e?"Default ":"")+"Property Get ["+b+"]","Call VBCorrectVal("+(1===e?c.__get?'me.[__get].call(me,"'+
b+'")':"":k[h]&&(5!==e||k[h].get)?"[(accessors)].["+h+"]"+(5===e?".get":"")+".call(me)":"window.undefined")+",["+b+"])","End Property");if(e&1||4===e)A.push("Public Property Let ["+b+"](val)",e=(1===e?c.__set?'Call me.[__set].call(me,"'+b+'",val)':"":4===e?"Set [(accessors)].["+h+"]=val":k[h]&&(5!==e||k[h].set)?"Call [(accessors)].["+h+"]"+(5===e?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+b+"](val)",e)}e||(50===u.length&&(A.push("Public ["+u.join("],[")+"]"),u.length=
0),u[u.length]=h)},1);x?(A.push((u.length?"Public ["+u.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+b+"FactoryJS()","End Sub","End Class","Function "+b+"Factory()","Set "+b+"Factory=New "+b,"End Function"),t[b+"FactoryJS"]=function(){return g},execVBScript(A.join("\n"))):(k=0,b=v);u=A=v}b&&(g={},s(k,function(a){g[a]=c[a]}),m.a=t[b+"Factory"](),s(c,function(a,b){k.hasOwnProperty(a)||((!z||w)&&"function"===typeof b?(m.a[a]=function(){return b.apply(this===
c||this==t?m.a:this,arguments)},m.a[a].toString=function(){return b.toString()}):m.a[a]=b)},1),c=m.a)}}else if(s(j?c:k,function(a,b){var e=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:b&&"object"===typeof b&&(b.set||b.get)?5:0;if(e){j&&(k[a]=b,g++);b=c[a];H.call(c,a)&&delete c[a];var d=1===e?a.substring(1):5===e?a:a.split(" ").pop(),f={enumerable:1,configurable:1,set:v,get:v};3!==e&&(f.get=function(){return((e===1?c.__get:e===5?b.get:b)||B(d,0)).call(this,e===1?d:D)});e&1&&
(f.set=function(a){((e===1?c.__set:e===5?b.set:b)||B(d,1)).call(this,e===1?d:a,e===1?a:D)});if(I){var i=Object.getOwnPropertyDescriptor(c,d);f.get=f.get||i&&i.get||B(d,0);f.set=f.set||i&&i.set||B(d,1);I(c,d,f)}else 3!==e&&c.__defineGetter__(d,f.get),e&1&&c.__defineSetter__(d,f.set)}},j?1:0),j&&!(j=0)&&0===g)k=0;return new (i?function(){return c}:function(){q in c?c[q].apply(c,l):"__construct"in c?c.__construct.apply(c,l):c.constructor&&c.constructor!==Object.prototype.constructor&&c.constructor.apply(c,
l);return c})}var j=1,k={},g=0,b=r,a=arguments,q,i=a.length-1,C=a[i--]||{},l={"extends":1,"implements":1},f="object"===typeof a[i]&&a[i]?a[i--]:{},x=f.statics||(f.context||f["extends"]||f["implements"]||f.disableStatement?{}:f),J="function"===typeof a[i]||"string"===typeof a[i-1]?a[i--]:"",n=((a[i--]||"")+("string"==typeof J?" extends "+J:"")).replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),P=a[i--]||f.context||p.defaultContext||t,K=!(n[0]in l)&&n.shift()||"",L=(i=n.shift())in
l&&(l=n.shift())?l.split(","):[],M="extends"===i?(i=n.shift(),L.shift()):"",n="implements"===i?L.concat((l=n.shift())?l.split(","):[]):L,z=f["extends"]||M||J,l=f["implements"]||n,y=l instanceof Array?(z&&l.unshift(z),l):z&&[z,l]||[l],O=y.length,N=f.disableStatement;if("function"!==typeof C)var R=C,C=function(){return R};d.toString=function(){return"[class "+(K||"Object")+"]"};s(x,function(a,b){d[a]=b});if(d.className=K){f=P;a=(n=K.split(".")).shift();do 0===n.length?f[q=a]=d:(a in f||(f[a]={}),f=
f[a]);while(a=n.shift())}return d}var s,E,Q=(new Date).getTime(),M=Object.prototype.toString,I=Object.defineProperty,H=Object.prototype.hasOwnProperty,G=+((t.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),F=(I||Object.prototype.__defineGetter__)&&(!G||8<G)?0:1,N=!{toString:1}.propertyIsEnumerable("toString"),q="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");p.classByName=E=function(d,j,k){var g,b=d,a=j=j||
p.defaultContext||p;if("string"===typeof b){for(b=b.split(".");(g=b.shift())&&(a=a[g]););b=a}if(!b&&k&&!("function"===typeof p.autoload&&(b=p.autoload.call(j,d,k)||E(d,j))))throw Error("Parent class '"+d+"' not Initialized or Undefined");return b};p.ownEach=s=function(d,j,k){var g,b,a=q.length;if("[object Array]"===M.call(d)){a=d.length;for(g=0;g<a&&!(b=d[g],j.call(d[g],k?b:g,k?g:b)===r);g++);}else{for(g in d)if(b=d[g],(k&&b!==Object.prototype[g]||H.call(d,g))&&j.call(b,g,b)===r){a=r;break}if(a&&
N)for(g=0;g<a&&!(b=d[q[g]],(H.call(d,q[g])||k&&b!=v&&b!==Object.prototype[q[g]])&&j.call(b,q[g],b)===r);g++);}};p.instanceOf=function(d,j){for(;d&&d.__class__!=v;){if(d.__class__===j)return x;d=d.parent}return r};s(["classByName","ownEach","instanceOf"],function(d,j){p[j].toString=p.toString=function(){return"[object Function]"}});F&&!("execVBscript"in t)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript");t.Class=p})(window,!0,!1,null);
