/*
 * light.core.class.js Library for JavaScript v0.4.9.4
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 13-09-2012
 */
(function(t,D,q,v,y){function z(){}function j(){function b(){var c=0===+this,i=arguments,e=v,j=new p,d=j,m=c?i[0]:{a:j},l=!c||i[1]===y?L:i[1];if(w){w=A(w,E,b);var o=function(){};o.prototype=e=w.call(q,m,l);d=new o}l||(j.parent=e);if(w||c)r(j,function(h,a){if(typeof a==="function"&&!l){d[h]=function(){var h=m.a.parent,b=m.a.__class__;m.a.parent=j.parent;m.a.__class__=d.__class__;var g=a.apply(this===d||this==t?m.a:this,arguments);m.a.__class__=b;m.a.parent=h;return g};d[h].toString=function(){return a.toString()}}else d[h]=
a}),m.a=c?m.a:d;l||(d.__class__=d.__static__=b);for(e=0;e<D;e++)B[e]=A(B[e],E,b),r(B[e].call(q,m),function(h,a){d[h]===y&&(d[h]=a)},1);if(!c&&0!==k)if(F){if(G){if(a===q){a="StaticClass"+N+F++;var u=[],s=0,x=["Class "+a];r(d,function(h,a){var f=h.indexOf("$")===0?1:h.indexOf("get ")===0?2:h.indexOf("set ")===0?3:h==="toString"?4:a&&typeof a==="object"&&(a.set||a.get)?5:0;if(f){var b=f===4?h:(s=1)&&f===1?h.substring(1):f===5?h:h.split(" ").pop();k[h]=a;f!==3&&x.push("Public "+(f===4?"Default ":"")+
"Property Get ["+b+"]","Call VBCorrectVal("+(f===1?d.__get?'me.[__get].call(me,"'+b+'")':"":k[h]&&(f!==5||k[h].get)?"[(accessors)].["+h+"]"+(f===5?".get":"")+".call(me)":"window.undefined")+",["+b+"])","End Property");if(f&1||f===4)x.push("Public Property Let ["+b+"](val)",f=(f===1?d.__set?'Call me.[__set].call(me,"'+b+'",val)':"":f===4?"Set [(accessors)].["+h+"]=val":k[h]&&(f!==5||k[h].set)?"Call [(accessors)].["+h+"]"+(f===5?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+
b+"](val)",f)}if(!f){if(u.length===50){x.push("Public ["+u.join("],[")+"]");u.length=0}u[u.length]=h}},1);s?(x.push((u.length?"Public ["+u.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+a+"FactoryJS()","End Sub","End Class","Function "+a+"Factory()","Set "+a+"Factory=New "+a,"End Function"),t[a+"FactoryJS"]=function(){return g},execVBScript(x.join("\n"))):(k=0,a=v);u=x=v}a&&(g={},r(k,function(a){g[a]=d[a]}),m.a=t[a+"Factory"](),r(d,function(a,b){if(!k.hasOwnProperty(a))if((!w||
l)&&typeof b==="function"){m.a[a]=function(){return b.apply(this===d||this==t?m.a:this,arguments)};m.a[a].toString=function(){return b.toString()}}else m.a[a]=b},1),d=m.a)}}else if(r(n?d:k,function(a,b){var f=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(f){if(n){k[a]=b;g++}b=d[a];H.call(d,a)&&delete d[a];var c=f===1?a.substring(1):f===5?a:a.split(" ").pop(),e={enumerable:1,configurable:1,set:v,get:v};if(f!==3)e.get=function(){return((f===
1?d.__get:f===5?b.get:b)||z).call(this,f===1?c:y)};if(f&1)e.set=function(a){((f===1?d.__set:f===5?b.set:b)||z).call(this,f===1?c:a,f===1?a:y)};if(I){var i=Object.getOwnPropertyDescriptor(d,c);e.get=e.get||i&&i.get||z;e.set=e.set||i&&i.set||z;I(d,c,e)}else{f!==3&&d.__defineGetter__(c,e.get);f&1&&d.__defineSetter__(c,e.set)}}},n?1:0),n&&!(n=0)&&0===g)k=0;return new (c?function(){return d}:function(){d.constructor&&d.constructor!==Object.prototype.constructor&&d.constructor.apply(d,i);return d})}var n=
1,k={},g=0,a=q,c=arguments,l=c.length-1,p=c[l--]||{},s={"extends":1,"implements":1},i="object"===typeof c[l]?c[l--]:{},o=i["static"]||(i.context||i["extends"]||i["implements"]||i.disableStatement?{}:i),C="function"===typeof c[l]||"string"===typeof c[l-1]?c[l--]:"",e=(c[l--]||"").replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),E=c[l--]||i.context||j.defaultContext||j,J=!(e[0]in s)&&e.shift()||"",K=(l=e.shift())in s&&(s=e.shift())?s.split(","):[],c="extends"===l?(l=e.shift(),
K.shift()):"",e="implements"===l?K.concat((s=e.shift())?s.split(","):[]):K,w=i["extends"]||C||c,e=i["implements"]||e,B=e instanceof Array?e:[e],D=B.length,L=i.disableStatement;if("function"!==typeof p)var M=p,p=function(){return M};b.toString=function(){return"[class "+(J||"Object")+"]"};r(o,function(a,c){b[a]=c});if(b.className=J){i=E;o=(e=J.split(".")).shift();do 0===e.length?i[o]=b:(o in i||(i[o]={}),i=i[o]);while(o=e.shift())}return b}var N=(new Date).getTime(),L=Object.prototype.toString,I=Object.defineProperty,
H=Object.prototype.hasOwnProperty,C=t.document.getElementsByTagName("script");(C[C.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,"");var G=+((t.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),F=(I||Object.prototype.__defineGetter__)&&(!G||8<G)?0:1,M=!{toString:1}.propertyIsEnumerable("toString"),r,A,p="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");j.classByName=A=function(b,n,k){var g,a=b,c=n=n||j.defaultContext||
j;if("string"===typeof a){for(a=a.split(".");(g=a.shift())&&(c=c[g]););a=c}if(!a&&k&&!("function"===typeof j.autoload&&(a=j.autoload.call(n,b,k)||A(b,n))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return a};j.ownEach=r=function(b,j,k){var g,a,c=p.length;if("[object Array]"===L.call(b)){c=b.length;for(g=0;g<c&&!(a=b[g],j.call(b[g],k?a:g,k?g:a)===q);g++);}else{for(g in b)if(a=b[g],(k&&a!==Object.prototype[g]||H.call(b,g))&&j.call(a,g,a)===q){c=q;break}if(c&&M)for(g=0;g<c&&!(a=
b[p[g]],(H.call(b,p[g])||k&&a!=v&&a!==Object.prototype[p[g]])&&j.call(a,p[g],a)===q);g++);}};j.instanceOf=function(b,j){for(;b&&b.__class__!=v;){if(b.__class__===j)return D;b=b.parent}return q};r(["classByName","ownEach","instanceOf"],function(b,n){j[n].toString=j.toString=function(){return"[object Function]"}});F&&!("execVBscript"in t)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");
t.Class=j})(window,!0,!1,null);
