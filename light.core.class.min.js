/*
 * light.core.class.js Library for JavaScript v0.4.9.2
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 09-09-2012
 */
(function(t,D,q,u,y){function z(){}function j(){function b(){var c=0===+this,i=arguments,d=u,j=new p,e=j,m=c?i[0]:{a:j},l=!c||i[1]===y?L:i[1];if(x){x=A(x,E,b);var o=function(){};o.prototype=d=x.call(q,m,l);e=new o}l||(j.parent=d);if(x||c)r(j,function(h,a){if(typeof a==="function"&&!l){e[h]=function(){var h=m.a.parent,b=m.a.__class__;m.a.parent=j.parent;m.a.__class__=e.__class__;var g=a.apply(this===e||this==t?m.a:this,arguments);m.a.__class__=b;m.a.parent=h;return g};e[h].toString=function(){return a.toString()}}else e[h]=
a}),m.a=c?m.a:e;l||(e.__class__=e.__static__=b);for(d=0;d<D;d++)B[d]=A(B[d],E,b),r(B[d].call(q,m),function(h,a){e[h]===y&&(e[h]=a)},1);if(!c&&0!==k)if(F){if(G){if(a===q){a="StaticClass"+N+F++;var v=[],s=0,w=["Class "+a];r(e,function(h,a){var f=h.indexOf("$")===0?1:h.indexOf("get ")===0?2:h.indexOf("set ")===0?3:h==="toString"?4:a&&typeof a==="object"&&(a.set||a.get)?5:0;if(f){var b=f===4?h:(s=1)&&f===1?h.substring(1):f===5?h:h.split(" ").pop();k[h]=a;f!==3&&w.push("Public "+(f===4?"Default ":"")+
"Property Get ["+b+"]","Call VBCorrectVal("+(f===1?e.__get?'me.[__get].call(me,"'+b+'")':"":k[h]&&(f!==5||k[h].get)?"[(accessors)].["+h+"]"+(f===5?".get":"")+".call(me)":"window.undefined")+",["+b+"])","End Property");if(f&1||f===4)w.push("Public Property Let ["+b+"](val)",f=(f===1?e.__set?'Call me.[__set].call(me,"'+b+'",val)':"":f===4?"Set [(accessors)].["+h+"]=val":k[h]&&(f!==5||k[h].set)?"Call [(accessors)].["+h+"]"+(f===5?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+
b+"](val)",f)}if(!f){if(v.length===50){w.push("Public ["+v.join("],[")+"]");v.length=0}v[v.length]=h}},1);s?(w.push("Public ["+v.join("],[")+"]","Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+a+"FactoryJS()","End Sub","End Class","Function "+a+"Factory()","Set "+a+"Factory=New "+a,"End Function"),t[a+"FactoryJS"]=function(){return g},execVBScript(w.join("\n"))):(k=0,a=u);v=w=u}a&&(g={},r(k,function(a){g[a]=e[a]}),m.a=t[a+"Factory"](),r(e,function(a,b){k.hasOwnProperty(a)||
(m.a[a]=b)},1),e=m.a)}}else if(r(n?e:k,function(a,b){var f=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(f){if(n){k[a]=b;g++}b=e[a];H.call(e,a)&&delete e[a];var c=f===1?a.substring(1):f===5?a:a.split(" ").pop(),d={enumerable:1,configurable:1,set:u,get:u};if(f!==3)d.get=function(){return((f===1?e.__get:f===5?b.get:b)||z).call(this,f===1?c:y)};if(f&1)d.set=function(a){((f===1?e.__set:f===5?b.set:b)||z).call(this,f===1?c:a,f===1?a:
y)};if(I){var i=Object.getOwnPropertyDescriptor(e,c);d.get=d.get||i&&i.get||z;d.set=d.set||i&&i.set||z;I(e,c,d)}else{f!==3&&e.__defineGetter__(c,d.get);f&1&&e.__defineSetter__(c,d.set)}}},n?1:0),n&&!(n=0)&&0===g)k=0;return new (c?function(){return e}:function(){e.constructor&&e.constructor!==Object.prototype.constructor&&e.constructor.apply(e,i);return e})}var n=1,k={},g=0,a=q,c=arguments,l=c.length-1,p=c[l--]||{},s={"extends":1,"implements":1},i="object"===typeof c[l]?c[l--]:{},o=i["static"]||(i.context||
i["extends"]||i["implements"]||i.disableStatement?{}:i),C="function"===typeof c[l]||"string"===typeof c[l-1]?c[l--]:"",d=(c[l--]||"").replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),E=c[l--]||i.context||j.defaultContext||j,J=!(d[0]in s)&&d.shift()||"",K=(l=d.shift())in s&&(s=d.shift())?s.split(","):[],c="extends"===l?(l=d.shift(),K.shift()):"",d="implements"===l?K.concat((s=d.shift())?s.split(","):[]):K,x=i["extends"]||C||c,d=i["implements"]||d,B=d instanceof Array?d:[d],
D=B.length,L=i.disableStatement;if("function"!==typeof p)var M=p,p=function(){return M};b.toString=function(){return"[class "+(J||"Object")+"]"};r(o,function(a,c){b[a]=c});if(b.className=J){i=E;o=(d=J.split(".")).shift();do 0===d.length?i[o]=b:(o in i||(i[o]={}),i=i[o]);while(o=d.shift())}return b}var N=(new Date).getTime(),L=Object.prototype.toString,I=Object.defineProperty,H=Object.prototype.hasOwnProperty,C=t.document.getElementsByTagName("script");(C[C.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,
"");var G=+((t.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),F=(I||Object.prototype.__defineGetter__)&&(!G||8<G)?0:1,M=!{toString:1}.propertyIsEnumerable("toString"),r,A,p="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");j.classByName=A=function(b,n,k){var g,a=b,c=n=n||j.defaultContext||j;if("string"===typeof a){for(a=a.split(".");(g=a.shift())&&(c=c[g]););a=c}if(!a&&k&&!("function"===typeof j.autoload&&
(a=j.autoload.call(n,b,k)||A(b,n))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return a};j.ownEach=r=function(b,j,k){var g,a,c=p.length;if("[object Array]"===L.call(b)){c=b.length;for(g=0;g<c&&!(a=b[g],j.call(b[g],k?a:g,k?g:a)===q);g++);}else{for(g in b)if(a=b[g],(k&&a!==Object.prototype[g]||H.call(b,g))&&j.call(a,g,a)===q){c=q;break}if(c&&M)for(g=0;g<c&&!(a=b[p[g]],(H.call(b,p[g])||k&&a!=u&&a!==Object.prototype[p[g]])&&j.call(a,p[g],a)===q);g++);}};j.instanceOf=function(b,j){for(;b&&
b.__class__!=u;){if(b.__class__===j)return D;b=b.parent}return q};r(["classByName","ownEach","instanceOf"],function(b,n){j[n].toString=j.toString=function(){return"[object Function]"}});F&&!("execVBscript"in t)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");t.Class=j})(window,!0,!1,null);
