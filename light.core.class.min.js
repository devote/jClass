/*
 * light.core.class.min.js Library for JavaScript v0.5.4
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 29-01-2013
 */
(function(q,v,r,s,O){function B(c,j){return function(){throw Error("'"+c+"' property is "+(j?"read":"write")+"-only");}}function o(){function c(){for(var f=L,i=0===+this,l=arguments,o=s,m=new C,v=l[2]||s,e=v||m,n=i?l[0]:{a:m},w=!i||l[1]===O?P:l[1];f--;)"string"===typeof A[f]&&(A[f]=D(A[f],M,c)),a=function(){},a.prototype=o=A[f].call(r,n,w,v),0<f&&(a.prototype.constructor=function(){}),e=v=new a;w||(m.parent=o);if(x||i)a=function(h,d,N){h[d]=function(){var h=n.a.parent,d=n.a.__class__;n.a.parent=m.parent;
n.a.__class__=e.__class__;var a=N.apply(this===e||this==q?n.a:this,arguments);n.a.__class__=d;n.a.parent=h;return a};h[d].toString=function(){return N.toString()}},t(m,function(h,d){"function"===typeof d&&!w?a(e,h,d):(!w&&d&&"object"===typeof d&&("set"in d&&"function"===typeof d.set&&a(d,"set",d.set),"get"in d&&"function"===typeof d.get&&a(d,"get",d.get)),e[h]=d)}),n.a=i?n.a:e;i&&p in e&&(e.constructor=e[p]);w||(e.__class__=c);if(!i&&0!==k)if(E){if(F){if(b===r){b="StaticClass"+Q+E++;var u=[],z=0,
y=["Class "+b];t(e,function(h,d){var a=0===h.indexOf("$")?1:0===h.indexOf("get ")?2:0===h.indexOf("set ")?3:"toString"===h?4:d&&"object"===typeof d&&(d.set||d.get)?5:0;if(a){var b=4===a?h:(z=1)&&1===a?h.substring(1):5===a?h:h.split(" ").pop();k[h]=d;3!==a&&y.push("Public "+(4===a?"Default ":"")+"Property Get ["+b+"]","Call VBCorrectVal("+(1===a?e.__get?'me.[__get].call(me,"'+b+'")':"":k[h]&&(5!==a||k[h].get)?"[(accessors)].["+h+"]"+(5===a?".get":"")+".call(me,[(accessors)].["+h+"])":"window.undefined")+
",["+b+"])","End Property");if(a&1||4===a)y.push("Public Property Let ["+b+"](val)",a=(1===a?e.__set?'Call me.[__set].call(me,"'+b+'",val)':"":4===a?"Set [(accessors)].["+h+"]=val":k[h]&&(5!==a||k[h].set)?"Call [(accessors)].["+h+"]"+(5===a?".set":"")+".call(me,val,[(accessors)].["+h+"])":"")+"\nEnd Property","Public Property Set ["+b+"](val)",a)}a||(50===u.length&&(y.push("Public ["+u.join("],[")+"]"),u.length=0),u[u.length]=h)},1);z?(y.push((u.length?"Public ["+u.join("],[")+"]\n":"")+"Private [(accessors)]",
"Private Sub Class_Initialize()","Set [(accessors)]="+b+"FactoryJS()","End Sub","End Class","Function "+b+"Factory()","Set "+b+"Factory=New "+b,"End Function"),q[b+"FactoryJS"]=function(){return g},execVBScript(y.join("\n"))):(k=0,b=s);u=y=s}b&&(g={},t(k,function(a){g[a]=e[a]}),n.a=q[b+"Factory"](),t(e,function(a,d){k.hasOwnProperty(a)||((!x||w)&&"function"===typeof d?(n.a[a]=function(){return d.apply(this===e||this==q?n.a:this,arguments)},n.a[a].toString=function(){return d.toString()}):n.a[a]=d)},
1),e=n.a)}}else if(t(j?e:k,function(a,d){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:d&&"object"===typeof d&&(d.set||d.get)?5:0;if(b){j&&(k[a]=d,g++);d=e[a];G.call(e,a)&&delete e[a];var c=1===b?a.substring(1):5===b?a:a.split(" ").pop(),f={enumerable:1,configurable:1,set:s,get:s};3!==b&&(f.get=function(){return((b===1?e.__get:b===5?d.get:d)||B(c,0)).call(this,b===1?c:d)});b&1&&(f.set=function(a){((b===1?e.__set:b===5?d.set:d)||B(c,1)).call(this,b===1?c:a,b===1?a:d)});
if(H){var i=Object.getOwnPropertyDescriptor(e,c);f.get=f.get||i&&i.get||B(c,0);f.set=f.set||i&&i.set||B(c,1);H(e,c,f)}else 3!==b&&e.__defineGetter__(c,f.get),b&1&&e.__defineSetter__(c,f.set)}},j?1:0),j&&!(j=0)&&0===g)k=0;return new (i?function(){return e}:function(){p in e?e[p].apply(e,l):e.constructor&&e.constructor!==Object.prototype.constructor&&e.constructor.apply(e,l);return e})}var j=1,k={},g=0,b=r,a=arguments,p,i=a.length-1,C=a[i--]||{},l={"extends":1,"implements":1},f="object"===typeof a[i]&&
a[i]?a[i--]:{},v=f.statics||(f.context||f["extends"]||f["implements"]||f.disableStatement?{}:f),z="function"===typeof a[i]||"string"===typeof a[i-1]?a[i--]:"",m=((a[i--]||"")+("string"==typeof z?" extends "+z:"")).replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),M=a[i--]||f.context||o.defaultContext||q,I=!(m[0]in l)&&m.shift()||"",J=(i=m.shift())in l&&(l=m.shift())?l.split(","):[],K="extends"===i?(i=m.shift(),J.shift()):"",m="implements"===i?J.concat((l=m.shift())?l.split(","):
[]):J,x=f["extends"]||K||z,l=f["implements"]||m,A=l instanceof Array?(x&&l.unshift(x),l):x&&[x,l]||[l],L=A.length,P=f.disableStatement;if("function"!==typeof C)var R=C,C=function(){return R};c.toString=function(){return"[class "+(I||"Object")+"]"};t(v,function(a,b){c[a]=b});if(c.className=I){f=M;a=(m=I.split(".")).shift();do 0===m.length?f[p=a]=c:(a in f||(f[a]={}),f=f[a]);while(a=m.shift())}return c}var t,D,Q=(new Date).getTime(),K=Object.prototype.toString,H=Object.defineProperty,G=Object.prototype.hasOwnProperty,
F=+((q.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),E=(H||Object.prototype.__defineGetter__)&&(!F||8<F)?0:1,L=!{toString:1}.propertyIsEnumerable("toString"),p="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");o.classByName=D=function(c,j,k){var g,b=c,a=j=j||o.defaultContext||o;if("string"===typeof b){for(b=b.split(".");(g=b.shift())&&(a=a[g]););b=a}if(!b&&k&&!("function"===typeof o.autoload&&(b=o.autoload.call(j,
c,k)||D(c,j))))throw Error("Parent class '"+c+"' not Initialized or Undefined");return b};o.ownEach=t=function(c,j,k){var g,b,a=p.length;if("[object Array]"===K.call(c)){a=c.length;for(g=0;g<a&&!(b=c[g],j.call(c[g],k?b:g,k?g:b)===r);g++);}else{for(g in c)if(b=c[g],(k&&b!==Object.prototype[g]||G.call(c,g))&&j.call(b,g,b)===r){a=r;break}if(a&&L)for(g=0;g<a&&!(b=c[p[g]],(G.call(c,p[g])||k&&b!=s&&b!==Object.prototype[p[g]])&&j.call(b,p[g],b)===r);g++);}};o.instanceOf=function(c,j){for(;c&&c.__class__!=
s;){if(c.__class__===j)return v;c=c.parent}return r};t(["classByName","ownEach","instanceOf"],function(c,j){o[j].toString=o.toString=function(){return"[object Function]"}});E&&!("execVBscript"in q)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");q.Class=o})(window,!0,!1,null);
