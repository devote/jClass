/*
 * light.core.class.min.js Library for JavaScript v0.5.5.3
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 01-02-2013
 */
(function(q,C,t,u,D){function B(b,l){return function(){throw Error("'"+b+"' property is "+(l?"read":"write")+"-only");}}function h(){function b(){for(var f=E,j=0===+this,h=arguments,o=u,n=new p,s=h[2]||u,e=s||n,m=j?h[0]:{a:n},x=!j||h[1]===D||F!==D?F:h[1];f--;)"string"===typeof A[f]&&(A[f]=G(A[f],O,b)),c=function(){},c.prototype=o=A[f].call(t,m,x,s),0<f&&!x&&(c.prototype.constructor=function(){}),e=s=new c;x||(n.parent=o);if(E||j)c=function(i,d,P){i[d]=function(){var i=m.a.parent,d=m.a.__class__;m.a.parent=
n.parent;m.a.__class__=e.__class__;var a=P.apply(this===e||this==q?m.a:this,arguments);m.a.__class__=d;m.a.parent=i;return a};i[d].toString=function(){return P.toString()}},v(n,function(i,d){"function"===typeof d&&!x?c(e,i,d):(!x&&d&&"object"===typeof d&&("set"in d&&"function"===typeof d.set&&c(d,"set",d.set),"get"in d&&"function"===typeof d.get&&c(d,"get",d.get)),e[i]=d)}),m.a=j?m.a:e;x||(j&&r in e&&(e.constructor=e[r]),e.__class__=b);if(!j&&0!==k)if(H){if(I){if(a===t){a="StaticClass"+S+H++;var w=
[],y=0,z=["Class "+a];v(e,function(i,d){var a=i.indexOf("$")===0?1:i.indexOf("get ")===0?2:i.indexOf("set ")===0?3:i==="toString"?4:d&&typeof d==="object"&&(d.set||d.get)?5:0;if(a){var b=a===4?i:(y=1)&&a===1?i.substring(1):a===5?i:i.split(" ").pop();k[i]=d;a!==3&&z.push("Public "+(a===4?"Default ":"")+"Property Get ["+b+"]","Call VBCorrectVal("+(a===1?e.__get?'me.[__get].call(me,"'+b+'")':"":k[i]&&(a!==5||k[i].get)?"[(accessors)].["+i+"]"+(a===5?".get":"")+".call(me,[(accessors)].["+i+"])":"window.undefined")+
",["+b+"])","End Property");a!==2&&z.push("Public Property Let ["+b+"](val)",a=(a===1?e.__set?'Call me.[__set].call(me,"'+b+'",val)':"":a===4?"Set [(accessors)].["+i+"]=val":k[i]&&(a!==5||k[i].set)?"Call [(accessors)].["+i+"]"+(a===5?".set":"")+".call(me,val,[(accessors)].["+i+"])":"")+"\nEnd Property","Public Property Set ["+b+"](val)",a)}if(!a){if(w.length===50){z.push("Public ["+w.join("],[")+"]");w.length=0}w[w.length]=i}},1);y?(z.push((w.length?"Public ["+w.join("],[")+"]\n":"")+"Private [(accessors)]",
"Private Sub Class_Initialize()","Set [(accessors)]="+a+"FactoryJS()","End Sub","End Class","Function "+a+"Factory()","Set "+a+"Factory=New "+a,"End Function"),q[a+"FactoryJS"]=function(){return g},execVBScript(z.join("\n"))):(k=0,a=u);w=z=u}a&&(g={},v(k,function(a){g[a]=e[a]}),m.a=q[a+"Factory"](),v(e,function(a,d){if(!k.hasOwnProperty(a))if((!E||x)&&typeof d==="function"){m.a[a]=function(){return d.apply(this===e||this==q?m.a:this,arguments)};m.a[a].toString=function(){return d.toString()}}else m.a[a]=
d},1),e=m.a)}}else if(v(l?e:k,function(a,d){var b=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:d&&typeof d==="object"&&(d.set||d.get)?5:0;if(b){if(l){k[a]=d;g++}d=e[a];J.call(e,a)&&delete e[a];var c=b===1?a.substring(1):b===5?a:a.split(" ").pop(),f={enumerable:1,configurable:1,set:u,get:u};if(b!==3)f.get=function(){return((b===1?e.__get:b===5?d.get:d)||B(c,0)).call(this,b===1?c:d)};if(b!==2)f.set=function(a){((b===1?e.__set:b===5?d.set:d)||B(c,1)).call(this,b===1?c:a,b===1?
a:d)};if(K){var j=Object.getOwnPropertyDescriptor(e,c);f.get=f.get||j&&j.get||B(c,0);f.set=f.set||j&&j.set||B(c,1);K(e,c,f)}else{b!==3&&e.__defineGetter__(c,f.get);b!==2&&e.__defineSetter__(c,f.set)}}},l?1:0),l&&!(l=0)&&0===g)k=0;return new (j?function(){return e}:function(){r in e?e[r].apply(e,h):e.constructor&&e.constructor!==Object.prototype.constructor&&e.constructor.apply(e,h);return e})}var l=1,k={},g=0,a=t,r,c=arguments,f=c.length-1,p=c[f--]||{},C=this instanceof h,j=!c[f]||c[f]instanceof y||
"object"!==typeof c[f]?{}:c[f--],s=j["extends"],F=j.compact,n=j["implements"],Q=j.context,M=j.statics||(Q||s||n||F!==D?{}:j),R="function"===typeof c[f]?[c[f--]]:c[f]instanceof y?c[f--]:"string"===typeof c[f-1]&&(""+c[f--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[],o="string"===typeof c[f]&&c[f--].split(/extends|implements|,/g)||[],O=c[f--]||Q||h.defaultContext||q,L=(o.shift()||"").replace(/^\s+|\s+$/g,""),f=s instanceof
y?s:s?[s]:[],n=n instanceof y?n:n?[n]:[],o=(j=o.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?j.split(","):[],A=o.concat.apply(o,R.concat.apply(R,f.concat.apply(f,n))),E=A.length;if("function"!==typeof p)var N=p,p=function(){return N};b.toString=function(){return"[class "+(L||"Object")+"]"};v(M,function(a,c){b[a]=c});if(b.className=L){j=O;c=(o=L.split(".")).shift();do 0===o.length?j[r=c]=b:(c in j||(j[c]={}),j=j[c]);while(c=o.shift())}return C?new b:b}var y=q.Array,v,G,S=(new Date).getTime(),
M=Object.prototype.toString,K=Object.defineProperty,J=Object.prototype.hasOwnProperty,I=+((q.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),H=(K||Object.prototype.__defineGetter__)&&(!I||8<I)?0:1,N=!{toString:1}.propertyIsEnumerable("toString"),p="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");h.classByName=G=function(b,l,k){var g,a=b,r=l=l||h.defaultContext||h;if("string"===typeof a){for(a=a.split(".");(g=
a.shift())&&(r=r[g]););a=r}if(!a&&k&&!("function"===typeof h.autoload&&(a=h.autoload.call(l,b,k)||G(b,l))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return a};h.ownEach=v=function(b,l,k){var g,a,h=p.length;if("[object Array]"===M.call(b)){h=b.length;for(g=0;g<h&&!(a=b[g],l.call(b[g],k?a:g,k?g:a)===t);g++);}else{for(g in b)if(a=b[g],(k&&a!==Object.prototype[g]||J.call(b,g))&&l.call(a,g,a)===t){h=t;break}if(h&&N)for(g=0;g<h&&!(a=b[p[g]],(J.call(b,p[g])||k&&a!=u&&a!==Object.prototype[p[g]])&&
l.call(a,p[g],a)===t);g++);}};h.instanceOf=function(b,h){for(;b&&b.__class__!=u;){if(b.__class__===h)return C;b=b.parent}return t};v(["classByName","ownEach","instanceOf"],function(b,l){h[l].toString=h.toString=function(){return"[object Function]"}});H&&!("execVBscript"in q)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");q.Class=h})(window,!0,!1,null);
