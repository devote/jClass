/*
 * jClass - class definition for JavaScript v1.4.1
 *
 * Copyright 2012-2014, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 06/16/2014
 */
(function(h,T,w,o,M){function N(b,d){return function(){throw Error("'"+b+"' property is "+(d?"read":"write")+"-only");}}function u(){}function m(b,d,i,e,C){function g(){var a=H,d=this instanceof O,c=arguments,j=o,l=C.apply(e,d?c[0]:c),m=d&&c[3]||o,f=w||m||l,n=d?c[1]:{a:l},k=!d||c[2]===M||D!==M?D:c[2];for(A(L,function(P,b){B.call(l,P)||(l[P]=b)});a--;)"string"===typeof i[a]&&(i[a]=U(i[a],b)),u.prototype=j=i[a].call(new O,c,n,k,m),0<a&&(n.i=o),f=m=new u,k||(f.parent=j,V&&(f.__proto__=j));if(H||d||w){var q=
function(b){return k?b:"function"===typeof b?function(){var a=n.a,d=a.parent;!k&&(a.parent=j);var c=b.apply(this===f||this==h?a:this,arguments);!k&&(a.parent=d);return c}:b};A(l,function(b,a){if(a&&"object"===typeof a&&("set"in a&&(a.set=q(a.set)),"get"in a))a.get=q(a.get);f[b]=q(a)});n.a=d?n.a:f}k||(f.__class__=g);if(!d&&0!==x){if(!y||z)A(z?f:x,function(a){var b=f[a],d=a,c=!z?x[a]:b&&"object"===typeof b&&"parent"!==a&&"__proto__"!==a&&(b.set||b.get)?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?
3:y&&"toString"===a?4:0;if(c)if(z&&4!==(x[a]=c)&&I++,1===c?(u.prototype=b,b=new u):d=a.split(" ").pop(),y)3!==c&&p.push("Public "+(4===c?"Default ":"")+"Property Get ["+d+"]","Call VBCorrectVal("+(b&&(1!==c||b.get)?"[(accessors)].["+a+"]"+(1===c?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+",["+d+"])","End Property"),2!==c&&p.push("Public Property Let ["+d+"](val)",c=(4===c?"Set [(accessors)].["+a+"]=val":b&&(1!==c||b.set)?"Call [(accessors)].["+a+"]"+(1===c?".set":"")+".call(me,val,[(accessors)].["+
a+"])":"")+"\nEnd Property","Public Property Set ["+d+"](val)",c);else{var e=function(a){((c===1?b.set:b)||N(d,1)).call(this,a,b)},g=function(){return((c===1?b.get:b)||N(d,0)).call(this,b)};B.call(f,a)&&delete f[a];E?(a=r.getOwnPropertyDescriptor(f,d),E(f,d,{enumerable:F?0:1,configurable:1,set:2===c&&a&&a.set||e,get:3===c&&a&&a.get||g})):(f.__defineSetter__(d,2===c&&f.__lookupSetter__(d)||e),f.__defineGetter__(d,3===c&&f.__lookupGetter__(d)||g))}else y&&(50===t.length&&(p.push("Public ["+t.join("],[")+
"]"),t.length=0),t[t.length]=a)},z);z&&!(z=0)&&0===I?t=p=x=0:y&&(I&&(v="StaticClass"+J+F++,p.unshift("Class "+v),p.push((t.length?"Public ["+t.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+v+"FactoryJS()","End Sub","End Class","Function "+v+"Factory()","Set "+v+"Factory=New "+v,"End Function"),h[v+"FactoryJS"]=function(){return p},h.execVBScript(p.join("\n")),I=t=p=o),p={},n.a=h[v+"Factory"](),A(f,function(a,b){if(x.hasOwnProperty(a))if(x[a]===
1){u.prototype=f[a];p[a]=new u}else p[a]=f[a];else n.a[a]=(!H||k)&&typeof b==="function"&&a!=="__class__"?function(){return b.apply(this===f||this==h?n.a:this,arguments)}:b},1),f=n.a)}B.call(f,s)?n.i=f[s]:B.call(f,"constructor")&&(n.i=f.constructor);return new function(){!d&&"function"===typeof n.i&&n.i.apply(f,c);return f}}var j,k,q,y=F,z=1,a=arguments,c=a.length-1,s="constructor",v=o,p=[],t=[],I=0,x=F===o?0:{},w,l,L,D,H,K=this instanceof m,C=a[c--]||{};if(a[c]&&"object"===typeof a[c]&&!(a[c]instanceof
G)&&a[c].constructor&&a[c].constructor!==r.prototype.constructor){if(F&&E)try{E(a[c],"t"+J,{configurable:1,set:function(a){y=a}}),a[c]["t"+J]=0,delete a[c]["t"+J]}catch(S){}w=y?o:(D=T,a[c--])}e=!a[c]||a[c]instanceof G||"object"!==typeof a[c]?{}:a[c--];D=D||e.compact;j=e.context;k=e.extend;q=e.mixins;L=e.statics||(j||k||q||"compact"in e?{}:e);i=a[c]instanceof G?a[c--]:"function"===typeof a[c]?[a[c--]]:"string"===typeof a[c-1]&&(""+a[c--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,
"").replace(/\s*,\s*/g,",").split(",")||[];l="string"===typeof a[c]&&a[c--].split(/extends|implements|,/g)||[];b=a[c--]||j||m.classScope||(m.classScope=h);d=(l.shift()||"").replace(/^\s+|\s+$/g,"");j=(l=l.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?l.split(","):[];k=(k=k||[])instanceof G?k:[k];q=(q=q||[])instanceof G?q:[q];i=j.concat.apply(j,i.concat.apply(i,k.concat.apply(k,q)));H=i.length;if("function"!==typeof C)var Q=C,C=function(){u.prototype=Q.constructor.prototype;l=new u;
A(Q,function(a,b){l[a]=b});return l};g.toString=function(){return"[class "+(d||"Object")+"]"};g.getInstanceOf=R;g.baseContext=b;A(L,function(a,b){g[a]=b});if(g.className=d){j=b;a=(l=d.split(".")).shift();do 0===l.length?j[s=a]=g:(a in j||(j[a]={}),j=j[a]);while(a=l.shift())}return K?new g:g}function K(b,d){var i=o,e=d,h,g;if("string"===typeof b){for(g=b.split(".");(h=g.shift())&&(d=d[h]););"function"===typeof d&&e===d.b&&(i=d)}return i}function U(b,d){var i=K(b,d)||K(b,h)||"function"===typeof m.autoload&&
m.autoload(b,d)||o;if(!i)throw Error("Parent class '"+b+"' not Initialized or Undefined");return i}function A(b,d,i){var e,h=s.length,g;for(e in b)if(g=b[e],(i&&g!==r.prototype[e]||B.call(b,e))&&d.call(g,e,g)===w){h=w;break}if(h&&S)for(e=0;e<h&&!(g=b[s[e]],(B.call(b,s[e])||i&&s[e]in b&&g!==r.prototype[s[e]])&&d.call(g,s[e],g)===w);e++);}function R(b){for(;b&&b.__class__!=o;){if(b.__class__===this)return b;b=r.getPrototypeOf?r.getPrototypeOf(b):b.__proto__}return o}var G=h.Array,r=h.Object,O=h.Boolean,
E=r.defineProperty,B=r.prototype.hasOwnProperty,V=!(r.getPrototypeOf||r.prototype.__proto__),J=(new Date).getTime(),S=!{toString:1}.propertyIsEnumerable("toString"),s="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");m.instanceOf=function(b,d){return!!R.call(d,b)};var F=function(b){function d(d){b=d}try{E(b,"t",{set:d})}catch(i){try{b.__defineSetter__("t",d)}catch(e){}}b.t=0;b&&(b=1,"execVBscript"in h||("execScript"in h?h.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript"):b=o));return b}({});m.classScope=m.classScope||h;h.jClass=m})(window,!0,!1,null);
