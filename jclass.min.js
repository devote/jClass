/*
 * jClass - class definition for JavaScript v1.4.4
 *
 * Copyright 2012-2014, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 06/19/2014
 */
(function(h,M,x,o,N){function O(b,c){return function(){throw Error("'"+b+"' property is "+(c?"read":"write")+"-only");}}function U(b){return function(){return b}}function m(b,c,g,e,D){function i(){var a=H,d=this instanceof P,c=arguments,j=o,l=D.apply({isParent:d,options:e},d?c[0]:c),m=d&&c[3]||o,f=x||m||l,n=d?c[1]:{a:l},k=!d||c[2]===N||A!==N?A:c[2];for(B(L,function(Q,b){C.call(l,Q)||(l[Q]=b)});a--;)"function"!==typeof g[a]&&(g[a]="string"===typeof g[a]?V(g[a],b):U(g[a])),u.prototype=j=g[a].call(new P,
c,n,k,m),0<a&&(n.i=o),f=m=new u,k||(f.parent=j,W&&(f.__proto__=j));if(H||d||x){var q=function(b){return k?b:"function"===typeof b?function(){var a=n.a,d=a.parent;!k&&(a.parent=j);var c=b.apply(this===f||this==h?a:this,arguments);!k&&(a.parent=d);return c}:b};B(l,function(b,a){if(a&&"object"===typeof a&&("set"in a&&(a.set=q(a.set)),"get"in a))a.get=q(a.get);f[b]=q(a)});n.a=d?n.a:f}k||(f.__class__=i);if(!d&&0!==v){if(!y||z)B(z?f:v,function(a){var b=f[a],d=a,c=!z?v[a]:b&&"object"===typeof b&&"parent"!==
a&&"__proto__"!==a&&(b.set||b.get)?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:y&&"toString"===a?4:0;if(c)if(z&&4!==(v[a]=c)&&I++,1===c?(u.prototype=b,b=new u):(d=a.split(" ").pop(),3!==c&&"function"!==typeof b&&(b=function(a){return function(){return a}}(b))),y)3!==c&&p.push("Public "+(4===c?"Default ":"")+"Property Get ["+d+"]","Call VBCorrectVal("+(b&&(1!==c||b.get)?"[(accessors)].["+a+"]"+(1===c?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+",["+d+"])","End Property"),
2!==c&&p.push("Public Property Let ["+d+"](val)",c=(4===c?"Set [(accessors)].["+a+"]=val":b&&(1!==c||b.set)?"Call [(accessors)].["+a+"]"+(1===c?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+d+"](val)",c);else{var e=function(a){((c===1?b.set:c===3&&b)||O(d,1)).call(this,a,b)},g=function(){return((c===1?b.get:c!==3&&b)||O(d,0)).call(this,b)};C.call(f,a)&&delete f[a];E?(a=r.getOwnPropertyDescriptor(f,d),E(f,d,{enumerable:F?0:1,configurable:1,set:2===c&&
a&&a.set||e,get:3===c&&a&&a.get||g})):(f.__defineSetter__(d,2===c&&f.__lookupSetter__(d)||e),f.__defineGetter__(d,3===c&&f.__lookupGetter__(d)||g))}else y&&(50===t.length&&(p.push("Public ["+t.join("],[")+"]"),t.length=0),t[t.length]=a)},z);z&&!(z=0)&&0===I?t=p=v=0:y&&(I&&(w="StaticClass"+J+F++,p.unshift("Class "+w),p.push((t.length?"Public ["+t.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+w+"FactoryJS()","End Sub","End Class","Function "+w+"Factory()",
"Set "+w+"Factory=New "+w,"End Function"),h[w+"FactoryJS"]=function(){return p},h.execVBScript(p.join("\n")),I=t=p=o),p={},n.a=h[w+"Factory"](),B(f,function(a,b){if(v.hasOwnProperty(a))if(v[a]===1){u.prototype=f[a];p[a]=new u}else p[a]=v[a]!==3&&typeof b!=="function"?function(){return b}:f[a];else n.a[a]=(!H||k)&&typeof b==="function"&&a!=="__class__"?function(){return b.apply(this===f||this==h?n.a:this,arguments)}:b},1),f=n.a)}C.call(f,s)?n.i=f[s]:C.call(f,"constructor")&&(n.i=f.constructor);return new function(){!d&&
"function"===typeof n.i&&n.i.apply(f,c);return f}}var j,k,q,y=F,z=1,a=arguments,d=a.length-1,s="constructor",w=o,p=[],t=[],I=0,v=F===o?0:{},x,l,L,A,H,K=this instanceof m,D=a[d--]||{};if(a[d]&&"object"===typeof a[d]&&!(a[d]instanceof G)&&a[d].constructor&&a[d].constructor!==r.prototype.constructor){if(F&&E)try{E(a[d],"t"+J,{configurable:1,set:function(a){y=a}}),a[d]["t"+J]=0,delete a[d]["t"+J]}catch(T){}x=y?o:(A=M,a[d--])}e=!a[d]||a[d]instanceof G||"object"!==typeof a[d]?"boolean"===typeof a[d]||"number"===
typeof a[d]?{compact:a[d--]}:{}:a[d--];A=A||e.compact;j=e.context;k=e.extend;q=e.mixins;L=e.statics||(j||k||q||"compact"in e?{}:e);g=a[d]instanceof G?a[d--]:"function"===typeof a[d]?[a[d--]]:"string"===typeof a[d-1]&&(""+a[d--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];l="string"===typeof a[d]&&a[d--].split(/extends|implements|,/g)||[];b=a[d--]||j||m.classScope||(m.classScope=h);c=(l.shift()||"").replace(/^\s+|\s+$/g,
"");j=(l=l.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?l.split(","):[];k=(k=k||[])instanceof G?k:[k];q=(q=q||[])instanceof G?q:[q];g=j.concat.apply(j,g.concat.apply(g,k.concat.apply(k,q)));if(!(H=g.length||c))A=M;if("function"!==typeof D)var R=D,D=function(){u.prototype=R.constructor.prototype;l=new u;B(R,function(a,b){l[a]=b});return l};i.toString=function(){return"[class "+(c||"Object")+"]"};i.getInstanceOf=S;i.baseContext=b;B(L,function(a,b){i[a]=b});if(i.className=c){j=b;
a=(l=c.split(".")).shift();do 0===l.length?j[s=a]=i:(a in j||(j[a]={}),j=j[a]);while(a=l.shift())}return K?new i:i}function K(b,c){var g=o,e=c,h,i;if("string"===typeof b){for(i=b.split(".");(h=i.shift())&&(c=c[h]););"function"===typeof c&&e===c.baseContext&&(g=c)}return g}function V(b,c){var g=K(b,c)||K(b,h)||"function"===typeof m.autoload&&m.autoload(b,c)||o;if(!g)throw Error("Parent class '"+b+"' not Initialized or Undefined");return g}function B(b,c,g){var e,h=s.length,i;for(e in b)if(i=b[e],(g&&
i!==r.prototype[e]||C.call(b,e))&&c.call(i,e,i)===x){h=x;break}if(h&&T)for(e=0;e<h&&!(i=b[s[e]],(C.call(b,s[e])||g&&s[e]in b&&i!==r.prototype[s[e]])&&c.call(i,s[e],i)===x);e++);}function S(b){for(;b&&b.__class__!=o;){if(b.__class__===this)return b;b=r.getPrototypeOf?r.getPrototypeOf(b):b.__proto__}return o}var G=h.Array,r=h.Object,P=h.Boolean,E=r.defineProperty,C=r.prototype.hasOwnProperty,W=!(r.getPrototypeOf||r.prototype.__proto__),u=function(){return function(){}}(),J=(new Date).getTime(),T=!{toString:1}.propertyIsEnumerable("toString"),
s="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");m.instanceOf=function(b,c){return!!S.call(c,b)};var F=function(b){function c(c){b=c}try{E(b,"t",{set:c})}catch(g){try{b.__defineSetter__("t",c)}catch(e){}}b.t=0;b&&(b=1,"execVBscript"in h||("execScript"in h?h.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"):b=o));return b}({});
m.classScope=m.classScope||h;h.jClass=m})(window,!0,!1,null);
