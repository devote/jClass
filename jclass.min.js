/*
 * jClass - class definition for JavaScript v1.4.5
 *
 * Copyright 2012-2014, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 06/19/2014
 */
(function(h,O,x,o,L){function P(a,c){return function(){throw Error("'"+a+"' property is "+(c?"read":"write")+"-only");}}function T(a){return function(){return a}}function m(a,c,i,e,D){function g(){var b=this instanceof Q,d=arguments;if(!b&&!(this instanceof g))return M.call(g,d[0]);var c=H,j=o,l=D.apply({isParent:b,options:e},b?d[0]:d),m=b&&d[3]||o,f=x||m||l,n=b?d[1]:{a:l},k=!b||d[2]===L||y!==L?y:d[2];for(B(N,function(b,a){C.call(l,b)||(l[b]=a)});c--;)"function"!==typeof i[c]&&(i[c]="string"===typeof i[c]?
U(i[c],a):T(i[c])),u.prototype=j=i[c].call(new Q,d,n,k,m),0<c&&(n.i=o),f=m=new u,k||(f.parent=j,V&&(f.__proto__=j));if(H||b||x){var q=function(b){return k?b:"function"===typeof b?function(){var a=n.a,d=a.parent;!k&&(a.parent=j);var c=b.apply(this===f||this==h?a:this,arguments);!k&&(a.parent=d);return c}:b};B(l,function(b,a){if(a&&"object"===typeof a&&("set"in a&&(a.set=q(a.set)),"get"in a))a.get=q(a.get);f[b]=q(a)});n.a=b?n.a:f}k||(f.__class__=g);if(!b&&0!==v){if(!z||A)B(A?f:v,function(a){var b=f[a],
d=a,c=!A?v[a]:b&&"object"===typeof b&&"parent"!==a&&"__proto__"!==a&&(b.set||b.get)?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:z&&"toString"===a?4:0;if(c)if(A&&4!==(v[a]=c)&&I++,1===c?(u.prototype=b,b=new u):(d=a.split(" ").pop(),3!==c&&"function"!==typeof b&&(b=function(a){return function(){return a}}(b))),z)3!==c&&p.push("Public "+(4===c?"Default ":"")+"Property Get ["+d+"]","Call VBCorrectVal("+(b&&(1!==c||b.get)?"[(accessors)].["+a+"]"+(1===c?".get":"")+".call(me,[(accessors)].["+a+"])":
"window.undefined")+",["+d+"])","End Property"),2!==c&&p.push("Public Property Let ["+d+"](val)",c=(4===c?"Set [(accessors)].["+a+"]=val":b&&(1!==c||b.set)?"Call [(accessors)].["+a+"]"+(1===c?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+d+"](val)",c);else{var e=function(a){((c===1?b.set:c===3&&b)||P(d,1)).call(this,a,b)},g=function(){return((c===1?b.get:c!==3&&b)||P(d,0)).call(this,b)};C.call(f,a)&&delete f[a];E?(a=r.getOwnPropertyDescriptor(f,d),E(f,
d,{enumerable:F?0:1,configurable:1,set:2===c&&a&&a.set||e,get:3===c&&a&&a.get||g})):(f.__defineSetter__(d,2===c&&f.__lookupSetter__(d)||e),f.__defineGetter__(d,3===c&&f.__lookupGetter__(d)||g))}else z&&(50===t.length&&(p.push("Public ["+t.join("],[")+"]"),t.length=0),t[t.length]=a)},A);A&&!(A=0)&&0===I?t=p=v=0:z&&(I&&(w="StaticClass"+J+F++,p.unshift("Class "+w),p.push((t.length?"Public ["+t.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+w+"FactoryJS()",
"End Sub","End Class","Function "+w+"Factory()","Set "+w+"Factory=New "+w,"End Function"),h[w+"FactoryJS"]=function(){return p},h.execVBScript(p.join("\n")),I=t=p=o),p={},n.a=h[w+"Factory"](),B(f,function(a,b){if(v.hasOwnProperty(a))if(v[a]===1){u.prototype=f[a];p[a]=new u}else p[a]=v[a]!==3&&typeof b!=="function"?function(){return b}:f[a];else n.a[a]=(!H||k)&&typeof b==="function"&&a!=="__class__"?function(){return b.apply(this===f||this==h?n.a:this,arguments)}:b},1),f=n.a)}C.call(f,s)?n.i=f[s]:
C.call(f,"constructor")&&(n.i=f.constructor);return new function(){!b&&"function"===typeof n.i&&n.i.apply(f,d);return f}}var j,k,q,z=F,A=1,b=arguments,d=b.length-1,s="constructor",w=o,p=[],t=[],I=0,v=F===o?0:{},x,l,N,y,H,K=this instanceof m,D=b[d--]||{};if(b[d]&&"object"===typeof b[d]&&!(b[d]instanceof G)&&b[d].constructor&&b[d].constructor!==r.prototype.constructor){if(F&&E)try{E(b[d],"t"+J,{configurable:1,set:function(a){z=a}}),b[d]["t"+J]=0,delete b[d]["t"+J]}catch(S){}x=z?o:(y=O,b[d--])}e=!b[d]||
b[d]instanceof G||"object"!==typeof b[d]?"boolean"===typeof b[d]||"number"===typeof b[d]?{compact:b[d--]}:{}:b[d--];y=y||e.compact;j=e.context;k=e.extend;q=e.mixins;N=e.statics||(j||k||q||"compact"in e?{}:e);i=b[d]instanceof G?b[d--]:"function"===typeof b[d]?[b[d--]]:"string"===typeof b[d-1]&&(""+b[d--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];l="string"===typeof b[d]&&b[d--].split(/extends|implements|,/g)||[];
a=b[d--]||j||m.classScope||(m.classScope=h);c=(l.shift()||"").replace(/^\s+|\s+$/g,"");j=(l=l.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?l.split(","):[];k=(k=k||[])instanceof G?k:[k];q=(q=q||[])instanceof G?q:[q];i=j.concat.apply(j,i.concat.apply(i,k.concat.apply(k,q)));if(!(H=i.length)&&!(c||y!==L))y=O;if("function"!==typeof D)var R=D,D=function(){u.prototype=R.constructor.prototype;l=new u;B(R,function(a,b){l[a]=b});return l};g.toString=function(){return"[class "+(c||"Object")+
"]"};g.getInstanceOf=M;g.baseContext=a;B(N,function(a,b){g[a]=b});if(g.className=c){j=a;b=(l=c.split(".")).shift();do 0===l.length?j[s=b]=g:(b in j||(j[b]={}),j=j[b]);while(b=l.shift())}return K?new g:g}function K(a,c){var i=o,e=c,h,g;if("string"===typeof a){for(g=a.split(".");(h=g.shift())&&(c=c[h]););"function"===typeof c&&e===c.baseContext&&(i=c)}return i}function U(a,c){var i=K(a,c)||K(a,h)||"function"===typeof m.autoload&&m.autoload(a,c)||o;if(!i)throw Error("Parent class '"+a+"' not Initialized or Undefined");
return i}function B(a,c,i){var e,h=s.length,g;for(e in a)if(g=a[e],(i&&g!==r.prototype[e]||C.call(a,e))&&c.call(g,e,g)===x){h=x;break}if(h&&S)for(e=0;e<h&&!(g=a[s[e]],(C.call(a,s[e])||i&&s[e]in a&&g!==r.prototype[s[e]])&&c.call(g,s[e],g)===x);e++);}function M(a){for(;a&&a.__class__!=o;){if(a.__class__===this)return a;a=r.getPrototypeOf?r.getPrototypeOf(a):a.__proto__}return o}var G=h.Array,r=h.Object,Q=h.Boolean,E=r.defineProperty,C=r.prototype.hasOwnProperty,V=!(r.getPrototypeOf||r.prototype.__proto__),
u=function(){return function(){}}(),J=(new Date).getTime(),S=!{toString:1}.propertyIsEnumerable("toString"),s="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" ");m.instanceOf=function(a,c){return!!M.call(c,a)};var F=function(a){function c(c){a=c}try{E(a,"t",{set:c})}catch(i){try{a.__defineSetter__("t",c)}catch(e){}}a.t=0;a&&(a=1,"execVBscript"in h||("execScript"in h?h.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript"):a=o));return a}({});m.classScope=m.classScope||h;h.jClass=m})(window,!0,!1,null);
