/*
 * jClass - class definition for JavaScript v1.4.3
 *
 * Copyright 2012-2014, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 06/17/2014
 */
(function(h,O,y,o,P){function Q(a,d){return function(){throw Error("'"+a+"' property is "+(d?"read":"write")+"-only");}}function m(a,d,i,e,F){function g(){var b=J,d=this instanceof R,c=arguments,j=o,l=F.apply(e,d?c[0]:c),m=d&&c[3]||o,f=y||m||l,n=d?c[1]:{a:l},k=!d||c[2]===P||B!==P?B:c[2];for(C(N,function(t,D){E.call(l,t)||(l[t]=D)});b--;)"string"===typeof i[b]&&(i[b]=V(i[b],a)),v.prototype=j=i[b].call(new R,c,n,k,m),0<b&&(n.i=o),f=m=new v,k||(f.parent=j,W&&(f.__proto__=j));if(J||d||y){var q=function(t){return k?
t:"function"===typeof t?function(){var D=n.a,a=D.parent;!k&&(D.parent=j);var b=t.apply(this===f||this==h?D:this,arguments);!k&&(D.parent=a);return b}:t};C(l,function(t,a){if(a&&"object"===typeof a&&("set"in a&&(a.set=q(a.set)),"get"in a))a.get=q(a.get);f[t]=q(a)});n.a=d?n.a:f}k||(f.__class__=g);if(!d&&0!==w){if(!z||A)C(A?f:w,function(a){var b=f[a],d=a,c=!A?w[a]:b&&"object"===typeof b&&"parent"!==a&&"__proto__"!==a&&(b.set||b.get)?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:z&&"toString"===a?
4:0;if(c)if(A&&4!==(w[a]=c)&&K++,1===c?(v.prototype=b,b=new v):(d=a.split(" ").pop(),3!==c&&"function"!==typeof b&&(b=function(a){return function(){return a}}(b))),z)3!==c&&p.push("Public "+(4===c?"Default ":"")+"Property Get ["+d+"]","Call VBCorrectVal("+(b&&(1!==c||b.get)?"[(accessors)].["+a+"]"+(1===c?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+",["+d+"])","End Property"),2!==c&&p.push("Public Property Let ["+d+"](val)",c=(4===c?"Set [(accessors)].["+a+"]=val":b&&(1!==c||b.set)?
"Call [(accessors)].["+a+"]"+(1===c?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+d+"](val)",c);else{var e=function(a){((c===1?b.set:c===3&&b)||Q(d,1)).call(this,a,b)},g=function(){return((c===1?b.get:c!==3&&b)||Q(d,0)).call(this,b)};E.call(f,a)&&delete f[a];G?(a=r.getOwnPropertyDescriptor(f,d),G(f,d,{enumerable:H?0:1,configurable:1,set:2===c&&a&&a.set||e,get:3===c&&a&&a.get||g})):(f.__defineSetter__(d,2===c&&f.__lookupSetter__(d)||e),f.__defineGetter__(d,
3===c&&f.__lookupGetter__(d)||g))}else z&&(50===u.length&&(p.push("Public ["+u.join("],[")+"]"),u.length=0),u[u.length]=a)},A);A&&!(A=0)&&0===K?u=p=w=0:z&&(K&&(x="StaticClass"+L+H++,p.unshift("Class "+x),p.push((u.length?"Public ["+u.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+x+"FactoryJS()","End Sub","End Class","Function "+x+"Factory()","Set "+x+"Factory=New "+x,"End Function"),h[x+"FactoryJS"]=function(){return p},h.execVBScript(p.join("\n")),
K=u=p=o),p={},n.a=h[x+"Factory"](),C(f,function(a,b){if(w.hasOwnProperty(a))if(w[a]===1){v.prototype=f[a];p[a]=new v}else p[a]=w[a]!==3&&typeof b!=="function"?function(){return b}:f[a];else n.a[a]=(!J||k)&&typeof b==="function"&&a!=="__class__"?function(){return b.apply(this===f||this==h?n.a:this,arguments)}:b},1),f=n.a)}E.call(f,s)?n.i=f[s]:E.call(f,"constructor")&&(n.i=f.constructor);return new function(){!d&&"function"===typeof n.i&&n.i.apply(f,c);return f}}var j,k,q,z=H,A=1,b=arguments,c=b.length-
1,s="constructor",x=o,p=[],u=[],K=0,w=H===o?0:{},y,l,N,B,J,M=this instanceof m,F=b[c--]||{};if(b[c]&&"object"===typeof b[c]&&!(b[c]instanceof I)&&b[c].constructor&&b[c].constructor!==r.prototype.constructor){if(H&&G)try{G(b[c],"t"+L,{configurable:1,set:function(a){z=a}}),b[c]["t"+L]=0,delete b[c]["t"+L]}catch(U){}y=z?o:(B=O,b[c--])}e=!b[c]||b[c]instanceof I||"object"!==typeof b[c]?{}:b[c--];B=B||e.compact;j=e.context;k=e.extend;q=e.mixins;N=e.statics||(j||k||q||"compact"in e?{}:e);i=b[c]instanceof
I?b[c--]:"function"===typeof b[c]?[b[c--]]:"string"===typeof b[c-1]&&(""+b[c--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];l="string"===typeof b[c]&&b[c--].split(/extends|implements|,/g)||[];a=b[c--]||j||m.classScope||(m.classScope=h);d=(l.shift()||"").replace(/^\s+|\s+$/g,"");j=(l=l.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?l.split(","):[];k=(k=k||[])instanceof I?k:[k];q=(q=q||[])instanceof
I?q:[q];i=j.concat.apply(j,i.concat.apply(i,k.concat.apply(k,q)));if(!(J=i.length||d))B=O;if("function"!==typeof F)var S=F,F=function(){v.prototype=S.constructor.prototype;l=new v;C(S,function(a,b){l[a]=b});return l};g.toString=function(){return"[class "+(d||"Object")+"]"};g.getInstanceOf=T;g.baseContext=a;C(N,function(a,b){g[a]=b});if(g.className=d){j=a;b=(l=d.split(".")).shift();do 0===l.length?j[s=b]=g:(b in j||(j[b]={}),j=j[b]);while(b=l.shift())}return M?new g:g}function M(a,d){var i=o,e=d,h,
g;if("string"===typeof a){for(g=a.split(".");(h=g.shift())&&(d=d[h]););"function"===typeof d&&e===d.baseContext&&(i=d)}return i}function V(a,d){var i=M(a,d)||M(a,h)||"function"===typeof m.autoload&&m.autoload(a,d)||o;if(!i)throw Error("Parent class '"+a+"' not Initialized or Undefined");return i}function C(a,d,i){var e,h=s.length,g;for(e in a)if(g=a[e],(i&&g!==r.prototype[e]||E.call(a,e))&&d.call(g,e,g)===y){h=y;break}if(h&&U)for(e=0;e<h&&!(g=a[s[e]],(E.call(a,s[e])||i&&s[e]in a&&g!==r.prototype[s[e]])&&
d.call(g,s[e],g)===y);e++);}function T(a){for(;a&&a.__class__!=o;){if(a.__class__===this)return a;a=r.getPrototypeOf?r.getPrototypeOf(a):a.__proto__}return o}var I=h.Array,r=h.Object,R=h.Boolean,G=r.defineProperty,E=r.prototype.hasOwnProperty,W=!(r.getPrototypeOf||r.prototype.__proto__),v=function(){return function(){}}(),L=(new Date).getTime(),U=!{toString:1}.propertyIsEnumerable("toString"),s="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" ");
m.instanceOf=function(a,d){return!!T.call(d,a)};var H=function(a){function d(d){a=d}try{G(a,"t",{set:d})}catch(i){try{a.__defineSetter__("t",d)}catch(e){}}a.t=0;a&&(a=1,"execVBscript"in h||("execScript"in h?h.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"):a=o));return a}({});m.classScope=m.classScope||h;h.jClass=m})(window,!0,!1,null);
