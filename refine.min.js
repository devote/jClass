/**
 * RefineJS v1.2.0 - Powerful and flexible generator objects with the possibility of inheritance for JavaScript
 * Copyright 2011-2014 Dmitrii Pakhtinov (spb.piksel@gmail.com)
 * Released under the MIT license
 * Update: 07/25/2014
 */
(function(P){"function"===typeof define&&define.amd?define("object"!==typeof document||"loading"!==document.readyState?[]:"refinejs",P):"object"===typeof exports&&"undefined"!==typeof module?module.exports=P():P()})(function(){function S(c,d){return function(){throw Error("'"+c+"' property is "+(d?"read":"write")+"-only");}}function W(c){return function(){return c}}function m(c,d,j,f,G){function h(){var a=this instanceof T,b=arguments;if(!a&&!(this instanceof h))return Q.call(h,b[0]);var d=K,k=p,l=G.apply({isParent:a,options:f},a?b[0]:b),m=a&&b[3]||p,g=L||m||l,n=a?b[1]:{a:l},q=!a||b[2]===D||z!==D?z:b[2];for(E(C,function(a,e){F.call(l,a)||(l[a]=e)});d--;)if("function"!==typeof j[d]&&("string"===typeof j[d]?
j[d]=X(j[d],c):(j[d]=W(j[d]),q=q===D?R:q)),v.prototype=k=j[d].call(new T,b,n,q,m),0<d&&(n.i=p),g=m=new v,!q)g.parent=k,Y&&(g.__proto__=k);if(K||a||L){var o=function(a){return q?a:"function"===typeof a?function(){var e=n.a,c=e.parent;!q&&(e.parent=k);var b=a.apply(this===g||this==i?e:this,arguments);!q&&(e.parent=c);return b}:a};E(l,function(a,e){if(e&&"object"===typeof e&&("set"in e&&(e.set=o(e.set)),"get"in e))e.get=o(e.get);g[a]=o(e)});n.a=a?n.a:g}q||(g.__refine__=h);if(!a&&0!==w){if(!A||B)E(B?
g:w,function(a){var e=g[a],c=a,b=!B?w[a]:e&&"object"===typeof e&&"parent"!==a&&"__proto__"!==a&&(e.set||e.get)?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:A&&"toString"===a?4:0;if(b)if(B&&4!==(w[a]=b)&&M++,1===b?(v.prototype=e,e=new v):(c=a.split(" ").pop(),3!==b&&"function"!==typeof e&&(e=function(a){return function(){return a}}(e))),A)3!==b&&r.push("Public "+(4===b?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(e&&(1!==b||e.get)?"[(accessors)].["+a+"]"+(1===b?".get":"")+".call(me,[(accessors)].["+
a+"])":"window.undefined")+",["+c+"])","End Property"),2!==b&&r.push("Public Property Let ["+c+"](val)",b=(4===b?"Set [(accessors)].["+a+"]=val":e&&(1!==b||e.set)?"Call [(accessors)].["+a+"]"+(1===b?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+c+"](val)",b);else{var d=q?D:S(c,1),f=q?D:S(c,0);if(1===b?e.set:3===b&&e)d=function(a){(b===1?e.set:e).call(this,a,e)};if(1===b?e.get:2===b&&e)f=function(){return(b===1?e.get:e).call(this,e)};F.call(g,a)&&delete g[a];
H?(a=s.getOwnPropertyDescriptor(g,c),H(g,c,{enumerable:I?0:1,configurable:1,set:2===b&&a&&a.set||d,get:3===b&&a&&a.get||f})):((d=2===b&&g.__lookupSetter__(c)||d)&&g.__defineSetter__(c,d),(f=3===b&&g.__lookupGetter__(c)||f)&&g.__defineGetter__(c,f))}else A&&(50===u.length&&(r.push("Public ["+u.join("],[")+"]"),u.length=0),u[u.length]=a)},B);B&&!(B=0)&&0===M?u=r=w=0:A&&(M&&(x="StaticClass"+N+I++,r.unshift("Class "+x),r.push((u.length?"Public ["+u.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()",
"Set [(accessors)]="+x+"FactoryJS()","End Sub","End Class","Function "+x+"Factory()","Set "+x+"Factory=New "+x,"End Function"),i[x+"FactoryJS"]=function(){return r},i.execVBScript(r.join("\n")),M=u=r=p),r={},n.a=i[x+"Factory"](),E(g,function(a,b){if(w.hasOwnProperty(a))if(w[a]===1){v.prototype=g[a];r[a]=new v}else r[a]=w[a]!==3&&typeof b!=="function"?function(){return b}:g[a];else n.a[a]=(!K||q)&&typeof b==="function"&&a!=="__refine__"?function(){return b.apply(this===g||this==i?n.a:this,arguments)}:
b},1),g=n.a)}F.call(g,t)?n.i=g[t]:F.call(g,"constructor")&&(n.i=g.constructor);return new function(){!a&&(!L&&"function"===typeof n.i)&&n.i.apply(g,b);return g}}var k,o,y,A=I,B=1,a=arguments,b=a.length-1,t="constructor",x=p,r=[],u=[],M=0,w=I===p?0:{},L,l,C,z,K,O=this instanceof m,G=a[b--]||{};if(a[b]&&"object"===typeof a[b]&&!(a[b]instanceof J)&&a[b].constructor&&a[b].constructor!==s.prototype.constructor){if(I&&H)try{H(a[b],"t"+N,{configurable:1,set:function(a){A=a}}),a[b]["t"+N]=0,delete a[b]["t"+
N]}catch(V){}L=A?p:(z=R,a[b--])}f=!a[b]||a[b]instanceof J||"object"!==typeof a[b]?"boolean"===typeof a[b]||"number"===typeof a[b]?{compact:a[b--]}:{}:a[b--];z=z||f.compact;k=f.context;o=f.extend;y=f.mixins;C=f.statics||(k||o||y||"compact"in f?{}:f);j=a[b]instanceof J?a[b--]:"function"===typeof a[b]?[a[b--]]:"string"===typeof a[b-1]&&(""+a[b--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];l="string"===typeof a[b]&&
a[b--].split(/extends|implements|,/g)||[];c=a[b--]||k||m.refineScope||(m.refineScope=i);d=(l.shift()||"").replace(/^\s+|\s+$/g,"");k=(l=l.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?l.split(","):[];o=(o=o||[])instanceof J?o:[o];y=(y=y||[])instanceof J?y:[y];j=k.concat.call(k,j.concat.call(j,o.concat.call(o,y)));if(!(K=j.length)&&!(d||z!==D))z=R;if("function"!==typeof G)var U=G,G=function(){v.prototype=U.constructor.prototype;l=new v;E(U,function(a,b){l[a]=b});return l};h.toString=
function(){return"[object "+(d||"Function")+"]"};h.getInstanceOf=Q;h.baseContext=c;E(C,function(a,b){h[a]=b});if(h.b=d){k=c;a=(l=d.split(".")).shift();do 0===l.length?k[t=a]=h:(a in k||(k[a]={}),k=k[a]);while(a=l.shift())}return O?new h:h}function O(c,d){var j=p,f=d,i,h;if("string"===typeof c){for(h=c.split(".");(i=h.shift())&&(d=d[i]););"function"===typeof d&&f===d.baseContext&&(j=d)}return j}function X(c,d){var j=O(c,d)||O(c,i)||"function"===typeof m.autoload&&m.autoload(c,d)||p;if(!j)throw Error("Parent constructor '"+
c+"' not Initialized or Undefined");return j}function E(c,d,j){var f,i=t.length,h;for(f in c)if(h=c[f],(j&&h!==s.prototype[f]||F.call(c,f))&&d.call(h,f,h)===C){i=C;break}if(i&&V)for(f=0;f<i&&!(h=c[t[f]],(F.call(c,t[f])||j&&t[f]in c&&h!==s.prototype[t[f]])&&d.call(h,t[f],h)===C);f++);}function Q(c){for(;c&&c.__refine__!=p;){if(c.__refine__===this)return c;c=s.getPrototypeOf?s.getPrototypeOf(c):c.__proto__}return p}var R=!0,C=!1,p=null,D=void 0,i=("object"===typeof window?window:"undefined"!==typeof global?
global:this)||{},J=i.Array,s=i.Object,T=i.Boolean,H=s.defineProperty,F=s.prototype.hasOwnProperty,Y=!(s.getPrototypeOf||s.prototype.__proto__),v=function(){return function(){}}(),N=(new Date).getTime(),V=!{toString:1}.propertyIsEnumerable("toString"),t="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" ");m.instanceOf=function(c,d){return!!Q.call(d,c)};var I=function(c){function d(d){c=d}try{H(c,"t",{set:d})}catch(j){try{c.__defineSetter__("t",
d)}catch(f){}}c.t=0;c&&(c=1,"execVBscript"in i||("execScript"in i?i.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"):c=p));return c}({});m.refineScope=m.refineScope||i;return i.refine=i.refinejs=m});