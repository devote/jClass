/**
 * RefineJS v1.2.1 - Powerful and flexible generator objects with the possibility of inheritance for JavaScript
 * Copyright 2011-2014 Dmitrii Pakhtinov (spb.piksel@gmail.com)
 * Released under the MIT license
 * Update: 07/25/2014
 */
(function(P){"function"===typeof define&&define.amd?define("object"!==typeof document||"loading"!==document.readyState?[]:"refinejs",P):"object"===typeof exports&&"undefined"!==typeof module?module.exports=P():P()})(function(){function S(c,d){return function(){throw Error("'"+c+"' property is "+(d?"read":"write")+"-only");}}function W(c){return function(){return c}}function u(c,d,i,f,H){function g(){var a=this instanceof T,b=arguments;if(!a&&!(this instanceof g))return Q.call(g,b[0]);var d=L,k=o,l=H.apply({isParent:a,options:f},a?b[0]:b),m=a&&b[3]||o,h=M||m||l,n=a?b[1]:{a:l},p=!a||b[2]===F||A!==F?A:b[2];for(B(E,function(a,e){G.call(l,a)||(l[a]=e)});d--;)if("function"!==typeof i[d]&&("string"===typeof i[d]?
i[d]=X(i[d],c):(i[d]=W(i[d]),p=p===F?R:p)),x.prototype=k=i[d].call(new T,b,n,p,m),0<d&&(n.i=o),h=m=new x,!p)h.parent=k,Y&&(h.__proto__=k);if(L||a||M){var r=function(a){return p?a:"function"===typeof a?function(){var e=n.a,c=e.parent;!p&&(e.parent=k);var b=a.apply(this===h||this==j?e:this,arguments);!p&&(e.parent=c);return b}:a};B(l,function(a,e){if(e&&"object"===typeof e&&("set"in e&&(e.set=r(e.set)),"get"in e))e.get=r(e.get);h[a]=r(e)});n.a=a?n.a:h}p||(h.__refine__=g);if(!a&&0!==y){if(!C||D)B(D?
h:y,function(a){var e=h[a],c=a,b=!D?y[a]:e&&"object"===typeof e&&"parent"!==a&&"__proto__"!==a&&(e.set||e.get)?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:C&&"toString"===a?4:0;if(b)if(D&&4!==(y[a]=b)&&w++,1===b?(x.prototype=e,e=new x):(c=a.split(" ").pop(),3!==b&&"function"!==typeof e&&(e=function(a){return function(){return a}}(e))),C)3!==b&&q.push("Public "+(4===b?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(e&&(1!==b||e.get)?"[(accessors)].["+a+"]"+(1===b?".get":"")+".call(me,[(accessors)].["+
a+"])":"window.undefined")+",["+c+"])","End Property"),2!==b&&q.push("Public Property Let ["+c+"](val)",b=(4===b?"Set [(accessors)].["+a+"]=val":e&&(1!==b||e.set)?"Call [(accessors)].["+a+"]"+(1===b?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+c+"](val)",b);else{var d=p?F:S(c,1),g=p?F:S(c,0);if(1===b?e.set:3===b&&e)d=function(a){(b===1?e.set:e).call(this,a,e)};if(1===b?e.get:2===b&&e)g=function(){return(b===1?e.get:e).call(this,e)};G.call(h,a)&&delete h[a];
I?(a=s.getOwnPropertyDescriptor(h,c),I(h,c,{enumerable:J?0:1,configurable:1,set:2===b&&a&&a.set||d,get:3===b&&a&&a.get||g})):((d=2===b&&h.__lookupSetter__(c)||d)&&h.__defineSetter__(c,d),(g=3===b&&h.__lookupGetter__(c)||g)&&h.__defineGetter__(c,g))}else C&&(50===v.length&&(q.push("Public ["+v.join("],[")+"]"),v.length=0),v[v.length]=a)},D);D&&!(D=0)&&0===w?v=q=y=0:C&&(w&&(z="StaticClass"+N+J++,q.unshift("Class "+z),q.push((v.length?"Public ["+v.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()",
"Set [(accessors)]="+z+"FactoryJS()","End Sub","End Class","Function "+z+"Factory()","Set "+z+"Factory=New "+z,"End Function"),j[z+"FactoryJS"]=function(){return q},j.execVBScript(q.join("\n")),w=v=q=o),q={},n.a=j[z+"Factory"](),B(h,function(a,b){if(y.hasOwnProperty(a))if(y[a]===1){x.prototype=h[a];q[a]=new x}else q[a]=y[a]!==3&&typeof b!=="function"?function(){return b}:h[a];else n.a[a]=(!L||p)&&typeof b==="function"&&a!=="__refine__"?function(){return b.apply(this===h||this==j?n.a:this,arguments)}:
b},1),h=n.a)}G.call(h,t)?n.i=h[t]:G.call(h,"constructor")&&(n.i=h.constructor);return new function(){!a&&!M&&"function"===typeof n.i&&n.i.apply(h,b);return h}}var k,l,r,C=J,D=1,a=arguments,b=a.length-1,t="constructor",z=o,q=[],v=[],w=0,y=J===o?0:{},M,m,E,A,L,O=this instanceof u,H=a[b--]||{};if(a[b]&&"object"===typeof a[b]&&!(a[b]instanceof K)&&a[b].constructor&&a[b].constructor!==s.prototype.constructor){if(J&&I)try{I(a[b],"t"+N,{configurable:1,set:function(a){C=a}}),a[b]["t"+N]=0,delete a[b]["t"+
N]}catch(V){}M=C?o:(A=R,a[b--])}f=!a[b]||a[b]instanceof K||"object"!==typeof a[b]?"boolean"===typeof a[b]||"number"===typeof a[b]?{compact:a[b--]}:{}:a[b--];A=A||f.compact;k=f.context;l=f.extend;r=f.mixins;E=f.statics||(k||l||r||"compact"in f?{}:f);i=a[b]instanceof K?a[b--]:"function"===typeof a[b]?[a[b--]]:"string"===typeof a[b-1]&&(""+a[b--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];m="string"===typeof a[b]&&
a[b--].split(/extends|implements|,/g)||[];c=a[b--]||k||u.refineScope||(u.refineScope=j);d=(m.shift()||"").replace(/^\s+|\s+$/g,"");k=(m=m.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?m.split(","):[];l=(l=l||[])instanceof K?l:[l];r=(r=r||[])instanceof K?r:[r];i=k.concat.call(k,i.concat.call(i,l.concat.call(l,r)));if(!(L=i.length)&&!(d||A!==F))A=R;if("function"!==typeof H)var U=H,H=function(){x.prototype=U.constructor.prototype;m=new x;B(U,function(a,b){m[a]=b});return m};g.toString=
function(){return"[object "+(d||"Function")+"]"};g.getInstanceOf=Q;g.baseContext=c;B(E,function(a,b){g[a]=b});if(g.b=d){k=c;a=(m=d.split(".")).shift();do 0===m.length?k[t=a]=g:(a in k||(k[a]={}),k=k[a]);while(a=m.shift())}return O?new g:g}function O(c,d){var i=o,f=d,j,g;if("string"===typeof c){for(g=c.split(".");(j=g.shift())&&(d=d[j]););"function"===typeof d&&f===d.baseContext&&(i=d)}return i}function X(c,d){var i=O(c,d)||O(c,j)||"function"===typeof u.autoload&&u.autoload(c,d)||o;if(!i)throw Error("Parent constructor '"+
c+"' not Initialized or Undefined");return i}function B(c,d,i){var f,j=t.length,g;for(f in c)if(g=c[f],(i&&g!==s.prototype[f]||G.call(c,f))&&d.call(g,f,g)===E){j=E;break}if(j&&V)for(f=0;f<j&&!(g=c[t[f]],(G.call(c,t[f])||i&&t[f]in c&&g!==s.prototype[t[f]])&&d.call(g,t[f],g)===E);f++);}function Q(c){for(;c&&c.__refine__!=o;){if(c.__refine__===this)return c;c=s.getPrototypeOf?s.getPrototypeOf(c):c.__proto__}return o}var R=!0,E=!1,o=null,F=void 0,j=("object"===typeof window?window:"undefined"!==typeof global?
global:this)||{},w=j.JSON,K=j.Array,s=j.Object,T=j.Boolean,I=s.defineProperty,G=s.prototype.hasOwnProperty,Y=!(s.getPrototypeOf||s.prototype.__proto__),x=function(){return function(){}}(),N=(new Date).getTime(),V=!{toString:1}.propertyIsEnumerable("toString"),t="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");u.instanceOf=function(c,d){return!!Q.call(d,c)};var J=function(c,d){function i(d){c=d}try{I(c,"t",{set:i})}catch(f){try{c.__defineSetter__("t",
i)}catch(t){}}c.t=0;c&&(c=1,"execVBscript"in j||("execScript"in j?j.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"):c=o),c&&"function"===typeof d&&(w.stringify=function(c){if(c&&!(c instanceof s)){var f={};B(c,function(c,d){"__proto__"!==c&&(f[c]=d)});arguments[0]=f}return d.apply(w,arguments)}));return c}({},w&&w.stringify);u.refineScope=u.refineScope||j;return j.refine=j.refinejs=u});