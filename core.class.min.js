/*
 * core.class.js Library for JavaScript v0.3.2
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 17-07-2012
 */
(function(y,B,p,i,z){function g(b,d,c,a,f){function t(){var a=0===+this,d=arguments,q=new f,e=q,h=a?d[0]:{a:q};q.parent=i;if(c){if("string"===typeof c&&!(c=b[e=c]||"function"===typeof g.autoload&&g.autoload.call(b,e)||b[e]))throw Error("Parent class '"+e+"' not Initialized or Undefined");q.parent=c.call(p,h);var k=function(){};k.prototype=q.parent;e=new k}else e.shared={};if(c||a)g.ownEach(q,function(b,a){"function"===typeof a?(e[b]=function(){var b=h.a.parent,c=h.a.Class;h.a.parent=q.parent;h.a.Class=
e.Class;var d=a.apply(this===e||this==y?h.a:this,arguments);h.a.Class=c;h.a.parent=b;return d},e[b].toString=function(){return a.toString()}):e[b]=a}),h.a=a?h.a:e;e.Class=t;if(!a&&0!==j)if(w){if(x){if(m===p){m="StaticClass"+C+w++;var r=[],o=0,s=["Class "+m];g.ownEach(e,function(b){var a=0===b.indexOf("$")?1:0===b.indexOf("get ")?2:0===b.indexOf("set ")?3:"toString"===b?4:0;if(a){var c=4===a?"("+b+")":(o=1)&&1===a?b.substring(1):b.split(" ").pop();if(1===a||2===a||4===a)s.push("Public "+(4===a?"Default ":
"")+"Property Get ["+c+"]","Call VBCorrectVal("+(1===a?e.__get?'me.[__get].call(me,"'+c+'")':"":e[b]?"me.["+b+"].call(me)":"")+",["+c+"])","End Property");if(1===a||3===a)s.push("Public Property Let ["+c+"](val)",1===a?e.__set?'Call me.[__set].call(me,"'+c+'",val)':"":e[b]?"Call me.["+b+"].call(me,val)":"","End Property","Public Property Set ["+c+"](val)",1===a?e.__set?'Call me.[__set].call(me,"'+c+'",val)':"":e[b]?"Call me.["+b+"].call(me,val)":"","End Property")}if(!a||1<a)50===r.length&&(s.push("Public ["+
r.join("],[")+"]"),r.length=0),r[r.length]=b,j[j.length]=b},1);o?(s.push("Public ["+r.join("],[")+"]","End Class","Function "+m+"Factory()","Set "+m+"Factory=New "+m,"End Function"),execVBScript(s.join("\n"))):(j=0,m=i);r=s=i}if(m){h.a=window[m+"Factory"]();for(k=j.length;n=j[--k];)h.a[n]=e[n];e=h.a}}}else if(g.ownEach(v?e:j,function(b){var a=0===b.indexOf("$")?1:0===b.indexOf("get ")?2:0===b.indexOf("set ")?3:0;if(a){v&&(j[j.length]=b);var c=1===a?b.substring(1):b.split(" ").pop(),d={enumerable:1,
configurable:1,set:i,get:i};if(1===a||2===a)d.get=function(){return(e[1===a?"__get":b]||l).call(this,1===a?c:z)};if(1===a||3===a)d.set=function(d){(e[1===a?"__set":b]||l).call(this,1===a?c:d,1===a?d:z)};if(Object.defineProperty){var f=Object.getOwnPropertyDescriptor(e,c);d.get=d.get||f&&f.get||l;d.set=d.set||f&&f.set||l;Object.defineProperty(e,c,d)}else(1===a||2===a)&&e.__defineGetter__(c,d.get),(1===a||3===a)&&e.__defineSetter__(c,d.set)}},1),v&&!(v=0)&&0===j.length)j=0;return new (a?function(){return e}:
function(){e.constructor&&e.constructor!==Object.prototype.constructor&&e.constructor.apply(e,d);return e})}function l(){}var n,k=[],o,v=1,j=[],m=p;if(3>arguments.length||"string"===typeof b||"function"===typeof b&&"object"===typeof d)f=a,a=c,c=d,d=b,b=g;"string"===typeof d?(k=d.replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").split(" "),o=k[0]&&"extends"!==k[0]&&k.shift()||0):(f=a,a=c,c=d,d=i);f||((f=a)?"object"===typeof c?(a=c,c=null):a=i:(f=c,c=a=i));"string"===typeof c&&(n=c);if(f&&(n||"extends"===k.shift()||
"function"===typeof d))c=(n||(n=k.shift()))&&!(d=b[n])?n:d;if("function"!==typeof f)var u=f,f=function(){return u};t.toString=function(){return"[class "+(o||"Object")+"]"};a&&g.ownEach(a,function(b){t[b]=a[b]});o&&(b[o]=t,b[o].className=o);return t}var x=eval("/*@cc_on (@_jscript_version+'').replace(/\\d\\./, '');@*/"),C=(new Date).getTime(),w=(Object.defineProperty||Object.prototype.__defineGetter__)&&(!x||8<x)?0:1,u={},A=Object.prototype.hasOwnProperty,D=Object.prototype.toString,E=!{toString:i}.propertyIsEnumerable("toString"),
l="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(","),F=function(){w&&!("execVBscript"in window)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");var b=document.getElementsByTagName("script");return(b[b.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,"")}();g.ownEach=function(b,d,c){var a,f,g=l.length;if("[object Array]"===D.call(b)){g=
b.length;for(a=0;a<g&&!(f=b[a],d.call(b[a],c?f:a,c?a:f)===p);a++);}else{for(a in b)if(f=b[a],(c&&f!==Object.prototype[a]||A.call(b,a))&&d.call(f,a,f)===p){g=p;break}if(g&&E)for(a=0;a<g&&!(f=b[l[a]],(A.call(b,l[a])||c&&f!=i&&f!==Object.prototype[l[a]])&&d.call(f,l[a],f)===p);a++);}};g.instanceOf=function(b,d){for(;b&&b.Class!=i;){if(b.Class===d)return B;b=b.parent}return p};g.include=function(b,d){b=/^(?:http\:)?\/[\/]?/i.test(b)?b:F+b;if(u[b])d&&d();else{var c=new XMLHttpRequest;c.open("GET",b,!!d);
c.onreadystatechange=function(){if(4===c.readyState)if(200<=c.status&&300>c.status||304===c.status){u[b]=1;try{(window.execScript||function(a){window.eval.call(window,a)})(c.responseText)}catch(a){throw delete u[b],Error('Error executing module "'+b+'". '+a);}d&&d()}else throw Error("Module "+b+" not found");};c.send(i)}};g.ownEach.toString=g.instanceOf.toString=g.include.toString=g.toString=function(){return"[object Function]"};y.Class=g})(window,!0,!1,null);
