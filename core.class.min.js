/*
 * core.class.min.js Library for JavaScript v0.5.5.2
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 31-01-2013
 */
(function(o,x,r,s,N){function D(b,e){return function(){throw Error("'"+b+"' property is "+(e?"read":"write")+"-only");}}function g(){function b(){for(var a=w,f=0===+this,k=arguments,n=s,g=new E,y=k[2]||s,j=y||g,i=f?k[0]:{a:g},u=!f||k[1]===N||l!==N?l:k[1];a--;)"string"===typeof A[a]&&(A[a]=G(A[a],x,b)),h=function(){},h.prototype=n=A[a].call(r,i,u,y),0<a&&!u&&(h.prototype.constructor=function(){}),j=y=new h;u||(g.parent=n);if(w||f)h=function(a,c,b){a[c]=function(){var a=i.a.parent,c=i.a.__class__;i.a.parent=
g.parent;i.a.__class__=j.__class__;var e=b.apply(this===j||this==o?i.a:this,arguments);i.a.__class__=c;i.a.parent=a;return e};a[c].toString=function(){return b.toString()}},v(g,function(a,c){"function"===typeof c&&!u?h(j,a,c):(!u&&c&&"object"===typeof c&&("set"in c&&"function"===typeof c.set&&h(c,"set",c.set),"get"in c&&"function"===typeof c.get&&h(c,"get",c.get)),j[a]=c)}),i.a=f?i.a:j;u||(f&&t in j&&(j.constructor=j[t]),j.__class__=b);if(!f&&0!==m)if(H){if(B){if(d===r){d="StaticClass"+O+H++;var p=
[],z=0,q=["Class "+d];v(j,function(a,c){var b=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:a==="toString"?4:c&&typeof c==="object"&&(c.set||c.get)?5:0;if(b){var e=b===4?a:(z=1)&&b===1?a.substring(1):b===5?a:a.split(" ").pop();m[a]=c;b!==3&&q.push("Public "+(b===4?"Default ":"")+"Property Get ["+e+"]","Call VBCorrectVal("+(b===1?j.__get?'me.[__get].call(me,"'+e+'")':"":m[a]&&(b!==5||m[a].get)?"[(accessors)].["+a+"]"+(b===5?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+
",["+e+"])","End Property");if(b&1||b===4)q.push("Public Property Let ["+e+"](val)",b=(b===1?j.__set?'Call me.[__set].call(me,"'+e+'",val)':"":b===4?"Set [(accessors)].["+a+"]=val":m[a]&&(b!==5||m[a].set)?"Call [(accessors)].["+a+"]"+(b===5?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+e+"](val)",b)}if(!b){if(p.length===50){q.push("Public ["+p.join("],[")+"]");p.length=0}p[p.length]=a}},1);z?(q.push((p.length?"Public ["+p.join("],[")+"]\n":"")+"Private [(accessors)]",
"Private Sub Class_Initialize()","Set [(accessors)]="+d+"FactoryJS()","End Sub","End Class","Function "+d+"Factory()","Set "+d+"Factory=New "+d,"End Function"),o[d+"FactoryJS"]=function(){return c},execVBScript(q.join("\n"))):(m=0,d=s);p=q=s}d&&(c={},v(m,function(a){c[a]=j[a]}),i.a=o[d+"Factory"](),v(j,function(a,c){if(!m.hasOwnProperty(a))if((!w||u)&&typeof c==="function"){i.a[a]=function(){return c.apply(this===j||this==o?i.a:this,arguments)};i.a[a].toString=function(){return c.toString()}}else i.a[a]=
c},1),j=i.a)}}else if(v(e?j:m,function(a,b){var d=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(d){if(e){m[a]=b;c++}b=j[a];I.call(j,a)&&delete j[a];var f=d===1?a.substring(1):d===5?a:a.split(" ").pop(),i={enumerable:1,configurable:1,set:s,get:s};if(d!==3)i.get=function(){return((d===1?j.__get:d===5?b.get:b)||D(f,0)).call(this,d===1?f:b)};if(d&1)i.set=function(a){((d===1?j.__set:d===5?b.set:b)||D(f,1)).call(this,d===1?f:a,d===1?a:
b)};if(J){var k=Object.getOwnPropertyDescriptor(j,f);i.get=i.get||k&&k.get||D(f,0);i.set=i.set||k&&k.set||D(f,1);J(j,f,i)}else{d!==3&&j.__defineGetter__(f,i.get);d&1&&j.__defineSetter__(f,i.set)}}},e?1:0),e&&!(e=0)&&0===c)m=0;return new (f?function(){return j}:function(){t in j?j[t].apply(j,k):j.constructor&&j.constructor!==Object.prototype.constructor&&j.constructor.apply(j,k);return j})}var e=1,m={},c=0,d=r,t,h=arguments,a=h.length-1,E=h[a--]||{},k=!h[a]||h[a]instanceof F||"object"!==typeof h[a]?
{}:h[a--],y=k["extends"],l=k.compact,f=k["implements"],n=k.context,u=k.statics||(n||y||f||l?{}:k),i="function"===typeof h[a]?[h[a--]]:h[a]instanceof F?h[a--]:"string"===typeof h[a-1]&&(""+h[a--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[],p="string"===typeof h[a]&&h[a--].split(/extends|implements|,/g)||[],x=h[a--]||n||g.defaultContext||o,z=(p.shift()||"").replace(/^\s+|\s+$/g,""),a=y instanceof F?y:y?[y]:[],f=f instanceof
F?f:f?[f]:[],p=(k=p.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?k.split(","):[],A=p.concat.apply(p,i.concat.apply(i,a.concat.apply(a,f))),w=A.length;if("function"!==typeof E)var q=E,E=function(){return q};b.toString=function(){return"[class "+(z||"Object")+"]"};v(u,function(a,c){b[a]=c});if(b.className=z){k=x;h=(p=z.split(".")).shift();do 0===p.length?k[t=h]=b:(h in k||(k[h]={}),k=k[h]);while(h=p.shift())}return b}var F=o.Array,w=o.document,P=w.documentElement,O=(new Date).getTime(),
Q=Object.prototype.toString,J=Object.defineProperty,I=Object.prototype.hasOwnProperty,K=w.getElementsByTagName("script"),L=(K[K.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),B=+((o.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),H=(J||Object.prototype.__defineGetter__)&&(!B||8<B)?0:1,R=!{toString:1}.propertyIsEnumerable("toString"),v,G,M,q={},C="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");g.classByName=
G=function(b,e,m){var c,d=b,t=e=e||g.defaultContext||g;if("string"===typeof d){for(d=d.split(".");(c=d.shift())&&(t=t[c]););d=t}if(!d&&m&&!("function"===typeof g.autoload&&(d=g.autoload.call(e,b,m)||G(b,e))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return d};g.ownEach=v=function(b,e,m){var c,d,g=C.length;if("[object Array]"===Q.call(b)){g=b.length;for(c=0;c<g&&!(d=b[c],e.call(b[c],m?d:c,m?c:d)===r);c++);}else{for(c in b)if(d=b[c],(m&&d!==Object.prototype[c]||I.call(b,c))&&
e.call(d,c,d)===r){g=r;break}if(g&&R)for(c=0;c<g&&!(d=b[C[c]],(I.call(b,C[c])||m&&d!=s&&d!==Object.prototype[C[c]])&&e.call(d,C[c],d)===r);c++);}};g.instanceOf=function(b,e){for(;b&&b.__class__!=s;){if(b.__class__===e)return x;b=b.parent}return r};g.absoluteURL=M=function(b){return function(e,g){g&&!/^(?:https?:)?\/[\/]?/.test(e)&&(e=("string"===typeof g?g:L)+e);var g=o.location,c,d=g.pathname,e=/^(?:[a-z]+\:)?\/\//.test(e)?e:g.protocol+"//"+g.host+(0===e.indexOf("/")?e:0===e.indexOf("?")?d+e:0===
e.indexOf("#")?d+g.search+e:d.replace(/[^\/]+$/g,"")+e);b.href=e;c=b.protocol;d=b.pathname;e=(":"===c?g.protocol:c)+"//";e="http:"===c&&80==b.port||"https:"===c&&443==b.port?e+b.hostname:e+b.host;return e+(0===d.indexOf("/")?d:"/"+d)+b.search+b.hash}}(w.createElement("A"));g.imports=function(){function b(a,b){if(g.imports.onerror)g.imports.onerror(a,b);else throw Error(404==a?"Module "+b+" not found":'Error executing module "'+b+'".');}function e(a,b,c,d){if(a in q)c(a);else{var e=a+(0<a.indexOf("?")?
"&":"?")+(new Date).getTime(),f="XMLHttpRequest"in o?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");f.open("GET",g.imports.disableCaching?e:a,b);f.onreadystatechange=function(){if(4===f.readyState){var b=1223===f.status?204:0===f.status&&"file:"==(self.location||{}).protocol?200:f.status;if(200<=b&&300>b||304===b){try{(o.execScript||function(a){o.eval.call(o,a)})(f.responseText+"\n////@ sourceURL="+a)}catch(e){return d(b,a)}c(a)}else d(b,a)}};f.send(s)}}function m(a){function d(){var a;
if(l){l.onload=l.onreadystatechange=l.onerror=s;l.parentNode.removeChild(l);for(a in l)try{l[a]=s,delete l[a]}catch(b){}l=s}}function k(d,e){a.b&&a.b.call(a.scope||g,d,e)?0===c[0].scripts.length&&c.shift():(a.b||b(d,e),c.shift());m()}function h(b){if(!f){f=x;for(q[b]=1;c.length&&0===c[0].scripts.length;)a=c.shift(),a.c&&a.c.call(a.scope||g);m()}}if(a){if(c.unshift(a),1<c.length)return}else if(0===c.length)return;var a=c[0],l,f=r,n=a.scripts.shift();a.d&&B&&9>B?e(n,x,h,k):n in q?h(n):(l=w.createElement("script"),
l.type="text/javascript",l.onerror=function(){d();k(404,n)},"onload"in l||!("readyState"in l)?l.onload=function(){d();h(n)}:l.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)d(),h(n)},l.src=n+(g.imports.disableCaching?(0<n.indexOf("?")?"&":"?")+(new Date).getTime():""),P.firstChild.appendChild(l))}var c=[],d=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),t=r;try{w.querySelectorAll("html:not(a)"),t=x}catch(h){}return function(a,
c,h,o){for(var a=("string"===typeof a?[a]:a)||[],l=0,f,n=x,u=!!c,i=a.length,p={},v=t?w.querySelectorAll('script[src]:not([data-calmjs="1"])'):K;f=v[l++];)if(f.setAttribute("data-calmjs","1"),f=f.getAttribute("src"))q[M(f,L)]=1;for(;i--;){if(!d.test(a[i]=M(a[i],L)))n=r;a[i]in q||a[i]in p?a.splice(i,1):p[a[i]]=1}if(0===a.length)return c&&c.call(o||g);if(n&&!u){for(;f=a.shift();){e(f,r,function(a){q[a]=1;n=r},function(a,c){h&&h.call(o||g,a,c)?n=r:h||b(a,c)});if(n)return;n=x}return c&&c.call(o||g)}m({scope:o||
g,d:n,scripts:a,c:c||s,b:h||s})}}();v(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(b,e){g[e].toString=g.toString=function(){return"[object Function]"}});H&&!("execVBscript"in o)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");o.Class=g})(window,!0,!1,null);
