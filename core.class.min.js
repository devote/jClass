/*
 * core.class.min.js Library for JavaScript v0.5.5.3
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 01-02-2013
 */
(function(l,y,q,r,F){function C(b,e){return function(){throw Error("'"+b+"' property is "+(e?"read":"write")+"-only");}}function f(){function b(){for(var a=w,i=0===+this,h=arguments,k=r,f=new D,s=h[2]||r,j=s||f,p=i?h[0]:{a:f},u=!i||h[1]===F||G!==F?G:h[1];a--;)"string"===typeof v[a]&&(v[a]=H(v[a],N,b)),g=function(){},g.prototype=k=v[a].call(q,p,u,s),0<a&&!u&&(g.prototype.constructor=function(){}),j=s=new g;u||(f.parent=k);if(w||i)g=function(a,b,c){a[b]=function(){var a=p.a.parent,b=p.a.__class__;p.a.parent=
f.parent;p.a.__class__=j.__class__;var e=c.apply(this===j||this==l?p.a:this,arguments);p.a.__class__=b;p.a.parent=a;return e};a[b].toString=function(){return c.toString()}},z(f,function(a,b){"function"===typeof b&&!u?g(j,a,b):(!u&&b&&"object"===typeof b&&("set"in b&&"function"===typeof b.set&&g(b,"set",b.set),"get"in b&&"function"===typeof b.get&&g(b,"get",b.get)),j[a]=b)}),p.a=i?p.a:j;u||(i&&m in j&&(j.constructor=j[m]),j.__class__=b);if(!i&&0!==n)if(I){if(A){if(d===q){d="StaticClass"+O+I++;var x=
[],t=0,o=["Class "+d];z(j,function(a,b){var c=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:a==="toString"?4:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(c){var e=c===4?a:(t=1)&&c===1?a.substring(1):c===5?a:a.split(" ").pop();n[a]=b;c!==3&&o.push("Public "+(c===4?"Default ":"")+"Property Get ["+e+"]","Call VBCorrectVal("+(c===1?j.__get?'me.[__get].call(me,"'+e+'")':"":n[a]&&(c!==5||n[a].get)?"[(accessors)].["+a+"]"+(c===5?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+
",["+e+"])","End Property");c!==2&&o.push("Public Property Let ["+e+"](val)",c=(c===1?j.__set?'Call me.[__set].call(me,"'+e+'",val)':"":c===4?"Set [(accessors)].["+a+"]=val":n[a]&&(c!==5||n[a].set)?"Call [(accessors)].["+a+"]"+(c===5?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+e+"](val)",c)}if(!c){if(x.length===50){o.push("Public ["+x.join("],[")+"]");x.length=0}x[x.length]=a}},1);t?(o.push((x.length?"Public ["+x.join("],[")+"]\n":"")+"Private [(accessors)]",
"Private Sub Class_Initialize()","Set [(accessors)]="+d+"FactoryJS()","End Sub","End Class","Function "+d+"Factory()","Set "+d+"Factory=New "+d,"End Function"),l[d+"FactoryJS"]=function(){return c},execVBScript(o.join("\n"))):(n=0,d=r);x=o=r}d&&(c={},z(n,function(a){c[a]=j[a]}),p.a=l[d+"Factory"](),z(j,function(a,b){if(!n.hasOwnProperty(a))if((!w||u)&&typeof b==="function"){p.a[a]=function(){return b.apply(this===j||this==l?p.a:this,arguments)};p.a[a].toString=function(){return b.toString()}}else p.a[a]=
b},1),j=p.a)}}else if(z(e?j:n,function(a,b){var d=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(d){if(e){n[a]=b;c++}b=j[a];J.call(j,a)&&delete j[a];var i=d===1?a.substring(1):d===5?a:a.split(" ").pop(),h={enumerable:1,configurable:1,set:r,get:r};if(d!==3)h.get=function(){return((d===1?j.__get:d===5?b.get:b)||C(i,0)).call(this,d===1?i:b)};if(d!==2)h.set=function(a){((d===1?j.__set:d===5?b.set:b)||C(i,1)).call(this,d===1?i:a,d===1?
a:b)};if(K){var f=Object.getOwnPropertyDescriptor(j,i);h.get=h.get||f&&f.get||C(i,0);h.set=h.set||f&&f.set||C(i,1);K(j,i,h)}else{d!==3&&j.__defineGetter__(i,h.get);d!==2&&j.__defineSetter__(i,h.set)}}},e?1:0),e&&!(e=0)&&0===c)n=0;return new (i?function(){return j}:function(){m in j?j[m].apply(j,h):j.constructor&&j.constructor!==Object.prototype.constructor&&j.constructor.apply(j,h);return j})}var e=1,n={},c=0,d=q,m,g=arguments,a=g.length-1,D=g[a--]||{},x=this instanceof f,k=!g[a]||g[a]instanceof E||
"object"!==typeof g[a]?{}:g[a--],h=k["extends"],G=k.compact,i=k["implements"],u=k.context,s=k.statics||(u||h||i||G!==F?{}:k),y="function"===typeof g[a]?[g[a--]]:g[a]instanceof E?g[a--]:"string"===typeof g[a-1]&&(""+g[a--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[],t="string"===typeof g[a]&&g[a--].split(/extends|implements|,/g)||[],N=g[a--]||u||f.defaultContext||l,o=(t.shift()||"").replace(/^\s+|\s+$/g,""),a=h instanceof
E?h:h?[h]:[],i=i instanceof E?i:i?[i]:[],t=(k=t.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?k.split(","):[],v=t.concat.apply(t,y.concat.apply(y,a.concat.apply(a,i))),w=v.length;if("function"!==typeof D)var B=D,D=function(){return B};b.toString=function(){return"[class "+(o||"Object")+"]"};z(s,function(a,c){b[a]=c});if(b.className=o){k=N;g=(t=o.split(".")).shift();do 0===t.length?k[m=g]=b:(g in k||(k[g]={}),k=k[g]);while(g=t.shift())}return x?new b:b}var E=l.Array,o=l.document,
P=o.documentElement,O=(new Date).getTime(),Q=Object.prototype.toString,K=Object.defineProperty,J=Object.prototype.hasOwnProperty,B=o.getElementsByTagName("script"),L=(B[B.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),A=+((l.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),I=(K||Object.prototype.__defineGetter__)&&(!A||8<A)?0:1,R=!{toString:1}.propertyIsEnumerable("toString"),z,H,M,v={},w="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");
f.classByName=H=function(b,e,n){var c,d=b,m=e=e||f.defaultContext||f;if("string"===typeof d){for(d=d.split(".");(c=d.shift())&&(m=m[c]););d=m}if(!d&&n&&!("function"===typeof f.autoload&&(d=f.autoload.call(e,b,n)||H(b,e))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return d};f.ownEach=z=function(b,e,f){var c,d,m=w.length;if("[object Array]"===Q.call(b)){m=b.length;for(c=0;c<m&&!(d=b[c],e.call(b[c],f?d:c,f?c:d)===q);c++);}else{for(c in b)if(d=b[c],(f&&d!==Object.prototype[c]||
J.call(b,c))&&e.call(d,c,d)===q){m=q;break}if(m&&R)for(c=0;c<m&&!(d=b[w[c]],(J.call(b,w[c])||f&&d!=r&&d!==Object.prototype[w[c]])&&e.call(d,w[c],d)===q);c++);}};f.instanceOf=function(b,e){for(;b&&b.__class__!=r;){if(b.__class__===e)return y;b=b.parent}return q};f.absoluteURL=M=function(b){return function(e,f){f&&!/^(?:https?:)?\/[\/]?/.test(e)&&(e=("string"===typeof f?f:L)+e);var f=l.location,c,d=f.pathname,e=/^(?:[a-z]+\:)?\/\//.test(e)?e:f.protocol+"//"+f.host+(0===e.indexOf("/")?e:0===e.indexOf("?")?
d+e:0===e.indexOf("#")?d+f.search+e:d.replace(/[^\/]+$/g,"")+e);b.href=e;c=b.protocol;d=b.pathname;e=(":"===c?f.protocol:c)+"//";e="http:"===c&&80==b.port||"https:"===c&&443==b.port?e+b.hostname:e+b.host;return e+(0===d.indexOf("/")?d:"/"+d)+b.search+b.hash}}(o.createElement("A"));f.imports=function(){function b(a,b){if(f.imports.onerror)f.imports.onerror(a,b);else throw Error(404==a?"Module "+b+" not found":'Error executing module "'+b+'".');}function e(a,b,c,d){if(a in v)c(a);else{var e=a+(0<a.indexOf("?")?
"&":"?")+(new Date).getTime(),g="XMLHttpRequest"in l?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");g.open("GET",f.imports.disableCaching?e:a,b);g.onreadystatechange=function(){if(4===g.readyState){var b=1223===g.status?204:0===g.status&&"file:"==(self.location||{}).protocol?200:g.status;if(200<=b&&300>b||304===b){try{(l.execScript||function(a){l.eval.call(l,a)})(g.responseText+"\n////@ sourceURL="+a)}catch(e){return d(b,a)}c(a)}else d(b,a)}};g.send(r)}}function n(a){function d(){var a;
if(h){h.onload=h.onreadystatechange=h.onerror=r;h.parentNode.removeChild(h);for(a in h)try{h[a]=r,delete h[a]}catch(b){}h=r}}function g(d,e){a.b&&a.b.call(a.scope||f,d,e)?0===c[0].scripts.length&&c.shift():(a.b||b(d,e),c.shift());n()}function k(b){if(!m){m=y;for(v[b]=1;c.length&&0===c[0].scripts.length;)a=c.shift(),a.c&&a.c.call(a.scope||f);n()}}if(a){if(c.unshift(a),1<c.length)return}else if(0===c.length)return;var a=c[0],h,m=q,i=a.scripts.shift();a.d&&A&&9>A?e(i,y,k,g):i in v?k(i):(h=o.createElement("script"),
h.type="text/javascript",h.onerror=function(){d();g(404,i)},"onload"in h||!("readyState"in h)?h.onload=function(){d();k(i)}:h.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)d(),k(i)},h.src=i+(f.imports.disableCaching?(0<i.indexOf("?")?"&":"?")+(new Date).getTime():""),P.firstChild.appendChild(h))}var c=[],d=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),m=q;try{o.querySelectorAll("html:not(a)"),m=y}catch(g){}return function(a,
c,g,k){for(var a=("string"===typeof a?[a]:a)||[],h=0,l,i=y,u=!!c,s=a.length,w={},t=m?o.querySelectorAll('script[src]:not([data-calmjs="1"])'):B;l=t[h++];)if(l.setAttribute("data-calmjs","1"),l=l.getAttribute("src"))v[M(l,L)]=1;for(;s--;){if(!d.test(a[s]=M(a[s],L)))i=q;a[s]in v||a[s]in w?a.splice(s,1):w[a[s]]=1}if(0===a.length)return c&&c.call(k||f);if(i&&!u){for(;l=a.shift();){e(l,q,function(a){v[a]=1;i=q},function(a,c){g&&g.call(k||f,a,c)?i=q:g||b(a,c)});if(i)return;i=y}return c&&c.call(k||f)}n({scope:k||
f,d:i,scripts:a,c:c||r,b:g||r})}}();z(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(b,e){f[e].toString=f.toString=function(){return"[object Function]"}});I&&!("execVBscript"in l)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");l.Class=f})(window,!0,!1,null);
