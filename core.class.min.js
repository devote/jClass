/*
 * core.class.js Library for JavaScript v0.4.9.1
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 09-09-2012
 */
(function(q,t,o,s,E){function C(){}function k(){function b(){var f=0===+this,m=arguments,h=s,k=new a,j=k,e=f?m[0]:{a:k};if(B){B=D(B,n,b);var x=function(){};x.prototype=h=B.call(o,e);j=new x}w||(k.parent=h);if(B||f)u(k,function(a,d){if(typeof d==="function"&&!w){j[a]=function(){var a=e.a.parent,b=e.a.__class__;e.a.parent=k.parent;e.a.__class__=j.__class__;var c=d.apply(this===j||this==q?e.a:this,arguments);e.a.__class__=b;e.a.parent=a;return c};j[a].toString=function(){return d.toString()}}else j[a]=
d}),e.a=f?e.a:j;w||(j.__class__=j.__static__=b);for(h=0;h<y;h++)t[h]=D(t[h],n,b),u(t[h].call(o,e),function(a,d){j[a]===E&&(j[a]=d)},1);if(!f&&0!==i)if(F){if(A){if(c===o){c="StaticClass"+L+F++;var l=[],r=0,v=["Class "+c];u(j,function(a,d){var b=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:a==="toString"?4:d&&typeof d==="object"&&(d.set||d.get)?5:0;if(b){b!==4&&(i[a]=d);var c=b===4?"("+a+")":(r=1)&&b===1?a.substring(1):b===5?a:a.split(" ").pop();b!==3&&v.push("Public "+(b===
4?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(b===1?j.__get?'me.[__get].call(me,"'+c+'")':"":i[a]&&(b!==5||i[a].get)?(b===4?"me":"[(accessors)]")+".["+a+"]"+(b===5?".get":"")+".call(me)":"window.undefined")+",["+c+"])","End Property");b&1&&v.push("Public Property Let ["+c+"](val)",b=(b===1?j.__set?'Call me.[__set].call(me,"'+c+'",val)':"":i[a]&&(b!==5||i[a].set)?"Call [(accessors)].["+a+"]"+(b===5?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+c+"](val)",b)}if(!b||
b===4){if(l.length===50){v.push("Public ["+l.join("],[")+"]");l.length=0}l[l.length]=a}},1);r?(v.push("Public ["+l.join("],[")+"]","Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+c+"FactoryJS()","End Sub","End Class","Function "+c+"Factory()","Set "+c+"Factory=New "+c,"End Function"),q[c+"FactoryJS"]=function(){return d},execVBScript(v.join("\n"))):(i=0,c=s);l=v=s}c&&(d={},u(i,function(a){d[a]=j[a]}),e.a=q[c+"Factory"](),u(j,function(a,b){i.hasOwnProperty(a)||(e.a[a]=
b)},1),j=e.a)}}else if(u(g?j:i,function(a,b){var c=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(c){if(g){i[a]=b;d++}b=j[a];G.call(j,a)&&delete j[a];var f=c===1?a.substring(1):c===5?a:a.split(" ").pop(),e={enumerable:1,configurable:1,set:s,get:s};if(c!==3)e.get=function(){return((c===1?j.__get:c===5?b.get:b)||C).call(this,c===1?f:E)};if(c&1)e.set=function(a){((c===1?j.__set:c===5?b.set:b)||C).call(this,c===1?f:a,c===1?a:E)};if(H){var h=
Object.getOwnPropertyDescriptor(j,f);e.get=e.get||h&&h.get||C;e.set=e.set||h&&h.set||C;H(j,f,e)}else{c!==3&&j.__defineGetter__(f,e.get);c&1&&j.__defineSetter__(f,e.set)}}},g?1:0),g&&!(g=0)&&0===d)i=0;return new (f?function(){return j}:function(){j.constructor&&j.constructor!==Object.prototype.constructor&&j.constructor.apply(j,m);return j})}var g=1,i={},d=0,c=o,e=arguments,p=e.length-1,a=e[p--]||{},x={"extends":1,"implements":1},m="object"===typeof e[p]?e[p--]:{},l=m["static"]||(m.context||m["extends"]||
m["implements"]?{}:m),h="function"===typeof e[p]||"string"===typeof e[p-1]?e[p--]:"",f=(e[p--]||"").replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),n=e[p--]||m.context||k.defaultContext||k,v=!(f[0]in x)&&f.shift()||"",r=(p=f.shift())in x&&(x=f.shift())?x.split(","):[],e="extends"===p?(p=f.shift(),r.shift()):"",f="implements"===p?r.concat((x=f.shift())?x.split(","):[]):r,B=m["extends"]||h||e,f=m["implements"]||f,t=f instanceof Array?f:[f],y=t.length,w=m.disableStatement;
if("function"!==typeof a)var z=a,a=function(){return z};b.toString=function(){return"[class "+(v||"Object")+"]"};u(l,function(a,c){b[a]=c});if(b.className=v){m=n;l=(f=v.split(".")).shift();do 0===f.length?m[l]=b:(l in m||(m[l]={}),m=m[l]);while(l=f.shift())}return b}var y=q.document,M=y.documentElement,L=(new Date).getTime(),N=Object.prototype.toString,H=Object.defineProperty,G=Object.prototype.hasOwnProperty,I=y.getElementsByTagName("script"),J=(I[I.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),
A=+((q.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),F=(H||Object.prototype.__defineGetter__)&&(!A||8<A)?0:1,O=!{toString:1}.propertyIsEnumerable("toString"),u,D,K,w={},z="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");k.classByName=D=function(b,g,i){var d,c=b,e=g=g||k.defaultContext||k;if("string"===typeof c){for(c=c.split(".");(d=c.shift())&&(e=e[d]););c=e}if(!c&&i&&!("function"===typeof k.autoload&&(c=
k.autoload.call(g,b,i)||D(b,g))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return c};k.ownEach=u=function(b,g,i){var d,c,e=z.length;if("[object Array]"===N.call(b)){e=b.length;for(d=0;d<e&&!(c=b[d],g.call(b[d],i?c:d,i?d:c)===o);d++);}else{for(d in b)if(c=b[d],(i&&c!==Object.prototype[d]||G.call(b,d))&&g.call(c,d,c)===o){e=o;break}if(e&&O)for(d=0;d<e&&!(c=b[z[d]],(G.call(b,z[d])||i&&c!=s&&c!==Object.prototype[z[d]])&&g.call(c,z[d],c)===o);d++);}};k.instanceOf=function(b,g){for(;b&&
b.__class__!=s;){if(b.__class__===g)return t;b=b.parent}return o};k.absoluteURL=K=function(b){return function(g,i){i&&!/^(?:https?:)?\/[\/]?/.test(g)&&(g=("string"===typeof i?i:J)+g);var i=q.location,d,c=i.pathname,g=/^(?:[a-z]+\:)?\/\//.test(g)?g:i.protocol+"//"+i.host+(0===g.indexOf("/")?g:0===g.indexOf("?")?c+g:0===g.indexOf("#")?c+i.search+g:c.replace(/[^\/]+$/g,"")+g);b.href=g;d=b.protocol;c=b.pathname;g=(":"===d?i.protocol:d)+"//";g="http:"===d&&80==b.port||"https:"===d&&443==b.port?g+b.hostname:
g+b.host;return g+(0===c.indexOf("/")?c:"/"+c)+b.search+b.hash}}(y.createElement("A"));k.imports=function(){function b(a,b){if(k.imports.onerror)k.imports.onerror(a,b);else throw Error(404==a?"Module "+b+" not found":'Error executing module "'+b+'".');}function g(a,b,c,d){if(a in w)c(a);else{var e=a+(0<a.indexOf("?")?"&":"?")+(new Date).getTime(),f=new XMLHttpRequest;f.open("GET",k.imports.disableCaching?e:a,b);f.onreadystatechange=function(){if(4===f.readyState){var b=1223===f.status?204:0===f.status&&
"file:"==(self.location||{}).protocol?200:f.status;if(200<=b&&300>b||304===b){try{(q.execScript||function(a){q.eval.call(q,a)})(f.responseText+(!A?"\n//@ sourceURL="+a:""))}catch(e){return d(b,a)}c(a)}else d(b,a)}};f.send(s)}}function i(a){function c(){var a;if(h){h.onload=h.onreadystatechange=h.onerror=s;h.parentNode.removeChild(h);for(a in h)try{h[a]=s,delete h[a]}catch(b){}h=s}}function e(c,f){a.b&&a.b.call(a.scope||k,c,f)?0===d[0].scripts.length&&d.shift():(a.b||b(c,f),d.shift());i()}function l(b){if(!f){f=
t;for(w[b]=1;d.length&&0===d[0].scripts.length;)a=d.shift(),a.c&&a.c.call(a.scope||k);i()}}if(a){if(d.unshift(a),1<d.length)return}else if(0===d.length)return;var a=d[0],h,f=o,n=a.scripts.shift();a.d&&A&&9>A?g(n,t,l,e):n in w?l(n):(h=y.createElement("script"),h.type="text/javascript",h.onerror=function(){c();e(404,n)},"onload"in h||!("readyState"in h)?h.onload=function(){c();l(n)}:h.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)c(),l(n)},h.src=n+(k.imports.disableCaching?
(0<n.indexOf("?")?"&":"?")+(new Date).getTime():""),M.firstChild.appendChild(h))}var d=[],c=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),e=o;try{y.querySelectorAll("html:not(a)"),e=t}catch(p){}return function(a,d,m,l){for(var a=("string"===typeof a?[a]:a)||[],h=0,f,n=t,p=!!d,r=a.length,q={},u=e?y.querySelectorAll('script[src]:not([data-calmjs="1"])'):I;f=u[h++];)if(f.setAttribute("data-calmjs","1"),f=f.getAttribute("src"))w[K(f,J)]=1;for(;r--;){if(!c.test(a[r]=
K(a[r],J)))n=o;a[r]in w||a[r]in q?a.splice(r,1):q[a[r]]=1}if(0===a.length)return d&&d.call(l||k);if(n&&!p){for(;f=a.shift();){g(f,o,function(a){w[a]=1;n=o},function(a,c){m&&m.call(l||k,a,c)?n=o:m||b(a,c)});if(n)return;n=t}return d&&d.call(l||k)}i({scope:l||k,d:n,scripts:a,c:d||s,b:m||s})}}();u(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(b,g){k[g].toString=k.toString=function(){return"[object Function]"}});F&&!("execVBscript"in q)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript");q.Class=k})(window,!0,!1,null);
