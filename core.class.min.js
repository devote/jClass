/*
 * core.class.js Library for JavaScript v0.4.9
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 08-09-2012
 */
(function(r,u,n,s,D){function B(){}function d(){function b(){var f=0===+this,q=arguments,j=new a,h=j,d=f?q[0]:{a:j};j.parent=s;if(z){z=C(z,l,b);j.parent=z.call(n,d);var g=function(){};g.prototype=j.parent;h=new g}else h.shared={};if(z||f)v(j,function(a,e){"function"===typeof e?(h[a]=function(){var a=d.a.parent,b=d.a.__class__;d.a.parent=j.parent;d.a.__class__=h.__class__;var c=e.apply(this===h||this==r?d.a:this,arguments);d.a.__class__=b;d.a.parent=a;return c},h[a].toString=function(){return e.toString()}):
h[a]=e}),d.a=f?d.a:h;h.__class__=h.__static__=b;for(g=0;g<w;g++)u[g]=C(u[g],l,b),v(u[g].call(n,d),function(a,e){h[a]===D&&(h[a]=e)},1);if(!f&&0!==i)if(E){if(y){if(c===n){c="StaticClass"+L+E++;var k=[],o=0,m=["Class "+c];v(h,function(a,e){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:"toString"===a?4:e&&"object"===typeof e&&(e.set||e.get)?5:0;if(b){4!==b&&(i[a]=e);var c=4===b?"("+a+")":(o=1)&&1===b?a.substring(1):5===b?a:a.split(" ").pop();3!==b&&m.push("Public "+(4===
b?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(1===b?h.__get?'me.[__get].call(me,"'+c+'")':"":i[a]&&(5!==b||i[a].get)?(4===b?"me":"[(accessors)]")+".["+a+"]"+(5===b?".get":"")+".call(me)":"window.undefined")+",["+c+"])","End Property");b&1&&m.push("Public Property Let ["+c+"](val)",b=(1===b?h.__set?'Call me.[__set].call(me,"'+c+'",val)':"":i[a]&&(5!==b||i[a].set)?"Call [(accessors)].["+a+"]"+(5===b?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+c+"](val)",b)}if(!b||
4===b)50===k.length&&(m.push("Public ["+k.join("],[")+"]"),k.length=0),k[k.length]=a},1);o?(m.push("Public ["+k.join("],[")+"]","Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+c+"FactoryJS()","End Sub","End Class","Function "+c+"Factory()","Set "+c+"Factory=New "+c,"End Function"),r[c+"FactoryJS"]=function(){return e},execVBScript(m.join("\n"))):(i=0,c=s);k=m=s}c&&(e={},v(i,function(a){e[a]=h[a]}),d.a=r[c+"Factory"](),v(h,function(a,b){i.hasOwnProperty(a)||(d.a[a]=b)},
1),h=d.a)}}else if(v(t?h:i,function(a,b){var c=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:b&&"object"===typeof b&&(b.set||b.get)?5:0;if(c){t&&(i[a]=b,e++);b=h[a];F.call(h,a)&&delete h[a];var f=1===c?a.substring(1):5===c?a:a.split(" ").pop(),d={enumerable:1,configurable:1,set:s,get:s};3!==c&&(d.get=function(){return((c===1?h.__get:c===5?b.get:b)||B).call(this,c===1?f:D)});c&1&&(d.set=function(a){((c===1?h.__set:c===5?b.set:b)||B).call(this,c===1?f:a,c===1?a:D)});if(G){var g=
Object.getOwnPropertyDescriptor(h,f);d.get=d.get||g&&g.get||B;d.set=d.set||g&&g.set||B;G(h,f,d)}else 3!==c&&h.__defineGetter__(f,d.get),c&1&&h.__defineSetter__(f,d.set)}},t?1:0),t&&!(t=0)&&0===e)i=0;return new (f?function(){return h}:function(){h.constructor&&h.constructor!==Object.prototype.constructor&&h.constructor.apply(h,q);return h})}var t=1,i={},e=0,c=n,g=arguments,p=g.length-1,a=g[p--]||{},q={"extends":1,"implements":1},o="object"===typeof g[p]?g[p--]:{},k=o["static"]||(o.context||o["extends"]||
o["implements"]?{}:o),j="function"===typeof g[p]||"string"===typeof g[p-1]?g[p--]:"",f=(g[p--]||"").replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),l=g[p--]||o.context||d.defaultContext||d,H=!(f[0]in q)&&f.shift()||"",m=(p=f.shift())in q&&(q=f.shift())?q.split(","):[],g="extends"===p?(p=f.shift(),m.shift()):"",f="implements"===p?m.concat((q=f.shift())?q.split(","):[]):m,z=o["extends"]||j||g,f=o["implements"]||f,u=f instanceof Array?f:[f],w=u.length;if("function"!==typeof a)var x=
a,a=function(){return x};b.toString=function(){return"[class "+(H||"Object")+"]"};v(k,function(a,c){b[a]=c});if(b.className=H){k=l;q=(f=H.split(".")).shift();do 0===f.length?k[q]=b:(q in k||(k[q]={}),k=k[q]);while(q=f.shift())}return b}var w=r.document,M=w.documentElement,L=(new Date).getTime(),N=Object.prototype.toString,G=Object.defineProperty,F=Object.prototype.hasOwnProperty,I=w.getElementsByTagName("script"),J=(I[I.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),y=+((r.eval&&eval("/*@cc_on 1;@*/")&&
/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),E=(G||Object.prototype.__defineGetter__)&&(!y||8<y)?0:1,O=!{toString:1}.propertyIsEnumerable("toString"),v,C,K,x={},A="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");d.classByName=C=function(b,t,i){var e,c=b,g=t=t||d.defaultContext||d;if("string"===typeof c){for(c=c.split(".");(e=c.shift())&&(g=g[e]););c=g}if(!c&&i&&!("function"===typeof d.autoload&&(c=d.autoload.call(t,b,i)||C(b,t))))throw Error("Parent class '"+
b+"' not Initialized or Undefined");return c};d.ownEach=v=function(b,d,i){var e,c,g=A.length;if("[object Array]"===N.call(b)){g=b.length;for(e=0;e<g&&!(c=b[e],d.call(b[e],i?c:e,i?e:c)===n);e++);}else{for(e in b)if(c=b[e],(i&&c!==Object.prototype[e]||F.call(b,e))&&d.call(c,e,c)===n){g=n;break}if(g&&O)for(e=0;e<g&&!(c=b[A[e]],(F.call(b,A[e])||i&&c!=s&&c!==Object.prototype[A[e]])&&d.call(c,A[e],c)===n);e++);}};d.instanceOf=function(b,d){for(;b&&b.__class__!=s;){if(b.__class__===d)return u;b=b.parent}return n};
d.absoluteURL=K=function(b){return function(d,i){i&&!/^(?:https?:)?\/[\/]?/.test(d)&&(d=("string"===typeof i?i:J)+d);var i=r.location,e,c=i.pathname,d=/^(?:[a-z]+\:)?\/\//.test(d)?d:i.protocol+"//"+i.host+(0===d.indexOf("/")?d:0===d.indexOf("?")?c+d:0===d.indexOf("#")?c+i.search+d:c.replace(/[^\/]+$/g,"")+d);b.href=d;e=b.protocol;c=b.pathname;d=(":"===e?i.protocol:e)+"//";d="http:"===e&&80==b.port||"https:"===e&&443==b.port?d+b.hostname:d+b.host;return d+(0===c.indexOf("/")?c:"/"+c)+b.search+b.hash}}(w.createElement("A"));
d.imports=function(){function b(a,b){if(d.imports.onerror)d.imports.onerror(a,b);else throw Error(404==a?"Module "+b+" not found":'Error executing module "'+b+'".');}function t(a,b,c,e){if(a in x)c(a);else{var g=a+(0<a.indexOf("?")?"&":"?")+(new Date).getTime(),f=new XMLHttpRequest;f.open("GET",d.imports.disableCaching?g:a,b);f.onreadystatechange=function(){if(4===f.readyState){var b=1223===f.status?204:0===f.status&&"file:"==(self.location||{}).protocol?200:f.status;if(200<=b&&300>b||304===b){try{(r.execScript||
function(a){r.eval.call(r,a)})(f.responseText+(!y?"\n//@ sourceURL="+a:""))}catch(d){return e(b,a)}c(a)}else e(b,a)}};f.send(s)}}function i(a){function c(){var a;if(j){j.onload=j.onreadystatechange=j.onerror=s;j.parentNode.removeChild(j);for(a in j)try{j[a]=s,delete j[a]}catch(b){}j=s}}function g(c,f){a.b&&a.b.call(a.scope||d,c,f)?0===e[0].scripts.length&&e.shift():(a.b||b(c,f),e.shift());i()}function k(b){if(!f){f=u;for(x[b]=1;e.length&&0===e[0].scripts.length;)a=e.shift(),a.c&&a.c.call(a.scope||
d);i()}}if(a){if(e.unshift(a),1<e.length)return}else if(0===e.length)return;var a=e[0],j,f=n,l=a.scripts.shift();a.d&&y&&9>y?t(l,u,k,g):l in x?k(l):(j=w.createElement("script"),j.type="text/javascript",j.onerror=function(){c();g(404,l)},"onload"in j||!("readyState"in j)?j.onload=function(){c();k(l)}:j.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)c(),k(l)},j.src=l+(d.imports.disableCaching?(0<l.indexOf("?")?"&":"?")+(new Date).getTime():""),M.firstChild.appendChild(j))}
var e=[],c=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),g=n;try{w.querySelectorAll("html:not(a)"),g=u}catch(p){}return function(a,e,o,k){for(var a=("string"===typeof a?[a]:a)||[],j=0,f,l=u,p=!!e,m=a.length,r={},v=g?w.querySelectorAll('script[src]:not([data-calmjs="1"])'):I;f=v[j++];)if(f.setAttribute("data-calmjs","1"),f=f.getAttribute("src"))x[K(f,J)]=1;for(;m--;){if(!c.test(a[m]=K(a[m],J)))l=n;a[m]in x||a[m]in r?a.splice(m,1):r[a[m]]=1}if(0===a.length)return e&&
e.call(k||d);if(l&&!p){for(;f=a.shift();){t(f,n,function(a){x[a]=1;l=n},function(a,c){o&&o.call(k||d,a,c)?l=n:o||b(a,c)});if(l)return;l=u}return e&&e.call(k||d)}i({scope:k||d,d:l,scripts:a,c:e||s,b:o||s})}}();v(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(b,n){d[n].toString=d.toString=function(){return"[object Function]"}});E&&!("execVBscript"in r)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript");r.Class=d})(window,!0,!1,null);
