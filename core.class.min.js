/*
 * core.class.js Library for JavaScript v0.4.9.3
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 10-09-2012
 */
(function(q,u,p,r,C){function D(){}function k(){function b(){var f=0===+this,m=arguments,h=r,k=new a,i=k,e=f?m[0]:{a:k},t=!f||m[1]===C?y:m[1];if(z){z=E(z,n,b);var v=function(){};v.prototype=h=z.call(p,e,t);i=new v}t||(k.parent=h);if(z||f)s(k,function(a,d){if(typeof d==="function"&&!t){i[a]=function(){var a=e.a.parent,b=e.a.__class__;e.a.parent=k.parent;e.a.__class__=i.__class__;var c=d.apply(this===i||this==q?e.a:this,arguments);e.a.__class__=b;e.a.parent=a;return c};i[a].toString=function(){return d.toString()}}else i[a]=
d}),e.a=f?e.a:i;t||(i.__class__=i.__static__=b);for(h=0;h<x;h++)u[h]=E(u[h],n,b),s(u[h].call(p,e),function(a,d){i[a]===C&&(i[a]=d)},1);if(!f&&0!==j)if(F){if(A){if(c===p){c="StaticClass"+L+F++;var o=[],B=0,l=["Class "+c];s(i,function(a,d){var b=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:a==="toString"?4:d&&typeof d==="object"&&(d.set||d.get)?5:0;if(b){var c=b===4?a:(B=1)&&b===1?a.substring(1):b===5?a:a.split(" ").pop();j[a]=d;b!==3&&l.push("Public "+(b===4?"Default ":"")+
"Property Get ["+c+"]","Call VBCorrectVal("+(b===1?i.__get?'me.[__get].call(me,"'+c+'")':"":j[a]&&(b!==5||j[a].get)?"[(accessors)].["+a+"]"+(b===5?".get":"")+".call(me)":"window.undefined")+",["+c+"])","End Property");if(b&1||b===4)l.push("Public Property Let ["+c+"](val)",b=(b===1?i.__set?'Call me.[__set].call(me,"'+c+'",val)':"":b===4?"Set [(accessors)].["+a+"]=val":j[a]&&(b!==5||j[a].set)?"Call [(accessors)].["+a+"]"+(b===5?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+
c+"](val)",b)}if(!b){if(o.length===50){l.push("Public ["+o.join("],[")+"]");o.length=0}o[o.length]=a}},1);B?(l.push("Public ["+o.join("],[")+"]","Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+c+"FactoryJS()","End Sub","End Class","Function "+c+"Factory()","Set "+c+"Factory=New "+c,"End Function"),q[c+"FactoryJS"]=function(){return d},execVBScript(l.join("\n"))):(j=0,c=r);o=l=r}c&&(d={},s(j,function(a){d[a]=i[a]}),e.a=q[c+"Factory"](),s(i,function(a,b){if(!j.hasOwnProperty(a))if((!z||
t)&&typeof b==="function"){e.a[a]=function(){return b.apply(this===i||this==q?e.a:this,arguments)};e.a[a].toString=function(){return b.toString()}}else e.a[a]=b},1),i=e.a)}}else if(s(g?i:j,function(a,b){var c=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(c){if(g){j[a]=b;d++}b=i[a];G.call(i,a)&&delete i[a];var e=c===1?a.substring(1):c===5?a:a.split(" ").pop(),f={enumerable:1,configurable:1,set:r,get:r};if(c!==3)f.get=function(){return((c===
1?i.__get:c===5?b.get:b)||D).call(this,c===1?e:C)};if(c&1)f.set=function(a){((c===1?i.__set:c===5?b.set:b)||D).call(this,c===1?e:a,c===1?a:C)};if(H){var h=Object.getOwnPropertyDescriptor(i,e);f.get=f.get||h&&h.get||D;f.set=f.set||h&&h.set||D;H(i,e,f)}else{c!==3&&i.__defineGetter__(e,f.get);c&1&&i.__defineSetter__(e,f.set)}}},g?1:0),g&&!(g=0)&&0===d)j=0;return new (f?function(){return i}:function(){i.constructor&&i.constructor!==Object.prototype.constructor&&i.constructor.apply(i,m);return i})}var g=
1,j={},d=0,c=p,e=arguments,l=e.length-1,a=e[l--]||{},t={"extends":1,"implements":1},m="object"===typeof e[l]?e[l--]:{},v=m["static"]||(m.context||m["extends"]||m["implements"]||m.disableStatement?{}:m),h="function"===typeof e[l]||"string"===typeof e[l-1]?e[l--]:"",f=(e[l--]||"").replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),n=e[l--]||m.context||k.defaultContext||k,B=!(f[0]in t)&&f.shift()||"",o=(l=f.shift())in t&&(t=f.shift())?t.split(","):[],e="extends"===l?(l=f.shift(),
o.shift()):"",f="implements"===l?o.concat((t=f.shift())?t.split(","):[]):o,z=m["extends"]||h||e,f=m["implements"]||f,u=f instanceof Array?f:[f],x=u.length,y=m.disableStatement;if("function"!==typeof a)var w=a,a=function(){return w};b.toString=function(){return"[class "+(B||"Object")+"]"};s(v,function(a,c){b[a]=c});if(b.className=B){m=n;v=(f=B.split(".")).shift();do 0===f.length?m[v]=b:(v in m||(m[v]={}),m=m[v]);while(v=f.shift())}return b}var x=q.document,M=x.documentElement,L=(new Date).getTime(),
N=Object.prototype.toString,H=Object.defineProperty,G=Object.prototype.hasOwnProperty,I=x.getElementsByTagName("script"),J=(I[I.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),A=+((q.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),F=(H||Object.prototype.__defineGetter__)&&(!A||8<A)?0:1,O=!{toString:1}.propertyIsEnumerable("toString"),s,E,K,y={},w="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");k.classByName=
E=function(b,g,j){var d,c=b,e=g=g||k.defaultContext||k;if("string"===typeof c){for(c=c.split(".");(d=c.shift())&&(e=e[d]););c=e}if(!c&&j&&!("function"===typeof k.autoload&&(c=k.autoload.call(g,b,j)||E(b,g))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return c};k.ownEach=s=function(b,g,j){var d,c,e=w.length;if("[object Array]"===N.call(b)){e=b.length;for(d=0;d<e&&!(c=b[d],g.call(b[d],j?c:d,j?d:c)===p);d++);}else{for(d in b)if(c=b[d],(j&&c!==Object.prototype[d]||G.call(b,d))&&
g.call(c,d,c)===p){e=p;break}if(e&&O)for(d=0;d<e&&!(c=b[w[d]],(G.call(b,w[d])||j&&c!=r&&c!==Object.prototype[w[d]])&&g.call(c,w[d],c)===p);d++);}};k.instanceOf=function(b,g){for(;b&&b.__class__!=r;){if(b.__class__===g)return u;b=b.parent}return p};k.absoluteURL=K=function(b){return function(g,j){j&&!/^(?:https?:)?\/[\/]?/.test(g)&&(g=("string"===typeof j?j:J)+g);var j=q.location,d,c=j.pathname,g=/^(?:[a-z]+\:)?\/\//.test(g)?g:j.protocol+"//"+j.host+(0===g.indexOf("/")?g:0===g.indexOf("?")?c+g:0===
g.indexOf("#")?c+j.search+g:c.replace(/[^\/]+$/g,"")+g);b.href=g;d=b.protocol;c=b.pathname;g=(":"===d?j.protocol:d)+"//";g="http:"===d&&80==b.port||"https:"===d&&443==b.port?g+b.hostname:g+b.host;return g+(0===c.indexOf("/")?c:"/"+c)+b.search+b.hash}}(x.createElement("A"));k.imports=function(){function b(a,b){if(k.imports.onerror)k.imports.onerror(a,b);else throw Error(404==a?"Module "+b+" not found":'Error executing module "'+b+'".');}function g(a,b,c,d){if(a in y)c(a);else{var e=a+(0<a.indexOf("?")?
"&":"?")+(new Date).getTime(),f=new XMLHttpRequest;f.open("GET",k.imports.disableCaching?e:a,b);f.onreadystatechange=function(){if(4===f.readyState){var b=1223===f.status?204:0===f.status&&"file:"==(self.location||{}).protocol?200:f.status;if(200<=b&&300>b||304===b){try{(q.execScript||function(a){q.eval.call(q,a)})(f.responseText+(!A?"\n//@ sourceURL="+a:""))}catch(e){return d(b,a)}c(a)}else d(b,a)}};f.send(r)}}function j(a){function c(){var a;if(h){h.onload=h.onreadystatechange=h.onerror=r;h.parentNode.removeChild(h);
for(a in h)try{h[a]=r,delete h[a]}catch(b){}h=r}}function e(c,f){a.b&&a.b.call(a.scope||k,c,f)?0===d[0].scripts.length&&d.shift():(a.b||b(c,f),d.shift());j()}function l(b){if(!f){f=u;for(y[b]=1;d.length&&0===d[0].scripts.length;)a=d.shift(),a.c&&a.c.call(a.scope||k);j()}}if(a){if(d.unshift(a),1<d.length)return}else if(0===d.length)return;var a=d[0],h,f=p,n=a.scripts.shift();a.d&&A&&9>A?g(n,u,l,e):n in y?l(n):(h=x.createElement("script"),h.type="text/javascript",h.onerror=function(){c();e(404,n)},
"onload"in h||!("readyState"in h)?h.onload=function(){c();l(n)}:h.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)c(),l(n)},h.src=n+(k.imports.disableCaching?(0<n.indexOf("?")?"&":"?")+(new Date).getTime():""),M.firstChild.appendChild(h))}var d=[],c=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),e=p;try{x.querySelectorAll("html:not(a)"),e=u}catch(l){}return function(a,d,m,l){for(var a=("string"===typeof a?[a]:
a)||[],h=0,f,n=u,q=!!d,o=a.length,s={},w=e?x.querySelectorAll('script[src]:not([data-calmjs="1"])'):I;f=w[h++];)if(f.setAttribute("data-calmjs","1"),f=f.getAttribute("src"))y[K(f,J)]=1;for(;o--;){if(!c.test(a[o]=K(a[o],J)))n=p;a[o]in y||a[o]in s?a.splice(o,1):s[a[o]]=1}if(0===a.length)return d&&d.call(l||k);if(n&&!q){for(;f=a.shift();){g(f,p,function(a){y[a]=1;n=p},function(a,c){m&&m.call(l||k,a,c)?n=p:m||b(a,c)});if(n)return;n=u}return d&&d.call(l||k)}j({scope:l||k,d:n,scripts:a,c:d||r,b:m||r})}}();
s(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(b,g){k[g].toString=k.toString=function(){return"[object Function]"}});F&&!("execVBscript"in q)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");q.Class=k})(window,!0,!1,null);
