/*
 * core.class.min.js Library for JavaScript v0.5.3
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 29-01-2013
 */
(function(q,t,r,s,L){function D(b,e){return function(){throw Error("'"+b+"' property is "+(e?"read":"write")+"-only");}}function l(){function b(){for(var a=w,g=0===+this,k=arguments,m=s,l=new E,n=k[2]||s,i=n||l,f=g?k[0]:{a:l},p=!g||k[1]===L?B:k[1];a--;)"string"===typeof z[a]&&(z[a]=F(z[a],K,b)),h=function(){},h.prototype=m=z[a].call(r,f,p,n),0<a&&(delete h.prototype.__construct,delete h.prototype.constructor),i=n=new h;p||(l.parent=m);if(x||g)h=function(a,c,b){a[c]=function(){var a=f.a.parent,c=f.a.__class__;
f.a.parent=l.parent;f.a.__class__=i.__class__;var e=b.apply(this===i||this==q?f.a:this,arguments);f.a.__class__=c;f.a.parent=a;return e};a[c].toString=function(){return b.toString()}},u(l,function(a,c){"function"===typeof c&&!p?h(i,a,c):(!p&&c&&"object"===typeof c&&("set"in c&&"function"===typeof c.set&&h(c,"set",c.set),"get"in c&&"function"===typeof c.get&&h(c,"get",c.get)),i[a]=c)}),f.a=g?f.a:i;g&&t in i&&(i.constructor=i[t]);p||(i.__class__=b);if(!g&&0!==j)if(G){if(A){if(d===r){d="StaticClass"+
M+G++;var o=[],v=0,y=["Class "+d];u(i,function(a,c){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:"toString"===a?4:c&&"object"===typeof c&&(c.set||c.get)?5:0;if(b){var e=4===b?a:(v=1)&&1===b?a.substring(1):5===b?a:a.split(" ").pop();j[a]=c;3!==b&&y.push("Public "+(4===b?"Default ":"")+"Property Get ["+e+"]","Call VBCorrectVal("+(1===b?i.__get?'me.[__get].call(me,"'+e+'")':"":j[a]&&(5!==b||j[a].get)?"[(accessors)].["+a+"]"+(5===b?".get":"")+".call(me,[(accessors)].["+a+
"])":"window.undefined")+",["+e+"])","End Property");if(b&1||4===b)y.push("Public Property Let ["+e+"](val)",b=(1===b?i.__set?'Call me.[__set].call(me,"'+e+'",val)':"":4===b?"Set [(accessors)].["+a+"]=val":j[a]&&(5!==b||j[a].set)?"Call [(accessors)].["+a+"]"+(5===b?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+e+"](val)",b)}b||(50===o.length&&(y.push("Public ["+o.join("],[")+"]"),o.length=0),o[o.length]=a)},1);v?(y.push((o.length?"Public ["+o.join("],[")+
"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+d+"FactoryJS()","End Sub","End Class","Function "+d+"Factory()","Set "+d+"Factory=New "+d,"End Function"),q[d+"FactoryJS"]=function(){return c},execVBScript(y.join("\n"))):(j=0,d=s);o=y=s}d&&(c={},u(j,function(a){c[a]=i[a]}),f.a=q[d+"Factory"](),u(i,function(a,c){j.hasOwnProperty(a)||((!x||p)&&"function"===typeof c?(f.a[a]=function(){return c.apply(this===i||this==q?f.a:this,arguments)},f.a[a].toString=function(){return c.toString()}):
f.a[a]=c)},1),i=f.a)}}else if(u(e?i:j,function(a,b){var d=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:b&&"object"===typeof b&&(b.set||b.get)?5:0;if(d){e&&(j[a]=b,c++);b=i[a];H.call(i,a)&&delete i[a];var g=1===d?a.substring(1):5===d?a:a.split(" ").pop(),f={enumerable:1,configurable:1,set:s,get:s};3!==d&&(f.get=function(){return((d===1?i.__get:d===5?b.get:b)||D(g,0)).call(this,d===1?g:b)});d&1&&(f.set=function(a){((d===1?i.__set:d===5?b.set:b)||D(g,1)).call(this,d===1?g:a,d===
1?a:b)});if(I){var h=Object.getOwnPropertyDescriptor(i,g);f.get=f.get||h&&h.get||D(g,0);f.set=f.set||h&&h.set||D(g,1);I(i,g,f)}else 3!==d&&i.__defineGetter__(g,f.get),d&1&&i.__defineSetter__(g,f.set)}},e?1:0),e&&!(e=0)&&0===c)j=0;return new (g?function(){return i}:function(){t in i?i[t].apply(i,k):"__construct"in i?i.__construct.apply(i,k):i.constructor&&i.constructor!==Object.prototype.constructor&&i.constructor.apply(i,k);return i})}var e=1,j={},c=0,d=r,h=arguments,t,a=h.length-1,E=h[a--]||{},n=
{"extends":1,"implements":1},k="object"===typeof h[a]&&h[a]?h[a--]:{},m=k.statics||(k.context||k["extends"]||k["implements"]||k.disableStatement?{}:k),f="function"===typeof h[a]||"string"===typeof h[a-1]?h[a--]:"",g=((h[a--]||"")+("string"==typeof f?" extends "+f:"")).replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),K=h[a--]||k.context||l.defaultContext||q,p=!(g[0]in n)&&g.shift()||"",o=(a=g.shift())in n&&(n=g.shift())?n.split(","):[],v="extends"===a?(a=g.shift(),o.shift()):
"",g="implements"===a?o.concat((n=g.shift())?n.split(","):[]):o,x=k["extends"]||v||f,n=k["implements"]||g,z=n instanceof Array?(x&&n.unshift(x),n):x&&[x,n]||[n],w=z.length,B=k.disableStatement;if("function"!==typeof E)var C=E,E=function(){return C};b.toString=function(){return"[class "+(p||"Object")+"]"};u(m,function(a,c){b[a]=c});if(b.className=p){k=K;h=(g=p.split(".")).shift();do 0===g.length?k[t=h]=b:(h in k||(k[h]={}),k=k[h]);while(h=g.shift())}return b}var o=q.document,N=o.documentElement,M=
(new Date).getTime(),O=Object.prototype.toString,I=Object.defineProperty,H=Object.prototype.hasOwnProperty,B=o.getElementsByTagName("script"),C=(B[B.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),A=+((q.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),G=(I||Object.prototype.__defineGetter__)&&(!A||8<A)?0:1,P=!{toString:1}.propertyIsEnumerable("toString"),u,F,J,v={},w="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");
l.classByName=F=function(b,e,j){var c,d=b,h=e=e||l.defaultContext||l;if("string"===typeof d){for(d=d.split(".");(c=d.shift())&&(h=h[c]););d=h}if(!d&&j&&!("function"===typeof l.autoload&&(d=l.autoload.call(e,b,j)||F(b,e))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return d};l.ownEach=u=function(b,e,j){var c,d,h=w.length;if("[object Array]"===O.call(b)){h=b.length;for(c=0;c<h&&!(d=b[c],e.call(b[c],j?d:c,j?c:d)===r);c++);}else{for(c in b)if(d=b[c],(j&&d!==Object.prototype[c]||
H.call(b,c))&&e.call(d,c,d)===r){h=r;break}if(h&&P)for(c=0;c<h&&!(d=b[w[c]],(H.call(b,w[c])||j&&d!=s&&d!==Object.prototype[w[c]])&&e.call(d,w[c],d)===r);c++);}};l.instanceOf=function(b,e){for(;b&&b.__class__!=s;){if(b.__class__===e)return t;b=b.parent}return r};l.absoluteURL=J=function(b){return function(e,j){j&&!/^(?:https?:)?\/[\/]?/.test(e)&&(e=("string"===typeof j?j:C)+e);var j=q.location,c,d=j.pathname,e=/^(?:[a-z]+\:)?\/\//.test(e)?e:j.protocol+"//"+j.host+(0===e.indexOf("/")?e:0===e.indexOf("?")?
d+e:0===e.indexOf("#")?d+j.search+e:d.replace(/[^\/]+$/g,"")+e);b.href=e;c=b.protocol;d=b.pathname;e=(":"===c?j.protocol:c)+"//";e="http:"===c&&80==b.port||"https:"===c&&443==b.port?e+b.hostname:e+b.host;return e+(0===d.indexOf("/")?d:"/"+d)+b.search+b.hash}}(o.createElement("A"));l.imports=function(){function b(a,b){if(l.imports.onerror)l.imports.onerror(a,b);else throw Error(404==a?"Module "+b+" not found":'Error executing module "'+b+'".');}function e(a,b,c,d){if(a in v)c(a);else{var e=a+(0<a.indexOf("?")?
"&":"?")+(new Date).getTime(),f="XMLHttpRequest"in q?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");f.open("GET",l.imports.disableCaching?e:a,b);f.onreadystatechange=function(){if(4===f.readyState){var b=1223===f.status?204:0===f.status&&"file:"==(self.location||{}).protocol?200:f.status;if(200<=b&&300>b||304===b){try{(q.execScript||function(a){q.eval.call(q,a)})(f.responseText+"\n////@ sourceURL="+a)}catch(e){return d(b,a)}c(a)}else d(b,a)}};f.send(s)}}function j(a){function d(){var a;
if(m){m.onload=m.onreadystatechange=m.onerror=s;m.parentNode.removeChild(m);for(a in m)try{m[a]=s,delete m[a]}catch(b){}m=s}}function h(d,e){a.b&&a.b.call(a.scope||l,d,e)?0===c[0].scripts.length&&c.shift():(a.b||b(d,e),c.shift());j()}function k(b){if(!f){f=t;for(v[b]=1;c.length&&0===c[0].scripts.length;)a=c.shift(),a.c&&a.c.call(a.scope||l);j()}}if(a){if(c.unshift(a),1<c.length)return}else if(0===c.length)return;var a=c[0],m,f=r,g=a.scripts.shift();a.d&&A&&9>A?e(g,t,k,h):g in v?k(g):(m=o.createElement("script"),
m.type="text/javascript",m.onerror=function(){d();h(404,g)},"onload"in m||!("readyState"in m)?m.onload=function(){d();k(g)}:m.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)d(),k(g)},m.src=g+(l.imports.disableCaching?(0<g.indexOf("?")?"&":"?")+(new Date).getTime():""),N.firstChild.appendChild(m))}var c=[],d=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),h=r;try{o.querySelectorAll("html:not(a)"),h=t}catch(u){}return function(a,
c,n,k){for(var a=("string"===typeof a?[a]:a)||[],m=0,f,g=t,q=!!c,p=a.length,u={},w=h?o.querySelectorAll('script[src]:not([data-calmjs="1"])'):B;f=w[m++];)if(f.setAttribute("data-calmjs","1"),f=f.getAttribute("src"))v[J(f,C)]=1;for(;p--;){if(!d.test(a[p]=J(a[p],C)))g=r;a[p]in v||a[p]in u?a.splice(p,1):u[a[p]]=1}if(0===a.length)return c&&c.call(k||l);if(g&&!q){for(;f=a.shift();){e(f,r,function(a){v[a]=1;g=r},function(a,c){n&&n.call(k||l,a,c)?g=r:n||b(a,c)});if(g)return;g=t}return c&&c.call(k||l)}j({scope:k||
l,d:g,scripts:a,c:c||s,b:n||s})}}();u(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(b,e){l[e].toString=l.toString=function(){return"[object Function]"}});G&&!("execVBscript"in q)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");q.Class=l})(window,!0,!1,null);
