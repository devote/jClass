/*
 * core.class.min.js Library for JavaScript v0.5.0
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 19-01-2013
 */
(function(p,s,q,r,F){function C(c,e){return function(){throw Error("'"+c+"' property is "+(e?"read":"write")+"-only");}}function l(){function c(){var a=v,h=0===+this,k=arguments,E=r,l=new D,j=l,g=h?k[0]:{a:l},m=!h||k[1]===F?A:k[1];if(a){for(var o=function(){};a--;)"string"===typeof x[a]&&(x[a]=G(x[a],L,c)),a===v-1?o.prototype=E=x[a].call(q,g,m):(delete o.prototype.constructor,delete o.prototype.__construct,t(x[a].call(q,g,m),function(a,b){o.prototype[a]=b},1));j=new o}m||(l.parent=E);if(y||h)f=function(a,
b,c){a[b]=function(){var a=g.a.parent,b=g.a.__class__;g.a.parent=l.parent;g.a.__class__=j.__class__;var e=c.apply(this===j||this==p?g.a:this,arguments);g.a.__class__=b;g.a.parent=a;return e};a[b].toString=function(){return c.toString()}},t(l,function(a,b){"function"===typeof b&&!m?f(j,a,b):(!m&&b&&"object"===typeof b&&("set"in b&&"function"===typeof b.set&&f(b,"set",b.set),"get"in b&&"function"===typeof b.get&&f(b,"get",b.get)),j[a]=b)}),g.a=h?g.a:j;h&&s in j&&(j.constructor=j[s]);m||(j.__class__=
c);if(!h&&0!==i)if(H){if(w){if(d===q){d="StaticClass"+M+H++;var n=[],u=0,z=["Class "+d];t(j,function(a,b){var c=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:"toString"===a?4:b&&"object"===typeof b&&(b.set||b.get)?5:0;if(c){var e=4===c?a:(u=1)&&1===c?a.substring(1):5===c?a:a.split(" ").pop();i[a]=b;3!==c&&z.push("Public "+(4===c?"Default ":"")+"Property Get ["+e+"]","Call VBCorrectVal("+(1===c?j.__get?'me.[__get].call(me,"'+e+'")':"":i[a]&&(5!==c||i[a].get)?"[(accessors)].["+
a+"]"+(5===c?".get":"")+".call(me)":"window.undefined")+",["+e+"])","End Property");if(c&1||4===c)z.push("Public Property Let ["+e+"](val)",c=(1===c?j.__set?'Call me.[__set].call(me,"'+e+'",val)':"":4===c?"Set [(accessors)].["+a+"]=val":i[a]&&(5!==c||i[a].set)?"Call [(accessors)].["+a+"]"+(5===c?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+e+"](val)",c)}c||(50===n.length&&(z.push("Public ["+n.join("],[")+"]"),n.length=0),n[n.length]=a)},1);u?(z.push((n.length?"Public ["+
n.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+d+"FactoryJS()","End Sub","End Class","Function "+d+"Factory()","Set "+d+"Factory=New "+d,"End Function"),p[d+"FactoryJS"]=function(){return b},execVBScript(z.join("\n"))):(i=0,d=r);n=z=r}d&&(b={},t(i,function(a){b[a]=j[a]}),g.a=p[d+"Factory"](),t(j,function(a,b){i.hasOwnProperty(a)||((!y||m)&&"function"===typeof b?(g.a[a]=function(){return b.apply(this===j||this==p?g.a:this,arguments)},g.a[a].toString=
function(){return b.toString()}):g.a[a]=b)},1),j=g.a)}}else if(t(e?j:i,function(a,c){var d=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:c&&"object"===typeof c&&(c.set||c.get)?5:0;if(d){e&&(i[a]=c,b++);c=j[a];I.call(j,a)&&delete j[a];var h=1===d?a.substring(1):5===d?a:a.split(" ").pop(),g={enumerable:1,configurable:1,set:r,get:r};3!==d&&(g.get=function(){return((d===1?j.__get:d===5?c.get:c)||C(h,0)).call(this,d===1?h:F)});d&1&&(g.set=function(a){((d===1?j.__set:d===5?c.set:
c)||C(h,1)).call(this,d===1?h:a,d===1?a:F)});if(J){var k=Object.getOwnPropertyDescriptor(j,h);g.get=g.get||k&&k.get||C(h,0);g.set=g.set||k&&k.set||C(h,1);J(j,h,g)}else 3!==d&&j.__defineGetter__(h,g.get),d&1&&j.__defineSetter__(h,g.set)}},e?1:0),e&&!(e=0)&&0===b)i=0;return new (h?function(){return j}:function(){s in j?j[s].apply(j,k):"__construct"in j?j.__construct.apply(j,k):j.constructor&&j.constructor!==Object.prototype.constructor&&j.constructor.apply(j,k);return j})}var e=1,i={},b=0,d=q,f=arguments,
s,a=f.length-1,D=f[a--]||{},g={"extends":1,"implements":1},k="object"===typeof f[a]&&f[a]?f[a--]:{},E=k.statics||(k.context||k["extends"]||k["implements"]||k.disableStatement?{}:k),m="function"===typeof f[a]||"string"===typeof f[a-1]?f[a--]:"",h=((f[a--]||"")+("string"==typeof m?" extends "+m:"")).replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),L=f[a--]||k.context||l.defaultContext||p,o=!(h[0]in g)&&h.shift()||"",n=(a=h.shift())in g&&(g=h.shift())?g.split(","):[],u="extends"===
a?(a=h.shift(),n.shift()):"",h="implements"===a?n.concat((g=h.shift())?g.split(","):[]):n,y=k["extends"]||u||m,g=k["implements"]||h,x=g instanceof Array?(y&&g.unshift(y),g):y&&[y,g]||[g],v=x.length,A=k.disableStatement;if("function"!==typeof D)var B=D,D=function(){return B};c.toString=function(){return"[class "+(o||"Object")+"]"};t(E,function(a,b){c[a]=b});if(c.className=o){k=L;f=(h=o.split(".")).shift();do 0===h.length?k[s=f]=c:(f in k||(k[f]={}),k=k[f]);while(f=h.shift())}return c}var n=p.document,
N=n.documentElement,M=(new Date).getTime(),O=Object.prototype.toString,J=Object.defineProperty,I=Object.prototype.hasOwnProperty,A=n.getElementsByTagName("script"),B=(A[A.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),w=+((p.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),H=(J||Object.prototype.__defineGetter__)&&(!w||8<w)?0:1,P=!{toString:1}.propertyIsEnumerable("toString"),t,G,K,u={},v="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");
l.classByName=G=function(c,e,i){var b,d=c,f=e=e||l.defaultContext||l;if("string"===typeof d){for(d=d.split(".");(b=d.shift())&&(f=f[b]););d=f}if(!d&&i&&!("function"===typeof l.autoload&&(d=l.autoload.call(e,c,i)||G(c,e))))throw Error("Parent class '"+c+"' not Initialized or Undefined");return d};l.ownEach=t=function(c,e,i){var b,d,f=v.length;if("[object Array]"===O.call(c)){f=c.length;for(b=0;b<f&&!(d=c[b],e.call(c[b],i?d:b,i?b:d)===q);b++);}else{for(b in c)if(d=c[b],(i&&d!==Object.prototype[b]||
I.call(c,b))&&e.call(d,b,d)===q){f=q;break}if(f&&P)for(b=0;b<f&&!(d=c[v[b]],(I.call(c,v[b])||i&&d!=r&&d!==Object.prototype[v[b]])&&e.call(d,v[b],d)===q);b++);}};l.instanceOf=function(c,e){for(;c&&c.__class__!=r;){if(c.__class__===e)return s;c=c.parent}return q};l.absoluteURL=K=function(c){return function(e,i){i&&!/^(?:https?:)?\/[\/]?/.test(e)&&(e=("string"===typeof i?i:B)+e);var i=p.location,b,d=i.pathname,e=/^(?:[a-z]+\:)?\/\//.test(e)?e:i.protocol+"//"+i.host+(0===e.indexOf("/")?e:0===e.indexOf("?")?
d+e:0===e.indexOf("#")?d+i.search+e:d.replace(/[^\/]+$/g,"")+e);c.href=e;b=c.protocol;d=c.pathname;e=(":"===b?i.protocol:b)+"//";e="http:"===b&&80==c.port||"https:"===b&&443==c.port?e+c.hostname:e+c.host;return e+(0===d.indexOf("/")?d:"/"+d)+c.search+c.hash}}(n.createElement("A"));l.imports=function(){function c(a,b){if(l.imports.onerror)l.imports.onerror(a,b);else throw Error(404==a?"Module "+b+" not found":'Error executing module "'+b+'".');}function e(a,b,c,d){if(a in u)c(a);else{var e=a+(0<a.indexOf("?")?
"&":"?")+(new Date).getTime(),i="XMLHttpRequest"in p?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");i.open("GET",l.imports.disableCaching?e:a,b);i.onreadystatechange=function(){if(4===i.readyState){var b=1223===i.status?204:0===i.status&&"file:"==(self.location||{}).protocol?200:i.status;if(200<=b&&300>b||304===b){try{(p.execScript||function(a){p.eval.call(p,a)})(i.responseText+"\n////@ sourceURL="+a)}catch(e){return d(b,a)}c(a)}else d(b,a)}};i.send(r)}}function i(a){function d(){var a;
if(f){f.onload=f.onreadystatechange=f.onerror=r;f.parentNode.removeChild(f);for(a in f)try{f[a]=r,delete f[a]}catch(b){}f=r}}function g(d,e){a.b&&a.b.call(a.scope||l,d,e)?0===b[0].scripts.length&&b.shift():(a.b||c(d,e),b.shift());i()}function k(c){if(!m){m=s;for(u[c]=1;b.length&&0===b[0].scripts.length;)a=b.shift(),a.c&&a.c.call(a.scope||l);i()}}if(a){if(b.unshift(a),1<b.length)return}else if(0===b.length)return;var a=b[0],f,m=q,h=a.scripts.shift();a.d&&w&&9>w?e(h,s,k,g):h in u?k(h):(f=n.createElement("script"),
f.type="text/javascript",f.onerror=function(){d();g(404,h)},"onload"in f||!("readyState"in f)?f.onload=function(){d();k(h)}:f.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)d(),k(h)},f.src=h+(l.imports.disableCaching?(0<h.indexOf("?")?"&":"?")+(new Date).getTime():""),N.firstChild.appendChild(f))}var b=[],d=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),f=q;try{n.querySelectorAll("html:not(a)"),f=s}catch(t){}return function(a,
b,g,k){for(var a=("string"===typeof a?[a]:a)||[],p=0,m,h=s,t=!!b,o=a.length,v={},w=f?n.querySelectorAll('script[src]:not([data-calmjs="1"])'):A;m=w[p++];)if(m.setAttribute("data-calmjs","1"),m=m.getAttribute("src"))u[K(m,B)]=1;for(;o--;){if(!d.test(a[o]=K(a[o],B)))h=q;a[o]in u||a[o]in v?a.splice(o,1):v[a[o]]=1}if(0===a.length)return b&&b.call(k||l);if(h&&!t){for(;m=a.shift();){e(m,q,function(a){u[a]=1;h=q},function(a,b){g&&g.call(k||l,a,b)?h=q:g||c(a,b)});if(h)return;h=s}return b&&b.call(k||l)}i({scope:k||
l,d:h,scripts:a,c:b||r,b:g||r})}}();t(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(c,e){l[e].toString=l.toString=function(){return"[object Function]"}});H&&!("execVBscript"in p)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");p.Class=l})(window,!0,!1,null);
