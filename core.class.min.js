/*
 * core.class.js Library for JavaScript v0.3.1
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 04-06-2012
 */
(function(x,A,p,i,y){function g(a,d,c,b,f){function s(){var a=0===+this,b=arguments,d=new f,e=d,h=a?b[0]:{a:d};d.parent=i;if(c){d.parent=c.call(p,h);var k=function(){};k.prototype=d.parent;e=new k}else e.shared={};if(c||a)g.ownEach(d,function(a,b){"function"===typeof b?(e[a]=function(){var a=h.a.parent,c=h.a.Class;h.a.parent=d.parent;h.a.Class=e.Class;var f=b.apply(this===e||this==x?h.a:this,arguments);h.a.Class=c;h.a.parent=a;return f},e[a].toString=function(){return b.toString()}):e[a]=b}),h.a=
a?h.a:e;e.Class=s;if(!a&&0!==j)if(v){if(w){if(m===p){m="StaticClass"+B+v++;var q=[],o=0,r=["Class "+m];g.ownEach(e,function(a){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:"toString"===a?4:0;if(b){var c=4===b?"("+a+")":(o=1)&&1===b?a.substring(1):a.split(" ").pop();if(1===b||2===b||4===b)r.push("Public "+(4===b?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(1===b?e.c?'me.[__get].call(me,"'+c+'")':"":e[a]?"me.["+a+"].call(me)":"")+",["+c+"])","End Property");
if(1===b||3===b)r.push("Public Property Let ["+c+"](val)",1===b?e.b?'Call me.[__set].call(me,"'+c+'",val)':"":e[a]?"Call me.["+a+"].call(me,val)":"","End Property","Public Property Set ["+c+"](val)",1===b?e.b?'Call me.[__set].call(me,"'+c+'",val)':"":e[a]?"Call me.["+a+"].call(me,val)":"","End Property")}if(!b||1<b)50===q.length&&(r.push("Public ["+q.join("],[")+"]"),q.length=0),q[q.length]=a,j[j.length]=a},1);o?(r.push("Public ["+q.join("],[")+"]","End Class","Function "+m+"Factory()","Set "+m+"Factory=New "+
m,"End Function"),execVBScript(r.join("\n"))):(j=0,m=i);q=r=i}if(m){h.a=window[m+"Factory"]();for(k=j.length;n=j[--k];)h.a[n]=e[n];e=h.a}}}else if(g.ownEach(u?e:j,function(a){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:0;if(b){u&&(j[j.length]=a);var c=1===b?a.substring(1):a.split(" ").pop(),d={enumerable:1,configurable:1,set:i,get:i};if(1===b||2===b)d.get=function(){return(e[1===b?"__get":a]||l).call(this,1===b?c:y)};if(1===b||3===b)d.set=function(d){(e[1===b?"__set":
a]||l).call(this,1===b?c:d,1===b?d:y)};if(Object.defineProperty){var f=Object.getOwnPropertyDescriptor(e,c);d.get=d.get||f&&f.get||l;d.set=d.set||f&&f.set||l;Object.defineProperty(e,c,d)}else(1===b||2===b)&&e.__defineGetter__(c,d.get),(1===b||3===b)&&e.__defineSetter__(c,d.set)}},1),u&&!(u=0)&&0===j.length)j=0;return new (a?function(){return e}:function(){e.constructor&&e.constructor!==Object.prototype.constructor&&e.constructor.apply(e,b);return e})}function l(){}var n,k=[],o,u=1,j=[],m=p;if(3>arguments.length||
"string"===typeof a||"function"===typeof a&&"object"===typeof d)f=b,b=c,c=d,d=a,a=g;"string"===typeof d?(k=d.replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").split(" "),o=k[0]&&"extends"!==k[0]&&k.shift()||0):(f=b,b=c,c=d,d=i);f||((f=b)?"object"===typeof c?(b=c,c=null):b=i:(f=c,c=b=i));"string"===typeof c&&(n=c);if(f&&(n||"extends"===k.shift()||"function"===typeof d)){if((n||(n=k.shift()))&&!(d=a[n]))throw Error("Parent class '"+n+"' not Initialized or Undefined");c=d}if("function"!==typeof f)var t=f,f=function(){return t};
s.toString=function(){return"[class "+(o||"Object")+"]"};b&&g.ownEach(b,function(a){s[a]=b[a]});o&&(a[o]=s,a[o].className=o);return s}var w=eval("/*@cc_on (@_jscript_version+'').replace(/\\d\\./, '');@*/"),B=(new Date).getTime(),v=(Object.defineProperty||Object.prototype.__defineGetter__)&&(!w||8<w)?0:1,t={},z=Object.prototype.hasOwnProperty,C=Object.prototype.toString,D=!{toString:i}.propertyIsEnumerable("toString"),l="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(","),
E=function(){v&&!("execVBscript"in window)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");var a=document.getElementsByTagName("script");return(a[a.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,"")}();g.ownEach=function(a,d,c){var b,f,g=l.length;if("[object Array]"===C.call(a)){g=a.length;for(b=0;b<g&&!(f=a[b],d.call(a[b],c?f:b,c?b:f)===p);b++);}else{for(b in a)if(f=a[b],(c&&
f!==Object.prototype[b]||z.call(a,b))&&d.call(f,b,f)===p){g=p;break}if(g&&D)for(b=0;b<g&&!(f=a[l[b]],(z.call(a,l[b])||c&&f!=i&&f!==Object.prototype[l[b]])&&d.call(f,l[b],f)===p);b++);}};g.instanceOf=function(a,d){for(;a&&a.Class!=i;){if(a.Class===d)return A;a=a.parent}return p};g.include=function(a,d){a=/^(?:http\:)?\/[\/]?/i.test(a)?a:E+a;if(t[a])d&&d();else{var c=new XMLHttpRequest;c.open("GET",a,!!d);c.onreadystatechange=function(){if(4===c.readyState)if(200<=c.status&&300>c.status||304===c.status){t[a]=
1;try{(window.execScript||function(a){window.eval.call(window,a)})(c.responseText)}catch(b){throw delete t[a],Error('Error executing module "'+a+'". '+b);}d&&d()}else throw Error("Module "+a+" not found");};c.send(i)}};g.ownEach.toString=g.instanceOf.toString=g.include.toString=g.toString=function(){return"[object Function]"};x.Class=g})(window,!0,!1,null);
