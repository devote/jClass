/*
 * core.class.js Library for JavaScript v0.4.0
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 20-07-2012
 */
(function(r,t,p,o,D){function f(c,b,d,a,e){function s(){var a=0===+this,b=arguments,l=new e,g=l,j=a?b[0]:{a:l};l.parent=o;if(d){if("string"===typeof d&&!(d=q(c,g=d)||"function"===typeof f.autoload&&f.autoload.call(c,g)||q(c,g)))throw Error("Parent class '"+g+"' not Initialized or Undefined");l.parent=d.call(p,j);var z=function(){};z.prototype=l.parent;g=new z}else g.shared={};if(d||a)f.ownEach(l,function(a,b){"function"===typeof b?(g[a]=function(){var a=j.a.parent,i=j.a.Class;j.a.parent=l.parent;
j.a.Class=g.Class;var c=b.apply(this===g||this==r?j.a:this,arguments);j.a.Class=i;j.a.parent=a;return c},g[a].toString=function(){return b.toString()}):g[a]=b}),j.a=a?j.a:g;g.Class=s;if(!a&&0!==h)if(B){if(x){if(m===p){m="StaticClass"+F+B++;var w=[],t=0,y=["Class "+m];f.ownEach(g,function(a){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:"toString"===a?4:0;if(b){var i=4===b?"("+a+")":(t=1)&&1===b?a.substring(1):a.split(" ").pop();if(1===b||2===b||4===b)y.push("Public "+
(4===b?"Default ":"")+"Property Get ["+i+"]","Call VBCorrectVal("+(1===b?g.__get?'me.[__get].call(me,"'+i+'")':"":g[a]?"me.["+a+"].call(me)":"")+",["+i+"])","End Property");if(1===b||3===b)y.push("Public Property Let ["+i+"](val)",1===b?g.__set?'Call me.[__set].call(me,"'+i+'",val)':"":g[a]?"Call me.["+a+"].call(me,val)":"","End Property","Public Property Set ["+i+"](val)",1===b?g.__set?'Call me.[__set].call(me,"'+i+'",val)':"":g[a]?"Call me.["+a+"].call(me,val)":"","End Property")}if(!b||1<b)50===
w.length&&(y.push("Public ["+w.join("],[")+"]"),w.length=0),w[w.length]=a,h[h.length]=a},1);t?(y.push("Public ["+w.join("],[")+"]","End Class","Function "+m+"Factory()","Set "+m+"Factory=New "+m,"End Function"),execVBScript(y.join("\n"))):(h=0,m=o);w=y=o}if(m){j.a=r[m+"Factory"]();for(z=h.length;n=h[--z];)j.a[n]=g[n];g=j.a}}}else if(f.ownEach(k?g:h,function(a){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:0;if(b){k&&(h[h.length]=a);var c=1===b?a.substring(1):a.split(" ").pop(),
d={enumerable:1,configurable:1,set:o,get:o};if(1===b||2===b)d.get=function(){return(g[1===b?"__get":a]||i).call(this,1===b?c:D)};if(1===b||3===b)d.set=function(d){(g[1===b?"__set":a]||i).call(this,1===b?c:d,1===b?d:D)};if(Object.defineProperty){var e=Object.getOwnPropertyDescriptor(g,c);d.get=d.get||e&&e.get||i;d.set=d.set||e&&e.set||i;Object.defineProperty(g,c,d)}else(1===b||2===b)&&g.__defineGetter__(c,d.get),(1===b||3===b)&&g.__defineSetter__(c,d.set)}},1),k&&!(k=0)&&0===h.length)h=0;return new (a?
function(){return g}:function(){g.constructor&&g.constructor!==Object.prototype.constructor&&g.constructor.apply(g,b);return g})}function q(a,b){for(var i,b=b.split(".");(i=b.shift())&&(a=a[i]););return a}function i(){}var n,l=[],j,k=1,h=[],m=p;if(3>arguments.length||"string"===typeof c||"function"===typeof c&&"object"===typeof b)e=a,a=d,d=b,b=c,c=f;"string"===typeof b?(l=b.replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").split(" "),j=l[0]&&"extends"!==l[0]&&l.shift()||0):(e=a,a=d,d=b,b=o);e||((e=a)?"object"===
typeof d?(a=d,d=null):a=o:(e=d,d=a=o));"string"===typeof d&&(n=d);if(e&&(n||"extends"===l.shift()||"function"===typeof b))d=(n||(n=l.shift()))&&!(b=q(c,n))?n:b;if("function"!==typeof e)var z=e,e=function(){return z};s.toString=function(){return"[class "+(j||"Object")+"]"};a&&f.ownEach(a,function(b){s[b]=a[b]});if(j){n=c;s.className=j;b=(l=j.split(".")).shift();do 0===l.length?n[b]=s:(b in n||(n[b]={}),n=n[b]);while(b=l.shift())}return s}var q=r.document,G=q.documentElement,x=eval("/*@cc_on (@_jscript_version+'').replace(/\\d\\./, '');@*/"),
F=(new Date).getTime(),B=(Object.defineProperty||Object.prototype.__defineGetter__)&&(!x||8<x)?0:1,A={},E=Object.prototype.hasOwnProperty,H=Object.prototype.toString,I=!{toString:o}.propertyIsEnumerable("toString"),u="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(","),C=function(){B&&!("execVBscript"in r)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript");var c=q.getElementsByTagName("script");return(c[c.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,"")}();f.ownEach=function(c,b,d){var a,e,f=u.length;if("[object Array]"===H.call(c)){f=c.length;for(a=0;a<f&&!(e=c[a],b.call(c[a],d?e:a,d?a:e)===p);a++);}else{for(a in c)if(e=c[a],(d&&e!==Object.prototype[a]||E.call(c,a))&&b.call(e,a,e)===p){f=p;break}if(f&&I)for(a=0;a<f&&!(e=c[u[a]],(E.call(c,u[a])||d&&e!=o&&e!==Object.prototype[u[a]])&&b.call(e,u[a],e)===p);a++);}};f.instanceOf=function(c,
b){for(;c&&c.Class!=o;){if(c.Class===b)return t;c=c.parent}return p};f.absoluteURL=function(c){return function(b,d){d&&!/^(?:https?:)?\/[\/]?/.test(b)&&(b=("string"===typeof d?d:C)+b);var d=r.location,a,e=d.pathname,b=/^(?:[a-z]+\:)?\/\//.test(b)?b:d.protocol+"//"+d.host+(0===b.indexOf("/")?b:0===b.indexOf("?")?e+b:0===b.indexOf("#")?e+d.search+b:e.replace(/[^\/]+$/g,"")+b);c.href=b;a=c.protocol;e=c.pathname;b=(":"===a?d.protocol:a)+"//";b="http:"===a&&80==c.port||"https:"===a&&443==c.port?b+c.hostname:
b+c.host;return b+(0===e.indexOf("/")?e:"/"+e)+c.search+c.hash}}(q.createElement("A"));f.imports=function(){function c(b,a){if(f.imports.onerror)f.imports.onerror(b,a);else throw Error(404==b?"Module "+a+" not found":'Error executing module "'+a+'".');}function b(b,a,c,d){if(b in A)c(b);else{var e=b+(0<b.indexOf("?")?"&":"?")+(new Date).getTime(),h=new XMLHttpRequest;h.open("GET",f.imports.disableCaching?e:b,a);h.onreadystatechange=function(){if(4===h.readyState){var a=1223===h.status?204:0===h.status&&
"file:"==(self.location||{}).protocol?200:h.status;if(200<=a&&300>a||304===a){try{(r.execScript||function(b){r.eval.call(r,b)})(h.responseText+(!x?"\n//@ sourceURL="+b:""))}catch(e){return d(a,b)}c(b)}else d(a,b)}};h.send(o)}}function d(i){function e(){var b;if(k){k.onload=k.onreadystatechange=k.onerror=null;k.parentNode.removeChild(k);for(b in k)try{k[b]=o,delete k[b]}catch(a){}k=o}}function l(b,e){i.b&&i.b.call(i.scope||f,b,e)?0===a[0].scripts.length&&a.shift():(i.b||c(b,e),a.shift());d()}function j(b){if(!h){h=
t;for(A[b]=1;a.length&&0===a[0].scripts.length;)i=a.shift(),i.c&&i.c.call(i.scope||f);d()}}if(i){if(a.unshift(i),1<a.length)return}else if(0===a.length)return;var i=a[0],k,h=p,m=i.scripts.shift();i.d?b(m,t,j,l):(k=q.createElement("script"),k.type="text/javascript",k.onerror=function(){e();l(404,m)},"onload"in k||!("readyState"in k)?k.onload=function(){e();j(m)}:k.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)e(),j(m)},k.src=m+(f.imports.disableCaching?(0<
m.indexOf("?")?"&":"?")+(new Date).getTime():""),(G.firstChild||q.getElementsByTagName("head")[0]).appendChild(k))}var a=[],e=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),s;a:{try{q.querySelectorAll("html:not(a)");s=t;break a}catch(u){}s=p}return function(a,n,l,j){for(var a="string"===typeof a?[a]:a,k=0,h,m=t,r=!!n,v=a.length,u={},x=s?q.querySelectorAll('script[src]:not([data-calmjs="1"])'):q.getElementsByTagName("script");h=x[k++];)if(h.setAttribute("data-calmjs",
"1"),h=h.getAttribute("src"))A[f.absoluteURL(h,C)]=1;for(;v--;){if(!e.test(a[v]=f.absoluteURL(a[v],C)))m=p;a[v]in A||a[v]in u?a.splice(v,1):u[a[v]]=1}if(0===a.length)return n&&n.call(j||f);if(m&&!r){for(;h=a.shift();){b(h,p,function(a){A[a]=1;m=p},function(a,b){l&&l.call(j||f,a,b)?m=p:l||c(a,b)});if(m)return;m=t}return n&&n.call(j||f)}d({scope:j||f,d:m,scripts:a,c:n||o,b:l||o})}}();f.ownEach.toString=f.instanceOf.toString=f.absoluteURL.toString=f.imports.toString=f.toString=function(){return"[object Function]"};
r.Class=f})(window,!0,!1,null);
