/*
 * core.class.min.js Library for JavaScript v0.5.6
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 03-02-2013
 */
(function(l,y,q,r,G){function D(b,e){return function(){throw Error("'"+b+"' property is "+(e?"read":"write")+"-only");}}function z(){}function g(){function b(){for(var a=w,i=0===+this,h=arguments,k=r,g=new E,s=h[2]||r,j=s||g,o=i?h[0]:{a:g},u=!i||h[1]===G||H!==G?H:h[1];a--;)"string"===typeof v[a]&&(v[a]=I(v[a],O,b)),z.prototype=k=v[a].call(q,o,u,s),0<a&&!u&&(k.constructor=function(){}),j=s=new z;u||(g.parent=k);if(w||i)f=function(a,c,b){a[c]=function(){var a=o.a.parent,c=o.a.__class__;o.a.parent=g.parent;
o.a.__class__=j.__class__;var e=b.apply(this===j||this==l?o.a:this,arguments);o.a.__class__=c;o.a.parent=a;return e};a[c].toString=function(){return b.toString()}},A(g,function(a,c){"function"===typeof c&&!u?f(j,a,c):(!u&&c&&"object"===typeof c&&("set"in c&&"function"===typeof c.set&&f(c,"set",c.set),"get"in c&&"function"===typeof c.get&&f(c,"get",c.get)),j[a]=c)}),o.a=i?o.a:j;u||(i&&m in j&&(j.constructor=j[m]),j.__class__=b);if(!i&&0!==p)if(J){if(C){if(d===q){d="StaticClass"+P+J++;var x=[],t=0,
n=["Class "+d];A(j,function(a,c){var b=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:a==="toString"?4:c&&typeof c==="object"&&(c.set||c.get)?5:0;if(b){var e=b===4?a:(t=1)&&b===1?a.substring(1):b===5?a:a.split(" ").pop();p[a]=b;b!==3&&n.push("Public "+(b===4?"Default ":"")+"Property Get ["+e+"]","Call VBCorrectVal("+(b===1?j.__get?'me.[__get].call(me,"'+e+'")':"":c&&(b!==5||c.get)?"[(accessors)].["+a+"]"+(b===5?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+
",["+e+"])","End Property");b!==2&&n.push("Public Property Let ["+e+"](val)",b=(b===1?j.__set?'Call me.[__set].call(me,"'+e+'",val)':"":b===4?"Set [(accessors)].["+a+"]=val":c&&(b!==5||c.set)?"Call [(accessors)].["+a+"]"+(b===5?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+e+"](val)",b)}if(!b){if(x.length===50){n.push("Public ["+x.join("],[")+"]");x.length=0}x[x.length]=a}},1);t?(n.push((x.length?"Public ["+x.join("],[")+"]\n":"")+"Private [(accessors)]",
"Private Sub Class_Initialize()","Set [(accessors)]="+d+"FactoryJS()","End Sub","End Class","Function "+d+"Factory()","Set "+d+"Factory=New "+d,"End Function"),l[d+"FactoryJS"]=function(){return c},execVBScript(n.join("\n"))):(p=0,d=r);x=n=r}d&&(c={},o.a=l[d+"Factory"](),A(j,function(a,b){if(p.hasOwnProperty(a))if(p[a]===5){z.prototype=j[a];c[a]=new z}else c[a]=j[a];else if((!w||u)&&typeof b==="function"){o.a[a]=function(){return b.apply(this===j||this==l?o.a:this,arguments)};o.a[a].toString=function(){return b.toString()}}else o.a[a]=
b},1),j=o.a)}}else if(A(e?j:p,function(a,b){var d=!e?b:a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(d){if(e){p[a]=d;c++}b=j[a];if(d===5){z.prototype=b;b=new z}K.call(j,a)&&delete j[a];var i=d===1?a.substring(1):d===5?a:a.split(" ").pop(),h={enumerable:1,configurable:1,set:r,get:r};if(d!==3)h.get=function(){return((d===1?j.__get:d===5?b.get:b)||D(i,0)).call(this,d===1?i:b)};if(d!==2)h.set=function(a){((d===1?j.__set:d===5?b.set:
b)||D(i,1)).call(this,d===1?i:a,d===1?a:b)};if(L){var k=Object.getOwnPropertyDescriptor(j,i);h.get=h.get||k&&k.get||D(i,0);h.set=h.set||k&&k.set||D(i,1);L(j,i,h)}else{d!==3&&j.__defineGetter__(i,h.get);d!==2&&j.__defineSetter__(i,h.set)}}},e?1:0),e&&!(e=0)&&0===c)p=0;return new (i?function(){return j}:function(){m in j?j[m].apply(j,h):j.constructor&&j.constructor!==Object.prototype.constructor&&j.constructor.apply(j,h);return j})}var e=1,p={},c=0,d=q,m,f=arguments,a=f.length-1,E=f[a--]||{},x=this instanceof
g,k=!f[a]||f[a]instanceof F||"object"!==typeof f[a]?{}:f[a--],h=k["extends"],H=k.compact,i=k["implements"],u=k.context,s=k.statics||(u||h||i||H!==G?{}:k),y="function"===typeof f[a]?[f[a--]]:f[a]instanceof F?f[a--]:"string"===typeof f[a-1]&&(""+f[a--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[],t="string"===typeof f[a]&&f[a--].split(/extends|implements|,/g)||[],O=f[a--]||u||g.defaultContext||l,n=(t.shift()||"").replace(/^\s+|\s+$/g,
""),a=h instanceof F?h:h?[h]:[],i=i instanceof F?i:i?[i]:[],t=(k=t.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?k.split(","):[],v=t.concat.apply(t,y.concat.apply(y,a.concat.apply(a,i))),w=v.length;if("function"!==typeof E)var B=E,E=function(){z.prototype=B.constructor.prototype;f=new z;A(B,function(a,b){f[a]=b});return f};b.toString=function(){return"[class "+(n||"Object")+"]"};A(s,function(a,c){b[a]=c});if(b.className=n){k=O;f=(t=n.split(".")).shift();do 0===t.length?k[m=f]=
b:(f in k||(k[f]={}),k=k[f]);while(f=t.shift())}return x?new b:b}var F=l.Array,n=l.document,Q=n.documentElement,P=(new Date).getTime(),R=Object.prototype.toString,L=Object.defineProperty,K=Object.prototype.hasOwnProperty,B=n.getElementsByTagName("script"),M=(B[B.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),C=+((l.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),J=(L||Object.prototype.__defineGetter__)&&(!C||8<C)?0:1,S=!{toString:1}.propertyIsEnumerable("toString"),
A,I,N,v={},w="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");g.classByName=I=function(b,e,p){var c,d=b,m=e=e||g.defaultContext||g;if("string"===typeof d){for(d=d.split(".");(c=d.shift())&&(m=m[c]););d=m}if(!d&&p&&!("function"===typeof g.autoload&&(d=g.autoload.call(e,b,p)||I(b,e))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return d};g.ownEach=A=function(b,e,g){var c,d,m=w.length;if("[object Array]"===R.call(b)){m=b.length;
for(c=0;c<m&&!(d=b[c],e.call(b[c],g?d:c,g?c:d)===q);c++);}else{for(c in b)if(d=b[c],(g&&d!==Object.prototype[c]||K.call(b,c))&&e.call(d,c,d)===q){m=q;break}if(m&&S)for(c=0;c<m&&!(d=b[w[c]],(K.call(b,w[c])||g&&d!=r&&d!==Object.prototype[w[c]])&&e.call(d,w[c],d)===q);c++);}};g.instanceOf=function(b,e){for(;b&&b.__class__!=r;){if(b.__class__===e)return y;b=b.parent}return q};g.absoluteURL=N=function(b){return function(e,g){g&&!/^(?:https?:)?\/[\/]?/.test(e)&&(e=("string"===typeof g?g:M)+e);var g=l.location,
c,d=g.pathname,e=/^(?:[a-z]+\:)?\/\//.test(e)?e:g.protocol+"//"+g.host+(0===e.indexOf("/")?e:0===e.indexOf("?")?d+e:0===e.indexOf("#")?d+g.search+e:d.replace(/[^\/]+$/g,"")+e);b.href=e;c=b.protocol;d=b.pathname;e=(":"===c?g.protocol:c)+"//";e="http:"===c&&80==b.port||"https:"===c&&443==b.port?e+b.hostname:e+b.host;return e+(0===d.indexOf("/")?d:"/"+d)+b.search+b.hash}}(n.createElement("A"));g.imports=function(){function b(a,b){if(g.imports.onerror)g.imports.onerror(a,b);else throw Error(404==a?"Module "+
b+" not found":'Error executing module "'+b+'".');}function e(a,b,c,d){if(a in v)c(a);else{var e=a+(0<a.indexOf("?")?"&":"?")+(new Date).getTime(),f="XMLHttpRequest"in l?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");f.open("GET",g.imports.disableCaching?e:a,b);f.onreadystatechange=function(){if(4===f.readyState){var b=1223===f.status?204:0===f.status&&"file:"==(self.location||{}).protocol?200:f.status;if(200<=b&&300>b||304===b){try{(l.execScript||function(a){l.eval.call(l,a)})(f.responseText+
"\n////@ sourceURL="+a)}catch(e){return d(b,a)}c(a)}else d(b,a)}};f.send(r)}}function p(a){function d(){var a;if(h){h.onload=h.onreadystatechange=h.onerror=r;h.parentNode.removeChild(h);for(a in h)try{h[a]=r,delete h[a]}catch(b){}h=r}}function f(d,e){a.b&&a.b.call(a.scope||g,d,e)?0===c[0].scripts.length&&c.shift():(a.b||b(d,e),c.shift());p()}function k(b){if(!m){m=y;for(v[b]=1;c.length&&0===c[0].scripts.length;)a=c.shift(),a.c&&a.c.call(a.scope||g);p()}}if(a){if(c.unshift(a),1<c.length)return}else if(0===
c.length)return;var a=c[0],h,m=q,i=a.scripts.shift();a.d&&C&&9>C?e(i,y,k,f):i in v?k(i):(h=n.createElement("script"),h.type="text/javascript",h.onerror=function(){d();f(404,i)},"onload"in h||!("readyState"in h)?h.onload=function(){d();k(i)}:h.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)d(),k(i)},h.src=i+(g.imports.disableCaching?(0<i.indexOf("?")?"&":"?")+(new Date).getTime():""),Q.firstChild.appendChild(h))}var c=[],d=RegExp("^((?:"+location.protocol+")?//"+
location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),m=q;try{n.querySelectorAll("html:not(a)"),m=y}catch(f){}return function(a,c,f,k){for(var a=("string"===typeof a?[a]:a)||[],h=0,l,i=y,u=!!c,s=a.length,w={},t=m?n.querySelectorAll('script[src]:not([data-calmjs="1"])'):B;l=t[h++];)if(l.setAttribute("data-calmjs","1"),l=l.getAttribute("src"))v[N(l,M)]=1;for(;s--;){if(!d.test(a[s]=N(a[s],M)))i=q;a[s]in v||a[s]in w?a.splice(s,1):w[a[s]]=1}if(0===a.length)return c&&c.call(k||g);if(i&&!u){for(;l=a.shift();){e(l,
q,function(a){v[a]=1;i=q},function(a,c){f&&f.call(k||g,a,c)?i=q:f||b(a,c)});if(i)return;i=y}return c&&c.call(k||g)}p({scope:k||g,d:i,scripts:a,c:c||r,b:f||r})}}();A(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(b,e){g[e].toString=g.toString=function(){return"[object Function]"}});J&&!("execVBscript"in l)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");
l.Class=g})(window,!0,!1,null);
