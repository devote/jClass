/*
 * core.class.js Library for JavaScript v0.4.2
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 23-07-2012
 */
(function(s,t,p,o,D){function f(d,b,c,a,e){function u(){var a=0===+this,b=arguments,m=new e,g=m,j=a?b[0]:{a:m};m.parent=o;if(c){if("string"===typeof c&&!(c=r(d,g=c)||"function"===typeof f.autoload&&f.autoload.call(d,g)||r(d,g)))throw Error("Parent class '"+g+"' not Initialized or Undefined");m.parent=c.call(p,j);var z=function(){};z.prototype=m.parent;g=new z}else g.shared={};if(c||a)f.ownEach(m,function(a,b){"function"===typeof b?(g[a]=function(){var a=j.a.parent,i=j.a.Class;j.a.parent=m.parent;
j.a.Class=g.Class;var d=b.apply(this===g||this==s?j.a:this,arguments);j.a.Class=i;j.a.parent=a;return d},g[a].toString=function(){return b.toString()}):g[a]=b}),j.a=a?j.a:g;g.Class=u;if(!a&&0!==h)if(A){if(v){if(k===p){k="StaticClass"+G+A++;var y=[],t=0,q=["Class "+k];f.ownEach(g,function(a){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:"toString"===a?4:0;if(b){var i=4===b?"("+a+")":(t=1)&&1===b?a.substring(1):a.split(" ").pop();if(1===b||2===b||4===b)q.push("Public "+
(4===b?"Default ":"")+"Property Get ["+i+"]","Call VBCorrectVal("+(1===b?g.__get?'me.[__get].call(me,"'+i+'")':"":g[a]?"me.["+a+"].call(me)":"")+",["+i+"])","End Property");if(1===b||3===b)q.push("Public Property Let ["+i+"](val)",1===b?g.__set?'Call me.[__set].call(me,"'+i+'",val)':"":g[a]?"Call me.["+a+"].call(me,val)":"","End Property","Public Property Set ["+i+"](val)",1===b?g.__set?'Call me.[__set].call(me,"'+i+'",val)':"":g[a]?"Call me.["+a+"].call(me,val)":"","End Property")}50===y.length&&
(q.push("Public ["+y.join("],[")+"]"),y.length=0);y[y.length]=a;h[h.length]=a},1);t?(q.push("Public ["+y.join("],[")+"]","End Class","Function "+k+"Factory()","Set "+k+"Factory=New "+k,"End Function"),execVBScript(q.join("\n"))):(h=0,k=o);y=q=o}if(k){j.a=s[k+"Factory"]();for(z=h.length;n=h[--z];)j.a[n]=g[n];g=j.a}}}else if(f.ownEach(l?g:h,function(a){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:0;if(b){l&&(h[h.length]=a);var d=1===b?a.substring(1):a.split(" ").pop(),
c={enumerable:1,configurable:1,set:o,get:o};if(1===b||2===b)c.get=function(){return(g[1===b?"__get":a]||i).call(this,1===b?d:D)};if(1===b||3===b)c.set=function(c){(g[1===b?"__set":a]||i).call(this,1===b?d:c,1===b?c:D)};if(B){var e=Object.getOwnPropertyDescriptor(g,d);c.get=c.get||e&&e.get||i;c.set=c.set||e&&e.set||i;B(g,d,c)}else(1===b||2===b)&&g.__defineGetter__(d,c.get),(1===b||3===b)&&g.__defineSetter__(d,c.set)}},1),l&&!(l=0)&&0===h.length)h=0;return new (a?function(){return g}:function(){g.constructor&&
g.constructor!==Object.prototype.constructor&&g.constructor.apply(g,b);return g})}function r(a,b){for(var i,b=b.split(".");(i=b.shift())&&(a=a[i]););return a}function i(){}var n,m=[],j="",l=1,h=[],k=p;if(3>arguments.length||"string"===typeof d||"function"===typeof d&&"object"===typeof b)e=a,a=c,c=b,b=d,d=f;"string"===typeof b?(m=b.replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").split(" "),j=m[0]&&"extends"!==m[0]&&m.shift()||""):(e=a,a=c,c=b,b=o);e||((e=a)?"object"===typeof c?(a=c,c=o):a=o:(e=c,c=a=o));"string"===
typeof c&&(n=c);if(e&&(n||"extends"===m.shift()||"function"===typeof b))c=(n||(n=m.shift()))&&!(b=r(d,n))?n:b;if("function"!==typeof e)var z=e,e=function(){return z};u.toString=function(){return"[class "+(j||"Object")+"]"};a&&f.ownEach(a,function(b){u[b]=a[b]});if(u.className=j){n=d;b=(m=j.split(".")).shift();do 0===m.length?n[b]=u:(b in n||(n[b]={}),n=n[b]);while(b=m.shift())}return u}var r=s.document,H=r.documentElement,G=(new Date).getTime(),I=Object.prototype.toString,B=Object.defineProperty,
E=Object.prototype.hasOwnProperty,F=r.getElementsByTagName("script"),C=(F[F.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),v=eval("/*@cc_on (@_jscript_version+'').replace(/\\d\\./, '');@*/"),A=(B||Object.prototype.__defineGetter__)&&(!v||8<v)?0:1,J=!{toString:o}.propertyIsEnumerable("toString"),q={},w="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");f.ownEach=function(d,b,c){var a,e,f=w.length;if("[object Array]"===I.call(d)){f=d.length;
for(a=0;a<f&&!(e=d[a],b.call(d[a],c?e:a,c?a:e)===p);a++);}else{for(a in d)if(e=d[a],(c&&e!==Object.prototype[a]||E.call(d,a))&&b.call(e,a,e)===p){f=p;break}if(f&&J)for(a=0;a<f&&!(e=d[w[a]],(E.call(d,w[a])||c&&e!=o&&e!==Object.prototype[w[a]])&&b.call(e,w[a],e)===p);a++);}};f.instanceOf=function(d,b){for(;d&&d.Class!=o;){if(d.Class===b)return t;d=d.parent}return p};f.absoluteURL=function(d){return function(b,c){c&&!/^(?:https?:)?\/[\/]?/.test(b)&&(b=("string"===typeof c?c:C)+b);var c=s.location,a,
e=c.pathname,b=/^(?:[a-z]+\:)?\/\//.test(b)?b:c.protocol+"//"+c.host+(0===b.indexOf("/")?b:0===b.indexOf("?")?e+b:0===b.indexOf("#")?e+c.search+b:e.replace(/[^\/]+$/g,"")+b);d.href=b;a=d.protocol;e=d.pathname;b=(":"===a?c.protocol:a)+"//";b="http:"===a&&80==d.port||"https:"===a&&443==d.port?b+d.hostname:b+d.host;return b+(0===e.indexOf("/")?e:"/"+e)+d.search+d.hash}}(r.createElement("A"));f.imports=function(){function d(b,a){if(f.imports.onerror)f.imports.onerror(b,a);else throw Error(404==b?"Module "+
a+" not found":'Error executing module "'+a+'".');}function b(a,b,c,d){if(a in q)c(a);else{var e=a+(0<a.indexOf("?")?"&":"?")+(new Date).getTime(),h=new XMLHttpRequest;h.open("GET",f.imports.disableCaching?e:a,b);h.onreadystatechange=function(){if(4===h.readyState){var b=1223===h.status?204:0===h.status&&"file:"==(self.location||{}).protocol?200:h.status;if(200<=b&&300>b||304===b){try{(s.execScript||function(a){s.eval.call(s,a)})(h.responseText+(!v?"\n//@ sourceURL="+a:""))}catch(e){return d(b,a)}c(a)}else d(b,
a)}};h.send(o)}}function c(i){function e(){var a;if(l){l.onload=l.onreadystatechange=l.onerror=o;l.parentNode.removeChild(l);for(a in l)try{l[a]=o,delete l[a]}catch(b){}l=o}}function m(b,e){i.b&&i.b.call(i.scope||f,b,e)?0===a[0].scripts.length&&a.shift():(i.b||d(b,e),a.shift());c()}function j(b){if(!h){h=t;for(q[b]=1;a.length&&0===a[0].scripts.length;)i=a.shift(),i.c&&i.c.call(i.scope||f);c()}}if(i){if(a.unshift(i),1<a.length)return}else if(0===a.length)return;var i=a[0],l,h=p,k=i.scripts.shift();
i.d&&v&&9>v?b(k,t,j,m):k in q?j(k):(l=r.createElement("script"),l.type="text/javascript",l.onerror=function(){e();m(404,k)},"onload"in l||!("readyState"in l)?l.onload=function(){e();j(k)}:l.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)e(),j(k)},l.src=k+(f.imports.disableCaching?(0<k.indexOf("?")?"&":"?")+(new Date).getTime():""),(H.firstChild||r.getElementsByTagName("head")[0]).appendChild(l))}var a=[],e=RegExp("^((?:"+location.protocol+")?//"+location.host+
"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),u=p;try{r.querySelectorAll("html:not(a)"),u=t}catch(w){}return function(a,n,m,j){for(var a="string"===typeof a?[a]:a,l=0,h,k=t,s=!!n,x=a.length,v={},w=u?r.querySelectorAll('script[src]:not([data-calmjs="1"])'):r.getElementsByTagName("script");h=w[l++];)if(h.setAttribute("data-calmjs","1"),h=h.getAttribute("src"))q[f.absoluteURL(h,C)]=1;for(;x--;){if(!e.test(a[x]=f.absoluteURL(a[x],C)))k=p;a[x]in q||a[x]in v?a.splice(x,1):v[a[x]]=1}if(0===a.length)return n&&
n.call(j||f);if(k&&!s){for(;h=a.shift();){b(h,p,function(a){q[a]=1;k=p},function(a,b){m&&m.call(j||f,a,b)?k=p:m||d(a,b)});if(k)return;k=t}return n&&n.call(j||f)}c({scope:j||f,d:k,scripts:a,c:n||o,b:m||o})}}();f.ownEach.toString=f.instanceOf.toString=f.absoluteURL.toString=f.imports.toString=f.toString=function(){return"[object Function]"};A&&!("execVBscript"in s)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript");s.Class=f})(window,!0,!1,null);
