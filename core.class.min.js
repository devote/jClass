/*
 * core.class.js Library for JavaScript v0.4.3
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 25-07-2012
 */
(function(q,w,p,r,A){function y(){}function e(){function d(){var b=0===+this,c=arguments,i=new s,h=i,g=b?c[0]:{a:i};i.parent=r;if(j){j=z(j,B,d);i.parent=j.call(p,g);var k=function(){};k.prototype=i.parent;h=new k}else h.shared={};if(j||b)t(i,function(b,a){"function"===typeof a?(h[b]=function(){var b=g.a.parent,c=g.a.Class;g.a.parent=i.parent;g.a.Class=h.Class;var d=a.apply(this===h||this==q?g.a:this,arguments);g.a.Class=c;g.a.parent=b;return d},h[b].toString=function(){return a.toString()}):h[b]=
a}),g.a=b?g.a:h;h.Class=d;for(k=0;k<I;k++)n[k]=z(n[k],B,d),t(n[k].call(p,g),function(b,a){h[b]===A&&(h[b]=a)},1);if(!b&&0!==l)if(C){if(u){if(a===p){a="StaticClass"+J+C++;var e=[],m=0,o=["Class "+a];t(h,function(b){var a=0===b.indexOf("$")?1:0===b.indexOf("get ")?2:0===b.indexOf("set ")?3:"toString"===b?4:0;if(a){var c=4===a?"("+b+")":(m=1)&&1===a?b.substring(1):b.split(" ").pop();if(1===a||2===a||4===a)o.push("Public "+(4===a?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(1===a?h.__get?
'me.[__get].call(me,"'+c+'")':"":h[b]?"me.["+b+"].call(me)":"")+",["+c+"])","End Property");if(1===a||3===a)o.push("Public Property Let ["+c+"](val)",1===a?h.__set?'Call me.[__set].call(me,"'+c+'",val)':"":h[b]?"Call me.["+b+"].call(me,val)":"","End Property","Public Property Set ["+c+"](val)",1===a?h.__set?'Call me.[__set].call(me,"'+c+'",val)':"":h[b]?"Call me.["+b+"].call(me,val)":"","End Property")}50===e.length&&(o.push("Public ["+e.join("],[")+"]"),e.length=0);e[e.length]=b;l[l.length]=b},1);
m?(o.push("Public ["+e.join("],[")+"]","End Class","Function "+a+"Factory()","Set "+a+"Factory=New "+a,"End Function"),execVBScript(o.join("\n"))):(l=0,a=r);e=o=r}if(a){g.a=q[a+"Factory"]();for(k=l.length;f=l[--k];)g.a[f]=h[f];h=g.a}}}else if(t(f?h:l,function(b){var a=0===b.indexOf("$")?1:0===b.indexOf("get ")?2:0===b.indexOf("set ")?3:0;if(a){f&&(l[l.length]=b);var c=1===a?b.substring(1):b.split(" ").pop(),d={enumerable:1,configurable:1,set:r,get:r};if(1===a||2===a)d.get=function(){return(h[1===
a?"__get":b]||y).call(this,1===a?c:A)};if(1===a||3===a)d.set=function(d){(h[1===a?"__set":b]||y).call(this,1===a?c:d,1===a?d:A)};if(D){var g=Object.getOwnPropertyDescriptor(h,c);d.get=d.get||g&&g.get||y;d.set=d.set||g&&g.set||y;D(h,c,d)}else(1===a||2===a)&&h.__defineGetter__(c,d.get),(1===a||3===a)&&h.__defineSetter__(c,d.set)}},1),f&&!(f=0)&&0===l.length)l=0;return new (b?function(){return h}:function(){h.constructor&&h.constructor!==Object.prototype.constructor&&h.constructor.apply(h,c);return h})}
var f=1,l=[],a=p,c=arguments,m=c.length-1,s=c[m--]||{},b="object"===typeof c[m]?c[m--]:{},k="function"===typeof c[m]||"string"===typeof c[m-1]?c[m--]:"",g=(c[m--]||"").replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),B=c[m--]||b.__context||e.defaultContext||e,i="extends"!==g[0]&&g.shift()||"",g=("extends"===g.shift()&&g.shift()||"").split(","),j=b.__extends||k||g.shift(),g=b.__implements||g,n=g instanceof Array?g:[g],I=n.length;if("function"!==typeof s)var o=s,s=function(){return o};
d.toString=function(){return"[class "+(i||"Object")+"]"};t(b,function(b,a){d[b]=a});if(d.className=i){b=B;k=(g=i.split(".")).shift();do 0===g.length?b[k]=d:(k in b||(b[k]={}),b=b[k]);while(k=g.shift())}return d}var s=q.document,K=s.documentElement,J=(new Date).getTime(),L=Object.prototype.toString,D=Object.defineProperty,G=Object.prototype.hasOwnProperty,H=s.getElementsByTagName("script"),E=(H[H.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),u=eval("/*@cc_on (@_jscript_version+'').replace(/\\d\\./, '');@*/"),
C=(D||Object.prototype.__defineGetter__)&&(!u||8<u)?0:1,M=!{toString:1}.propertyIsEnumerable("toString"),t,z,F,x={},v="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");e.classByName=z=function(d,f,l){var a,c=d,m=f;if("string"===typeof c){for(c=c.split(".");(a=c.shift())&&(m=m[a]););c=m}if(!c&&l&&"function"===typeof e.autoload&&!(c=e.autoload.call(f,d,l)||z(d,f)))throw Error("Parent class '"+d+"' not Initialized or Undefined");return c};e.ownEach=
t=function(d,f,l){var a,c,e=v.length;if("[object Array]"===L.call(d)){e=d.length;for(a=0;a<e&&!(c=d[a],f.call(d[a],l?c:a,l?a:c)===p);a++);}else{for(a in d)if(c=d[a],(l&&c!==Object.prototype[a]||G.call(d,a))&&f.call(c,a,c)===p){e=p;break}if(e&&M)for(a=0;a<e&&!(c=d[v[a]],(G.call(d,v[a])||l&&c!=r&&c!==Object.prototype[v[a]])&&f.call(c,v[a],c)===p);a++);}};e.instanceOf=function(d,f){for(;d&&d.Class!=r;){if(d.Class===f)return w;d=d.parent}return p};e.absoluteURL=F=function(d){return function(f,e){e&&!/^(?:https?:)?\/[\/]?/.test(f)&&
(f=("string"===typeof e?e:E)+f);var e=q.location,a,c=e.pathname,f=/^(?:[a-z]+\:)?\/\//.test(f)?f:e.protocol+"//"+e.host+(0===f.indexOf("/")?f:0===f.indexOf("?")?c+f:0===f.indexOf("#")?c+e.search+f:c.replace(/[^\/]+$/g,"")+f);d.href=f;a=d.protocol;c=d.pathname;f=(":"===a?e.protocol:a)+"//";f="http:"===a&&80==d.port||"https:"===a&&443==d.port?f+d.hostname:f+d.host;return f+(0===c.indexOf("/")?c:"/"+c)+d.search+d.hash}}(s.createElement("A"));e.imports=function(){function d(b,a){if(e.imports.onerror)e.imports.onerror(b,
a);else throw Error(404==b?"Module "+a+" not found":'Error executing module "'+a+'".');}function f(b,a,c,d){if(b in x)c(b);else{var f=b+(0<b.indexOf("?")?"&":"?")+(new Date).getTime(),j=new XMLHttpRequest;j.open("GET",e.imports.disableCaching?f:b,a);j.onreadystatechange=function(){if(4===j.readyState){var a=1223===j.status?204:0===j.status&&"file:"==(self.location||{}).protocol?200:j.status;if(200<=a&&300>a||304===a){try{(q.execScript||function(a){q.eval.call(q,a)})(j.responseText+(!u?"\n//@ sourceURL="+
b:""))}catch(e){return d(a,b)}c(b)}else d(a,b)}};j.send(r)}}function l(b){function c(){var a;if(i){i.onload=i.onreadystatechange=i.onerror=r;i.parentNode.removeChild(i);for(a in i)try{i[a]=r,delete i[a]}catch(b){}i=r}}function g(c,f){b.b&&b.b.call(b.scope||e,c,f)?0===a[0].scripts.length&&a.shift():(b.b||d(c,f),a.shift());l()}function m(c){if(!j){j=w;for(x[c]=1;a.length&&0===a[0].scripts.length;)b=a.shift(),b.c&&b.c.call(b.scope||e);l()}}if(b){if(a.unshift(b),1<a.length)return}else if(0===a.length)return;
var b=a[0],i,j=p,n=b.scripts.shift();b.d&&u&&9>u?f(n,w,m,g):n in x?m(n):(i=s.createElement("script"),i.type="text/javascript",i.onerror=function(){c();g(404,n)},"onload"in i||!("readyState"in i)?i.onload=function(){c();m(n)}:i.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)c(),m(n)},i.src=n+(e.imports.disableCaching?(0<n.indexOf("?")?"&":"?")+(new Date).getTime():""),(K.firstChild||s.getElementsByTagName("head")[0]).appendChild(i))}var a=[],c=RegExp("^((?:"+
location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),m=p;try{s.querySelectorAll("html:not(a)"),m=w}catch(t){}return function(a,k,g,q){for(var a="string"===typeof a?[a]:a,i=0,j,n=w,t=!!k,o=a.length,u={},v=m?s.querySelectorAll('script[src]:not([data-calmjs="1"])'):s.getElementsByTagName("script");j=v[i++];)if(j.setAttribute("data-calmjs","1"),j=j.getAttribute("src"))x[F(j,E)]=1;for(;o--;){if(!c.test(a[o]=F(a[o],E)))n=p;a[o]in x||a[o]in u?a.splice(o,1):u[a[o]]=1}if(0===a.length)return k&&
k.call(q||e);if(n&&!t){for(;j=a.shift();){f(j,p,function(a){x[a]=1;n=p},function(a,b){g&&g.call(q||e,a,b)?n=p:g||d(a,b)});if(n)return;n=w}return k&&k.call(q||e)}l({scope:q||e,d:n,scripts:a,c:k||r,b:g||r})}}();t(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(d,f){e[f].toString=e.toString=function(){return"[object Function]"}});C&&!("execVBscript"in q)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript");q.Class=e})(window,!0,!1,null);
