/*
 * core.class.min.js Library for JavaScript v0.5.1
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 27-01-2013
 */
(function(p,v,q,s,E){function C(c,e){return function(){throw Error("'"+c+"' property is "+(e?"read":"write")+"-only");}}function l(){function c(){for(var a=w,g=0===+this,k=arguments,m=s,l=new D,h=l,i=g?k[0]:{a:l},n=!g||k[1]===E?A:k[1];a--;)("string"===typeof x[a]&&(x[a]=F(x[a],K,c)),a===w-1?(d=function(){},d.prototype=x[a].call(q,i,n)):t(x[a].call(q,i,n),function(a,b){d.prototype[a]=b},1),0===a)?(m=d.prototype,h=new d):(delete d.prototype.__construct,delete d.prototype.constructor,h=new d,d=function(){},
d.prototype=h);n||(l.parent=m);if(y||g)d=function(a,b,c){a[b]=function(){var a=i.a.parent,b=i.a.__class__;i.a.parent=l.parent;i.a.__class__=h.__class__;var e=c.apply(this===h||this==p?i.a:this,arguments);i.a.__class__=b;i.a.parent=a;return e};a[b].toString=function(){return c.toString()}},t(l,function(a,b){"function"===typeof b&&!n?d(h,a,b):(!n&&b&&"object"===typeof b&&("set"in b&&"function"===typeof b.set&&d(b,"set",b.set),"get"in b&&"function"===typeof b.get&&d(b,"get",b.get)),h[a]=b)}),i.a=g?i.a:
h;g&&v in h&&(h.constructor=h[v]);n||(h.__class__=c);if(!g&&0!==j)if(G){if(z){if(f===q){f="StaticClass"+L+G++;var o=[],u=0,r=["Class "+f];t(h,function(a,b){var c=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:"toString"===a?4:b&&"object"===typeof b&&(b.set||b.get)?5:0;if(c){var e=4===c?a:(u=1)&&1===c?a.substring(1):5===c?a:a.split(" ").pop();j[a]=b;3!==c&&r.push("Public "+(4===c?"Default ":"")+"Property Get ["+e+"]","Call VBCorrectVal("+(1===c?h.__get?'me.[__get].call(me,"'+
e+'")':"":j[a]&&(5!==c||j[a].get)?"[(accessors)].["+a+"]"+(5===c?".get":"")+".call(me)":"window.undefined")+",["+e+"])","End Property");if(c&1||4===c)r.push("Public Property Let ["+e+"](val)",c=(1===c?h.__set?'Call me.[__set].call(me,"'+e+'",val)':"":4===c?"Set [(accessors)].["+a+"]=val":j[a]&&(5!==c||j[a].set)?"Call [(accessors)].["+a+"]"+(5===c?".set":"")+".call(me,val)":"")+"\nEnd Property","Public Property Set ["+e+"](val)",c)}c||(50===o.length&&(r.push("Public ["+o.join("],[")+"]"),o.length=
0),o[o.length]=a)},1);u?(r.push((o.length?"Public ["+o.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+f+"FactoryJS()","End Sub","End Class","Function "+f+"Factory()","Set "+f+"Factory=New "+f,"End Function"),p[f+"FactoryJS"]=function(){return b},execVBScript(r.join("\n"))):(j=0,f=s);o=r=s}f&&(b={},t(j,function(a){b[a]=h[a]}),i.a=p[f+"Factory"](),t(h,function(a,b){j.hasOwnProperty(a)||((!y||n)&&"function"===typeof b?(i.a[a]=function(){return b.apply(this===
h||this==p?i.a:this,arguments)},i.a[a].toString=function(){return b.toString()}):i.a[a]=b)},1),h=i.a)}}else if(t(e?h:j,function(a,c){var d=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:c&&"object"===typeof c&&(c.set||c.get)?5:0;if(d){e&&(j[a]=c,b++);c=h[a];H.call(h,a)&&delete h[a];var f=1===d?a.substring(1):5===d?a:a.split(" ").pop(),g={enumerable:1,configurable:1,set:s,get:s};3!==d&&(g.get=function(){return((d===1?h.__get:d===5?c.get:c)||C(f,0)).call(this,d===1?f:E)});d&1&&
(g.set=function(a){((d===1?h.__set:d===5?c.set:c)||C(f,1)).call(this,d===1?f:a,d===1?a:E)});if(I){var i=Object.getOwnPropertyDescriptor(h,f);g.get=g.get||i&&i.get||C(f,0);g.set=g.set||i&&i.set||C(f,1);I(h,f,g)}else 3!==d&&h.__defineGetter__(f,g.get),d&1&&h.__defineSetter__(f,g.set)}},e?1:0),e&&!(e=0)&&0===b)j=0;return new (g?function(){return h}:function(){v in h?h[v].apply(h,k):"__construct"in h?h.__construct.apply(h,k):h.constructor&&h.constructor!==Object.prototype.constructor&&h.constructor.apply(h,
k);return h})}var e=1,j={},b=0,f=q,d=arguments,v,a=d.length-1,D=d[a--]||{},i={"extends":1,"implements":1},k="object"===typeof d[a]&&d[a]?d[a--]:{},m=k.statics||(k.context||k["extends"]||k["implements"]||k.disableStatement?{}:k),n="function"===typeof d[a]||"string"===typeof d[a-1]?d[a--]:"",g=((d[a--]||"")+("string"==typeof n?" extends "+n:"")).replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),K=d[a--]||k.context||l.defaultContext||p,o=!(g[0]in i)&&g.shift()||"",u=(a=g.shift())in
i&&(i=g.shift())?i.split(","):[],r="extends"===a?(a=g.shift(),u.shift()):"",g="implements"===a?u.concat((i=g.shift())?i.split(","):[]):u,y=k["extends"]||r||n,i=k["implements"]||g,x=i instanceof Array?(y&&i.unshift(y),i):y&&[y,i]||[i],w=x.length,A=k.disableStatement;if("function"!==typeof D)var B=D,D=function(){return B};c.toString=function(){return"[class "+(o||"Object")+"]"};t(m,function(a,b){c[a]=b});if(c.className=o){k=K;d=(g=o.split(".")).shift();do 0===g.length?k[v=d]=c:(d in k||(k[d]={}),k=
k[d]);while(d=g.shift())}return c}var u=p.document,M=u.documentElement,L=(new Date).getTime(),N=Object.prototype.toString,I=Object.defineProperty,H=Object.prototype.hasOwnProperty,A=u.getElementsByTagName("script"),B=(A[A.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),z=+((p.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),G=(I||Object.prototype.__defineGetter__)&&(!z||8<z)?0:1,O=!{toString:1}.propertyIsEnumerable("toString"),t,F,J,r={},w="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");
l.classByName=F=function(c,e,j){var b,f=c,d=e=e||l.defaultContext||l;if("string"===typeof f){for(f=f.split(".");(b=f.shift())&&(d=d[b]););f=d}if(!f&&j&&!("function"===typeof l.autoload&&(f=l.autoload.call(e,c,j)||F(c,e))))throw Error("Parent class '"+c+"' not Initialized or Undefined");return f};l.ownEach=t=function(c,e,j){var b,f,d=w.length;if("[object Array]"===N.call(c)){d=c.length;for(b=0;b<d&&!(f=c[b],e.call(c[b],j?f:b,j?b:f)===q);b++);}else{for(b in c)if(f=c[b],(j&&f!==Object.prototype[b]||
H.call(c,b))&&e.call(f,b,f)===q){d=q;break}if(d&&O)for(b=0;b<d&&!(f=c[w[b]],(H.call(c,w[b])||j&&f!=s&&f!==Object.prototype[w[b]])&&e.call(f,w[b],f)===q);b++);}};l.instanceOf=function(c,e){for(;c&&c.__class__!=s;){if(c.__class__===e)return v;c=c.parent}return q};l.absoluteURL=J=function(c){return function(e,j){j&&!/^(?:https?:)?\/[\/]?/.test(e)&&(e=("string"===typeof j?j:B)+e);var j=p.location,b,f=j.pathname,e=/^(?:[a-z]+\:)?\/\//.test(e)?e:j.protocol+"//"+j.host+(0===e.indexOf("/")?e:0===e.indexOf("?")?
f+e:0===e.indexOf("#")?f+j.search+e:f.replace(/[^\/]+$/g,"")+e);c.href=e;b=c.protocol;f=c.pathname;e=(":"===b?j.protocol:b)+"//";e="http:"===b&&80==c.port||"https:"===b&&443==c.port?e+c.hostname:e+c.host;return e+(0===f.indexOf("/")?f:"/"+f)+c.search+c.hash}}(u.createElement("A"));l.imports=function(){function c(a,b){if(l.imports.onerror)l.imports.onerror(a,b);else throw Error(404==a?"Module "+b+" not found":'Error executing module "'+b+'".');}function e(a,b,c,d){if(a in r)c(a);else{var f=a+(0<a.indexOf("?")?
"&":"?")+(new Date).getTime(),e="XMLHttpRequest"in p?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");e.open("GET",l.imports.disableCaching?f:a,b);e.onreadystatechange=function(){if(4===e.readyState){var b=1223===e.status?204:0===e.status&&"file:"==(self.location||{}).protocol?200:e.status;if(200<=b&&300>b||304===b){try{(p.execScript||function(a){p.eval.call(p,a)})(e.responseText+"\n////@ sourceURL="+a)}catch(f){return d(b,a)}c(a)}else d(b,a)}};e.send(s)}}function j(a){function d(){var a;
if(m){m.onload=m.onreadystatechange=m.onerror=s;m.parentNode.removeChild(m);for(a in m)try{m[a]=s,delete m[a]}catch(b){}m=s}}function f(d,e){a.b&&a.b.call(a.scope||l,d,e)?0===b[0].scripts.length&&b.shift():(a.b||c(d,e),b.shift());j()}function k(c){if(!n){n=v;for(r[c]=1;b.length&&0===b[0].scripts.length;)a=b.shift(),a.c&&a.c.call(a.scope||l);j()}}if(a){if(b.unshift(a),1<b.length)return}else if(0===b.length)return;var a=b[0],m,n=q,g=a.scripts.shift();a.d&&z&&9>z?e(g,v,k,f):g in r?k(g):(m=u.createElement("script"),
m.type="text/javascript",m.onerror=function(){d();f(404,g)},"onload"in m||!("readyState"in m)?m.onload=function(){d();k(g)}:m.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)d(),k(g)},m.src=g+(l.imports.disableCaching?(0<g.indexOf("?")?"&":"?")+(new Date).getTime():""),M.firstChild.appendChild(m))}var b=[],f=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),d=q;try{u.querySelectorAll("html:not(a)"),d=v}catch(t){}return function(a,
b,i,k){for(var a=("string"===typeof a?[a]:a)||[],m=0,n,g=v,p=!!b,o=a.length,t={},w=d?u.querySelectorAll('script[src]:not([data-calmjs="1"])'):A;n=w[m++];)if(n.setAttribute("data-calmjs","1"),n=n.getAttribute("src"))r[J(n,B)]=1;for(;o--;){if(!f.test(a[o]=J(a[o],B)))g=q;a[o]in r||a[o]in t?a.splice(o,1):t[a[o]]=1}if(0===a.length)return b&&b.call(k||l);if(g&&!p){for(;n=a.shift();){e(n,q,function(a){r[a]=1;g=q},function(a,b){i&&i.call(k||l,a,b)?g=q:i||c(a,b)});if(g)return;g=v}return b&&b.call(k||l)}j({scope:k||
l,d:g,scripts:a,c:b||s,b:i||s})}}();t(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(c,e){l[e].toString=l.toString=function(){return"[object Function]"}});G&&!("execVBscript"in p)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");p.Class=l})(window,!0,!1,null);
