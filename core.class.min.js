/*
 * core.class.js Library for JavaScript v0.4.6
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 04-08-2012
 */
(function(r,s,n,p,C){function z(){}function k(){function e(){var b=0===+this,c=arguments,d=new s,j=d,h=b?c[0]:{a:d};d.parent=p;if(q){q=A(q,o,e);d.parent=q.call(n,h);var g=function(){};g.prototype=d.parent;j=new g}else j.shared={};if(q||b)t(d,function(b,a){"function"===typeof a?(j[b]=function(){var b=h.a.parent,c=h.a.Class;h.a.parent=d.parent;h.a.Class=j.Class;var e=a.apply(this===j||this==r?h.a:this,arguments);h.a.Class=c;h.a.parent=b;return e},j[b].toString=function(){return a.toString()}):j[b]=
a}),h.a=b?h.a:j;j.Class=e;for(g=0;g<w;g++)B[g]=A(B[g],o,e),t(B[g].call(n,h),function(b,a){j[b]===C&&(j[b]=a)},1);if(!b&&0!==i)if(D){if(v){if(a===n){a="StaticClass"+K+D++;var l=[],k=0,m=["Class "+a];t(j,function(b){var a=0===b.indexOf("$")?1:0===b.indexOf("get ")?2:0===b.indexOf("set ")?3:"toString"===b?4:0;if(a){var c=4===a?"("+b+")":(k=1)&&1===a?b.substring(1):b.split(" ").pop();if(1===a||2===a||4===a)m.push("Public "+(4===a?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(1===a?j.__get?
'me.[__get].call(me,"'+c+'")':"":j[b]?"me.["+b+"].call(me)":"")+",["+c+"])","End Property");if(1===a||3===a)m.push("Public Property Let ["+c+"](val)",a=(1===a?j.__set?'Call me.[__set].call(me,"'+c+'",val)':"":j[b]?"Call me.["+b+"].call(me,val)":"")+"\nEnd Property","Public Property Set ["+c+"](val)",a)}50===l.length&&(m.push("Public ["+l.join("],[")+"]"),l.length=0);l[l.length]=b;i[i.length]=b},1);k?(m.push("Public ["+l.join("],[")+"]","End Class","Function "+a+"Factory()","Set "+a+"Factory=New "+
a,"End Function"),execVBScript(m.join("\n"))):(i=0,a=p);l=m=p}if(a){h.a=r[a+"Factory"]();for(g=i.length;f=i[--g];)h.a[f]=j[f];j=h.a}}}else if(t(f?j:i,function(b){var a=0===b.indexOf("$")?1:0===b.indexOf("get ")?2:0===b.indexOf("set ")?3:0;if(a){f&&(i[i.length]=b);var c=1===a?b.substring(1):b.split(" ").pop(),d={enumerable:1,configurable:1,set:p,get:p};if(1===a||2===a)d.get=function(){return(j[1===a?"__get":b]||z).call(this,1===a?c:C)};if(1===a||3===a)d.set=function(d){(j[1===a?"__set":b]||z).call(this,
1===a?c:d,1===a?d:C)};if(E){var e=Object.getOwnPropertyDescriptor(j,c);d.get=d.get||e&&e.get||z;d.set=d.set||e&&e.set||z;E(j,c,d)}else(1===a||2===a)&&j.__defineGetter__(c,d.get),(1===a||3===a)&&j.__defineSetter__(c,d.set)}},1),f&&!(f=0)&&0===i.length)i=0;return new (b?function(){return j}:function(){j.constructor&&j.constructor!==Object.prototype.constructor&&j.constructor.apply(j,c);return j})}var f=1,i=[],a=n,c=arguments,g=c.length-1,s=c[g--]||{},b={"extends":1,"implements":1},l="object"===typeof c[g]?
c[g--]:{},m=l["static"]||(l.context||l["extends"]||l["implements"]?{}:l),u="function"===typeof c[g]||"string"===typeof c[g-1]?c[g--]:"",d=(c[g--]||"").replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),o=c[g--]||l.context||k.defaultContext||k,h=!(d[0]in b)&&d.shift()||"",F=(g=d.shift())in b&&(b=d.shift())?b.split(","):[],c="extends"===g?(g=d.shift(),F.shift()):"",d="implements"===g?F.concat((b=d.shift())?b.split(","):[]):F,q=l["extends"]||u||c,d=l["implements"]||d,B=d instanceof
Array?d:[d],w=B.length;if("function"!==typeof s)var x=s,s=function(){return x};e.toString=function(){return"[class "+(h||"Object")+"]"};t(m,function(b,a){e[b]=a});if(e.className=h){m=o;b=(d=h.split(".")).shift();do 0===d.length?m[b]=e:(b in m||(m[b]={}),m=m[b]);while(b=d.shift())}return e}var w=r.document,L=w.documentElement,K=(new Date).getTime(),M=Object.prototype.toString,E=Object.defineProperty,J=Object.prototype.hasOwnProperty,G=w.getElementsByTagName("script"),H=(G[G.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,
""),v=eval("/*@cc_on (@_jscript_version+'').replace(/\\d\\./, '');@*/"),D=(E||Object.prototype.__defineGetter__)&&(!v||8<v)?0:1,N=!{toString:1}.propertyIsEnumerable("toString"),t,A,I,x={},y="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");k.classByName=A=function(e,f,i){var a,c=e,g=f=f||k.defaultContext||k;if("string"===typeof c){for(c=c.split(".");(a=c.shift())&&(g=g[a]););c=g}if(!c&&i&&!("function"===typeof k.autoload&&(c=k.autoload.call(f,
e,i)||A(e,f))))throw Error("Parent class '"+e+"' not Initialized or Undefined");return c};k.ownEach=t=function(e,f,i){var a,c,g=y.length;if("[object Array]"===M.call(e)){g=e.length;for(a=0;a<g&&!(c=e[a],f.call(e[a],i?c:a,i?a:c)===n);a++);}else{for(a in e)if(c=e[a],(i&&c!==Object.prototype[a]||J.call(e,a))&&f.call(c,a,c)===n){g=n;break}if(g&&N)for(a=0;a<g&&!(c=e[y[a]],(J.call(e,y[a])||i&&c!=p&&c!==Object.prototype[y[a]])&&f.call(c,y[a],c)===n);a++);}};k.instanceOf=function(e,f){for(;e&&e.Class!=p;){if(e.Class===
f)return s;e=e.parent}return n};k.absoluteURL=I=function(e){return function(f,i){i&&!/^(?:https?:)?\/[\/]?/.test(f)&&(f=("string"===typeof i?i:H)+f);var i=r.location,a,c=i.pathname,f=/^(?:[a-z]+\:)?\/\//.test(f)?f:i.protocol+"//"+i.host+(0===f.indexOf("/")?f:0===f.indexOf("?")?c+f:0===f.indexOf("#")?c+i.search+f:c.replace(/[^\/]+$/g,"")+f);e.href=f;a=e.protocol;c=e.pathname;f=(":"===a?i.protocol:a)+"//";f="http:"===a&&80==e.port||"https:"===a&&443==e.port?f+e.hostname:f+e.host;return f+(0===c.indexOf("/")?
c:"/"+c)+e.search+e.hash}}(w.createElement("A"));k.imports=function(){function e(b,a){if(k.imports.onerror)k.imports.onerror(b,a);else throw Error(404==b?"Module "+a+" not found":'Error executing module "'+a+'".');}function f(b,a,c,e){if(b in x)c(b);else{var d=b+(0<b.indexOf("?")?"&":"?")+(new Date).getTime(),f=new XMLHttpRequest;f.open("GET",k.imports.disableCaching?d:b,a);f.onreadystatechange=function(){if(4===f.readyState){var a=1223===f.status?204:0===f.status&&"file:"==(self.location||{}).protocol?
200:f.status;if(200<=a&&300>a||304===a){try{(r.execScript||function(a){r.eval.call(r,a)})(f.responseText+(!v?"\n//@ sourceURL="+b:""))}catch(d){return e(a,b)}c(b)}else e(a,b)}};f.send(p)}}function i(b){function c(){var a;if(d){d.onload=d.onreadystatechange=d.onerror=p;d.parentNode.removeChild(d);for(a in d)try{d[a]=p,delete d[a]}catch(b){}d=p}}function g(c,d){b.b&&b.b.call(b.scope||k,c,d)?0===a[0].scripts.length&&a.shift():(b.b||e(c,d),a.shift());i()}function u(c){if(!o){o=s;for(x[c]=1;a.length&&
0===a[0].scripts.length;)b=a.shift(),b.c&&b.c.call(b.scope||k);i()}}if(b){if(a.unshift(b),1<a.length)return}else if(0===a.length)return;var b=a[0],d,o=n,h=b.scripts.shift();b.d&&v&&9>v?f(h,s,u,g):h in x?u(h):(d=w.createElement("script"),d.type="text/javascript",d.onerror=function(){c();g(404,h)},"onload"in d||!("readyState"in d)?d.onload=function(){c();u(h)}:d.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)c(),u(h)},d.src=h+(k.imports.disableCaching?(0<h.indexOf("?")?
"&":"?")+(new Date).getTime():""),L.firstChild.appendChild(d))}var a=[],c=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),g=n;try{w.querySelectorAll("html:not(a)"),g=s}catch(t){}return function(a,l,m,u){for(var a=("string"===typeof a?[a]:a)||[],d=0,o,h=s,r=!!l,q=a.length,t={},v=g?w.querySelectorAll('script[src]:not([data-calmjs="1"])'):G;o=v[d++];)if(o.setAttribute("data-calmjs","1"),o=o.getAttribute("src"))x[I(o,H)]=1;for(;q--;){if(!c.test(a[q]=I(a[q],
H)))h=n;a[q]in x||a[q]in t?a.splice(q,1):t[a[q]]=1}if(0===a.length)return l&&l.call(u||k);if(h&&!r){for(;o=a.shift();){f(o,n,function(a){x[a]=1;h=n},function(a,b){m&&m.call(u||k,a,b)?h=n:m||e(a,b)});if(h)return;h=s}return l&&l.call(u||k)}i({scope:u||k,d:h,scripts:a,c:l||p,b:m||p})}}();t(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(e,f){k[f].toString=k.toString=function(){return"[object Function]"}});D&&!("execVBscript"in r)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript");r.Class=k})(window,!0,!1,null);
