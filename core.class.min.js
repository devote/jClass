/*
 * core.class.min.js Library for JavaScript v0.5.5
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 30-01-2013
 */
(function(q,t,r,s,L){function B(b,f){return function(){throw Error("'"+b+"' property is "+(f?"read":"write")+"-only");}}function n(){function b(){for(var a=D,g=0===+this,i=arguments,l=s,m=new C,n=i[2]||s,h=n||m,k=g?i[0]:{a:m},o=!g||i[1]===L?w:i[1];a--;)"string"===typeof y[a]&&(y[a]=E(y[a],K,b)),e=function(){},e.prototype=l=y[a].call(r,k,o,n),0<a&&!o&&(e.prototype.constructor=function(){}),h=n=new e;o||(m.parent=l);if(D||g)e=function(a,c,b){a[c]=function(){var a=k.a.parent,c=k.a.__class__;k.a.parent=
m.parent;k.a.__class__=h.__class__;var f=b.apply(this===h||this==q?k.a:this,arguments);k.a.__class__=c;k.a.parent=a;return f};a[c].toString=function(){return b.toString()}},u(m,function(a,c){"function"===typeof c&&!o?e(h,a,c):(!o&&c&&"object"===typeof c&&("set"in c&&"function"===typeof c.set&&e(c,"set",c.set),"get"in c&&"function"===typeof c.get&&e(c,"get",c.get)),h[a]=c)}),k.a=g?k.a:h;o||(g&&t in h&&(h.constructor=h[t]),h.__class__=b);if(!g&&0!==j)if(F){if(z){if(d===r){d="StaticClass"+M+F++;var p=
[],v=0,x=["Class "+d];u(h,function(a,c){var b=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:a==="toString"?4:c&&typeof c==="object"&&(c.set||c.get)?5:0;if(b){var f=b===4?a:(v=1)&&b===1?a.substring(1):b===5?a:a.split(" ").pop();j[a]=c;b!==3&&x.push("Public "+(b===4?"Default ":"")+"Property Get ["+f+"]","Call VBCorrectVal("+(b===1?h.__get?'me.[__get].call(me,"'+f+'")':"":j[a]&&(b!==5||j[a].get)?"[(accessors)].["+a+"]"+(b===5?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+
",["+f+"])","End Property");if(b&1||b===4)x.push("Public Property Let ["+f+"](val)",b=(b===1?h.__set?'Call me.[__set].call(me,"'+f+'",val)':"":b===4?"Set [(accessors)].["+a+"]=val":j[a]&&(b!==5||j[a].set)?"Call [(accessors)].["+a+"]"+(b===5?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+f+"](val)",b)}if(!b){if(p.length===50){x.push("Public ["+p.join("],[")+"]");p.length=0}p[p.length]=a}},1);v?(x.push((p.length?"Public ["+p.join("],[")+"]\n":"")+"Private [(accessors)]",
"Private Sub Class_Initialize()","Set [(accessors)]="+d+"FactoryJS()","End Sub","End Class","Function "+d+"Factory()","Set "+d+"Factory=New "+d,"End Function"),q[d+"FactoryJS"]=function(){return c},execVBScript(x.join("\n"))):(j=0,d=s);p=x=s}d&&(c={},u(j,function(a){c[a]=h[a]}),k.a=q[d+"Factory"](),u(h,function(a,c){if(!j.hasOwnProperty(a))if((!D||o)&&typeof c==="function"){k.a[a]=function(){return c.apply(this===h||this==q?k.a:this,arguments)};k.a[a].toString=function(){return c.toString()}}else k.a[a]=
c},1),h=k.a)}}else if(u(f?h:j,function(a,b){var d=a.indexOf("$")===0?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:b&&typeof b==="object"&&(b.set||b.get)?5:0;if(d){if(f){j[a]=b;c++}b=h[a];G.call(h,a)&&delete h[a];var g=d===1?a.substring(1):d===5?a:a.split(" ").pop(),e={enumerable:1,configurable:1,set:s,get:s};if(d!==3)e.get=function(){return((d===1?h.__get:d===5?b.get:b)||B(g,0)).call(this,d===1?g:b)};if(d&1)e.set=function(a){((d===1?h.__set:d===5?b.set:b)||B(g,1)).call(this,d===1?g:a,d===1?a:
b)};if(H){var i=Object.getOwnPropertyDescriptor(h,g);e.get=e.get||i&&i.get||B(g,0);e.set=e.set||i&&i.set||B(g,1);H(h,g,e)}else{d!==3&&h.__defineGetter__(g,e.get);d&1&&h.__defineSetter__(g,e.set)}}},f?1:0),f&&!(f=0)&&0===c)j=0;return new (g?function(){return h}:function(){t in h?h[t].apply(h,i):h.constructor&&h.constructor!==Object.prototype.constructor&&h.constructor.apply(h,i);return h})}var f=1,j={},c=0,d=r,e=arguments,t,a=e.length-1,C=e[a--]||{},k={"extends":1,"implements":1},l="object"===typeof e[a]&&
e[a]&&!(e[a]instanceof Array)?e[a--]:{},m=l.statics||(l.context||l["extends"]||l["implements"]||l.compact?{}:l),i="function"===typeof e[a]||"string"===typeof e[a-1]||e[a]&&e[a]instanceof Array?e[a--]:"",g=((e[a--]||"")+(i&&"string"==typeof i?" extends "+i:"")).replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),K=e[a--]||l.context||n.defaultContext||q,o=!(g[0]in k)&&g.shift()||"",p=(a=g.shift())in k&&(k=g.shift())?k.split(","):i instanceof Array?i:[],v="extends"===a?(a=g.shift(),
p.shift()):"",g="implements"===a?p.concat((k=g.shift())?k.split(","):[]):p,k=l["extends"]||v||"string"===typeof i&&i,i=l["implements"]||g,y=i instanceof Array?(k&&i.unshift(k),i):k&&[k,i]||[i],D=y.length,w=l.compact;if("function"!==typeof C)var A=C,C=function(){return A};b.toString=function(){return"[class "+(o||"Object")+"]"};u(m,function(a,c){b[a]=c});if(b.className=o){l=K;e=(g=o.split(".")).shift();do 0===g.length?l[t=e]=b:(e in l||(l[e]={}),l=l[e]);while(e=g.shift())}return b}var p=q.document,
N=p.documentElement,M=(new Date).getTime(),O=Object.prototype.toString,H=Object.defineProperty,G=Object.prototype.hasOwnProperty,A=p.getElementsByTagName("script"),I=(A[A.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),z=+((q.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),F=(H||Object.prototype.__defineGetter__)&&(!z||8<z)?0:1,P=!{toString:1}.propertyIsEnumerable("toString"),u,E,J,v={},w="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");
n.classByName=E=function(b,f,j){var c,d=b,e=f=f||n.defaultContext||n;if("string"===typeof d){for(d=d.split(".");(c=d.shift())&&(e=e[c]););d=e}if(!d&&j&&!("function"===typeof n.autoload&&(d=n.autoload.call(f,b,j)||E(b,f))))throw Error("Parent class '"+b+"' not Initialized or Undefined");return d};n.ownEach=u=function(b,f,j){var c,d,e=w.length;if("[object Array]"===O.call(b)){e=b.length;for(c=0;c<e&&!(d=b[c],f.call(b[c],j?d:c,j?c:d)===r);c++);}else{for(c in b)if(d=b[c],(j&&d!==Object.prototype[c]||
G.call(b,c))&&f.call(d,c,d)===r){e=r;break}if(e&&P)for(c=0;c<e&&!(d=b[w[c]],(G.call(b,w[c])||j&&d!=s&&d!==Object.prototype[w[c]])&&f.call(d,w[c],d)===r);c++);}};n.instanceOf=function(b,f){for(;b&&b.__class__!=s;){if(b.__class__===f)return t;b=b.parent}return r};n.absoluteURL=J=function(b){return function(f,j){j&&!/^(?:https?:)?\/[\/]?/.test(f)&&(f=("string"===typeof j?j:I)+f);var j=q.location,c,d=j.pathname,f=/^(?:[a-z]+\:)?\/\//.test(f)?f:j.protocol+"//"+j.host+(0===f.indexOf("/")?f:0===f.indexOf("?")?
d+f:0===f.indexOf("#")?d+j.search+f:d.replace(/[^\/]+$/g,"")+f);b.href=f;c=b.protocol;d=b.pathname;f=(":"===c?j.protocol:c)+"//";f="http:"===c&&80==b.port||"https:"===c&&443==b.port?f+b.hostname:f+b.host;return f+(0===d.indexOf("/")?d:"/"+d)+b.search+b.hash}}(p.createElement("A"));n.imports=function(){function b(a,b){if(n.imports.onerror)n.imports.onerror(a,b);else throw Error(404==a?"Module "+b+" not found":'Error executing module "'+b+'".');}function f(a,b,c,d){if(a in v)c(a);else{var f=a+(0<a.indexOf("?")?
"&":"?")+(new Date).getTime(),e="XMLHttpRequest"in q?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");e.open("GET",n.imports.disableCaching?f:a,b);e.onreadystatechange=function(){if(4===e.readyState){var b=1223===e.status?204:0===e.status&&"file:"==(self.location||{}).protocol?200:e.status;if(200<=b&&300>b||304===b){try{(q.execScript||function(a){q.eval.call(q,a)})(e.responseText+"\n////@ sourceURL="+a)}catch(f){return d(b,a)}c(a)}else d(b,a)}};e.send(s)}}function j(a){function d(){var a;
if(m){m.onload=m.onreadystatechange=m.onerror=s;m.parentNode.removeChild(m);for(a in m)try{m[a]=s,delete m[a]}catch(b){}m=s}}function e(d,f){a.b&&a.b.call(a.scope||n,d,f)?0===c[0].scripts.length&&c.shift():(a.b||b(d,f),c.shift());j()}function l(b){if(!i){i=t;for(v[b]=1;c.length&&0===c[0].scripts.length;)a=c.shift(),a.c&&a.c.call(a.scope||n);j()}}if(a){if(c.unshift(a),1<c.length)return}else if(0===c.length)return;var a=c[0],m,i=r,g=a.scripts.shift();a.d&&z&&9>z?f(g,t,l,e):g in v?l(g):(m=p.createElement("script"),
m.type="text/javascript",m.onerror=function(){d();e(404,g)},"onload"in m||!("readyState"in m)?m.onload=function(){d();l(g)}:m.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)d(),l(g)},m.src=g+(n.imports.disableCaching?(0<g.indexOf("?")?"&":"?")+(new Date).getTime():""),N.firstChild.appendChild(m))}var c=[],d=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),e=r;try{p.querySelectorAll("html:not(a)"),e=t}catch(u){}return function(a,
c,k,l){for(var a=("string"===typeof a?[a]:a)||[],m=0,i,g=t,q=!!c,o=a.length,u={},w=e?p.querySelectorAll('script[src]:not([data-calmjs="1"])'):A;i=w[m++];)if(i.setAttribute("data-calmjs","1"),i=i.getAttribute("src"))v[J(i,I)]=1;for(;o--;){if(!d.test(a[o]=J(a[o],I)))g=r;a[o]in v||a[o]in u?a.splice(o,1):u[a[o]]=1}if(0===a.length)return c&&c.call(l||n);if(g&&!q){for(;i=a.shift();){f(i,r,function(a){v[a]=1;g=r},function(a,c){k&&k.call(l||n,a,c)?g=r:k||b(a,c)});if(g)return;g=t}return c&&c.call(l||n)}j({scope:l||
n,d:g,scripts:a,c:c||s,b:k||s})}}();u(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(b,f){n[f].toString=n.toString=function(){return"[object Function]"}});F&&!("execVBscript"in q)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");q.Class=n})(window,!0,!1,null);
