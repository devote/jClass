/*
 * core.class.js Library for JavaScript v0.3.0
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 03-06-2012
 */
(function(x,A,p,i,y){function g(a,c,d,b,e){function s(){var a=0===+this,b=arguments,c=new e,f=c,h=a?b[0]:{a:c};c.parent=i;if(d){c.parent=d.call(p,h);var k=function(){};k.prototype=c.parent;f=new k}else f.shared={};if(d||a)g.ownEach(c,function(a,b){"function"===typeof b?(f[a]=function(){var a=h.a.parent,d=h.a.Class;h.a.parent=c.parent;h.a.Class=c.Class;var e=b.apply(this===f||this==x?h.a:this,arguments);h.a.Class=d;h.a.parent=a;return e},f[a].toString=function(){return b.toString()}):f[a]=b}),h.a=
a?h.a:f;f.Class=s;if(!a&&0!==j)if(v){if(w){if(m===p){m="StaticClass"+B+v++;var q=[],o=0,r=["Class "+m];g.ownEach(f,function(a){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:"toString"===a?4:0;if(b){var c=4===b?"("+a+")":(o=1)&&1===b?a.substring(1):a.split(" ").pop();if(1===b||2===b||4===b)r.push("Public "+(4===b?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(1===b?f.c?'me.[__get].call(me,"'+c+'")':"":f[a]?"me.["+a+"].call(me)":"")+",["+c+"])","End Property");
if(1===b||3===b)r.push("Public Property Let ["+c+"](val)",1===b?f.b?'Call me.[__set].call(me,"'+c+'",val)':"":f[a]?"Call me.["+a+"].call(me,val)":"","End Property","Public Property Set ["+c+"](val)",1===b?f.b?'Call me.[__set].call(me,"'+c+'",val)':"":f[a]?"Call me.["+a+"].call(me,val)":"","End Property")}if(!b||1<b)50===q.length&&(r.push("Public ["+q.join("],[")+"]"),q.length=0),q[q.length]=a,j[j.length]=a},1);o?(r.push("Public ["+q.join("],[")+"]","End Class","Function "+m+"Factory()","Set "+m+"Factory=New "+
m,"End Function"),execVBScript(r.join("\n"))):(j=0,m=i);q=r=i}if(m){h.a=window[m+"Factory"]();for(k=j.length;n=j[--k];)h.a[n]=f[n];f=h.a}}}else if(g.ownEach(u?f:j,function(a){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:0;if(b){u&&(j[j.length]=a);var c=1===b?a.substring(1):a.split(" ").pop(),d={enumerable:1,configurable:1,set:i,get:i};if(1===b||2===b)d.get=function(){return(f[1===b?"__get":a]||l).call(this,1===b?c:y)};if(1===b||3===b)d.set=function(d){(f[1===b?"__set":
a]||l).call(this,1===b?c:d,1===b?d:y)};if(Object.defineProperty){var e=Object.getOwnPropertyDescriptor(f,c);d.get=d.get||e&&e.get||l;d.set=d.set||e&&e.set||l;Object.defineProperty(f,c,d)}else(1===b||2===b)&&f.__defineGetter__(c,d.get),(1===b||3===b)&&f.__defineSetter__(c,d.set)}},1),u&&!(u=0)&&0===j.length)j=0;return new (a?function(){return f}:function(){f.constructor&&f.constructor!==Object.prototype.constructor&&f.constructor.apply(f,b);return f})}function l(){}var n,k=[],o,u=1,j=[],m=p;if(3>arguments.length||
"string"===typeof a||"function"===typeof a&&"object"===typeof c)e=b,b=d,d=c,c=a,a=g;"string"===typeof c?(k=c.replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").split(" "),o=k[0]&&"extends"!==k[0]&&k.shift()||0):(e=b,b=d,d=c,c=i);e||((e=b)?"object"===typeof d?(b=d,d=null):b=i:(e=d,d=b=i));"string"===typeof d&&(n=d);if(e&&(n||"extends"===k.shift()||"function"===typeof c)){if((n||(n=k.shift()))&&!(c=a[n]))throw Error("Parent class '"+n+"' not Initialized or Undefined");d=c}if("function"!==typeof e)var t=e,e=function(){return t};
s.toString=function(){return"[class "+(o||"Object")+"]"};b&&g.ownEach(b,function(a){s[a]=b[a]});o&&(a[o]=s,a[o].className=o);return s}var w=eval("/*@cc_on (@_jscript_version+'').replace(/\\d\\./, '');@*/"),B=(new Date).getTime(),v=(Object.defineProperty||Object.prototype.__defineGetter__)&&(!w||8<w)?0:1,t={},z=Object.prototype.hasOwnProperty,C=Object.prototype.toString,D=!{toString:i}.propertyIsEnumerable("toString"),l="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(","),
E=function(){v&&!("execVBscript"in window)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");var a=document.getElementsByTagName("script");return(a[a.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,"")}();g.ownEach=function(a,c,d){var b,e,g=l.length;if("[object Array]"===C.call(a)){g=a.length;for(b=0;b<g&&!(e=a[b],c.call(a[b],d?e:b,d?b:e)===p);b++);}else{for(b in a)if(e=a[b],(d&&
e!==Object.prototype[b]||z.call(a,b))&&c.call(e,b,e)===p){g=p;break}if(g&&D)for(b=0;b<g&&!(e=a[l[b]],(z.call(a,l[b])||d&&e!=i&&e!==Object.prototype[l[b]])&&c.call(e,l[b],e)===p);b++);}};g.instanceOf=function(a,c){for(;a&&a.Class!=i;){if(a.Class===c)return A;a=a.parent}return p};g.include=function(a,c){a=/^(?:http\:)?\/[\/]?/i.test(a)?a:E+a;if(t[a])c&&c();else{var d=new XMLHttpRequest;d.open("GET",a,!!c);d.onreadystatechange=function(){if(4===d.readyState)if(200<=d.status&&300>d.status||304===d.status){t[a]=
1;try{(window.execScript||function(a){window.eval.call(window,a)})(d.responseText)}catch(b){throw delete t[a],Error('Error executing module "'+a+'". '+b);}c&&c()}else throw Error("Module "+a+" not found");};d.send(i)}};g.ownEach.toString=g.instanceOf.toString=g.include.toString=g.toString=function(){return"[object Function]"};x.Class=g})(window,!0,!1,null);
