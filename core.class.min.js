/*
 * core.class.js Library for JavaScript v0.4.5
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 26-07-2012
 */
(function(r,s,o,p,C){function z(){}function d(){function e(){var b=0===+this,c=arguments,g=new s,h=g,d=b?c[0]:{a:g};g.parent=p;if(m){m=A(m,k,e);g.parent=m.call(o,d);var l=function(){};l.prototype=g.parent;h=new l}else h.shared={};if(m||b)t(g,function(b,a){"function"===typeof a?(h[b]=function(){var b=d.a.parent,c=d.a.Class;d.a.parent=g.parent;d.a.Class=h.Class;var e=a.apply(this===h||this==r?d.a:this,arguments);d.a.Class=c;d.a.parent=b;return e},h[b].toString=function(){return a.toString()}):h[b]=
a}),d.a=b?d.a:h;h.Class=e;for(l=0;l<u;l++)B[l]=A(B[l],k,e),t(B[l].call(o,d),function(b,a){h[b]===C&&(h[b]=a)},1);if(!b&&0!==f)if(D){if(v){if(a===o){a="StaticClass"+J+D++;var i=[],j=0,q=["Class "+a];t(h,function(b){var a=0===b.indexOf("$")?1:0===b.indexOf("get ")?2:0===b.indexOf("set ")?3:"toString"===b?4:0;if(a){var c=4===a?"("+b+")":(j=1)&&1===a?b.substring(1):b.split(" ").pop();if(1===a||2===a||4===a)q.push("Public "+(4===a?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(1===a?h.__get?
'me.[__get].call(me,"'+c+'")':"":h[b]?"me.["+b+"].call(me)":"")+",["+c+"])","End Property");if(1===a||3===a)q.push("Public Property Let ["+c+"](val)",a=(1===a?h.__set?'Call me.[__set].call(me,"'+c+'",val)':"":h[b]?"Call me.["+b+"].call(me,val)":"")+"\nEnd Property","Public Property Set ["+c+"](val)",a)}50===i.length&&(q.push("Public ["+i.join("],[")+"]"),i.length=0);i[i.length]=b;f[f.length]=b},1);j?(q.push("Public ["+i.join("],[")+"]","End Class","Function "+a+"Factory()","Set "+a+"Factory=New "+
a,"End Function"),execVBScript(q.join("\n"))):(f=0,a=p);i=q=p}if(a){d.a=r[a+"Factory"]();for(l=f.length;n=f[--l];)d.a[n]=h[n];h=d.a}}}else if(t(n?h:f,function(b){var a=0===b.indexOf("$")?1:0===b.indexOf("get ")?2:0===b.indexOf("set ")?3:0;if(a){n&&(f[f.length]=b);var c=1===a?b.substring(1):b.split(" ").pop(),e={enumerable:1,configurable:1,set:p,get:p};if(1===a||2===a)e.get=function(){return(h[1===a?"__get":b]||z).call(this,1===a?c:C)};if(1===a||3===a)e.set=function(e){(h[1===a?"__set":b]||z).call(this,
1===a?c:e,1===a?e:C)};if(E){var d=Object.getOwnPropertyDescriptor(h,c);e.get=e.get||d&&d.get||z;e.set=e.set||d&&d.set||z;E(h,c,e)}else(1===a||2===a)&&h.__defineGetter__(c,e.get),(1===a||3===a)&&h.__defineSetter__(c,e.set)}},1),n&&!(n=0)&&0===f.length)f=0;return new (b?function(){return h}:function(){h.constructor&&h.constructor!==Object.prototype.constructor&&h.constructor.apply(h,c);return h})}var n=1,f=[],a=o,c=arguments,j=c.length-1,s=c[j--]||{},b="object"===typeof c[j]?c[j--]:{},l=b["static"]||
(b.context||b["extends"]||b["implements"]?{}:b),q="function"===typeof c[j]||"string"===typeof c[j-1]?c[j--]:"",g=(c[j--]||"").replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").replace(/\s*,\s*/g,",").split(" "),k=c[j--]||b.context||d.defaultContext||d,i="extends"!==g[0]&&g.shift()||"",g=("extends"===g.shift()&&g.shift()||"").split(","),m=b["extends"]||q||g.shift(),g=b["implements"]||g,B=g instanceof Array?g:[g],u=B.length;if("function"!==typeof s)var w=s,s=function(){return w};e.toString=function(){return"[class "+
(i||"Object")+"]"};t(l,function(b,a){e[b]=a});if(e.className=i){l=k;b=(g=i.split(".")).shift();do 0===g.length?l[b]=e:(b in l||(l[b]={}),l=l[b]);while(b=g.shift())}return e}var w=r.document,K=w.documentElement,J=(new Date).getTime(),L=Object.prototype.toString,E=Object.defineProperty,I=Object.prototype.hasOwnProperty,F=w.getElementsByTagName("script"),G=(F[F.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,""),v=eval("/*@cc_on (@_jscript_version+'').replace(/\\d\\./, '');@*/"),D=(E||Object.prototype.__defineGetter__)&&
(!v||8<v)?0:1,M=!{toString:1}.propertyIsEnumerable("toString"),t,A,H,x={},y="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");d.classByName=A=function(e,n,f){var a,c=e,j=n=n||d.defaultContext||d;if("string"===typeof c){for(c=c.split(".");(a=c.shift())&&(j=j[a]););c=j}if(!c&&f&&!("function"===typeof d.autoload&&(c=d.autoload.call(n,e,f)||A(e,n))))throw Error("Parent class '"+e+"' not Initialized or Undefined");return c};d.ownEach=t=function(e,
d,f){var a,c,j=y.length;if("[object Array]"===L.call(e)){j=e.length;for(a=0;a<j&&!(c=e[a],d.call(e[a],f?c:a,f?a:c)===o);a++);}else{for(a in e)if(c=e[a],(f&&c!==Object.prototype[a]||I.call(e,a))&&d.call(c,a,c)===o){j=o;break}if(j&&M)for(a=0;a<j&&!(c=e[y[a]],(I.call(e,y[a])||f&&c!=p&&c!==Object.prototype[y[a]])&&d.call(c,y[a],c)===o);a++);}};d.instanceOf=function(e,d){for(;e&&e.Class!=p;){if(e.Class===d)return s;e=e.parent}return o};d.absoluteURL=H=function(e){return function(d,f){f&&!/^(?:https?:)?\/[\/]?/.test(d)&&
(d=("string"===typeof f?f:G)+d);var f=r.location,a,c=f.pathname,d=/^(?:[a-z]+\:)?\/\//.test(d)?d:f.protocol+"//"+f.host+(0===d.indexOf("/")?d:0===d.indexOf("?")?c+d:0===d.indexOf("#")?c+f.search+d:c.replace(/[^\/]+$/g,"")+d);e.href=d;a=e.protocol;c=e.pathname;d=(":"===a?f.protocol:a)+"//";d="http:"===a&&80==e.port||"https:"===a&&443==e.port?d+e.hostname:d+e.host;return d+(0===c.indexOf("/")?c:"/"+c)+e.search+e.hash}}(w.createElement("A"));d.imports=function(){function e(b,a){if(d.imports.onerror)d.imports.onerror(b,
a);else throw Error(404==b?"Module "+a+" not found":'Error executing module "'+a+'".');}function n(b,a,c,e){if(b in x)c(b);else{var f=b+(0<b.indexOf("?")?"&":"?")+(new Date).getTime(),i=new XMLHttpRequest;i.open("GET",d.imports.disableCaching?f:b,a);i.onreadystatechange=function(){if(4===i.readyState){var a=1223===i.status?204:0===i.status&&"file:"==(self.location||{}).protocol?200:i.status;if(200<=a&&300>a||304===a){try{(r.execScript||function(a){r.eval.call(r,a)})(i.responseText+(!v?"\n//@ sourceURL="+
b:""))}catch(d){return e(a,b)}c(b)}else e(a,b)}};i.send(p)}}function f(b){function c(){var a;if(k){k.onload=k.onreadystatechange=k.onerror=p;k.parentNode.removeChild(k);for(a in k)try{k[a]=p,delete k[a]}catch(b){}k=p}}function j(c,g){b.b&&b.b.call(b.scope||d,c,g)?0===a[0].scripts.length&&a.shift():(b.b||e(c,g),a.shift());f()}function g(c){if(!i){i=s;for(x[c]=1;a.length&&0===a[0].scripts.length;)b=a.shift(),b.c&&b.c.call(b.scope||d);f()}}if(b){if(a.unshift(b),1<a.length)return}else if(0===a.length)return;
var b=a[0],k,i=o,m=b.scripts.shift();b.d&&v&&9>v?n(m,s,g,j):m in x?g(m):(k=w.createElement("script"),k.type="text/javascript",k.onerror=function(){c();j(404,m)},"onload"in k||!("readyState"in k)?k.onload=function(){c();g(m)}:k.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)c(),g(m)},k.src=m+(d.imports.disableCaching?(0<m.indexOf("?")?"&":"?")+(new Date).getTime():""),K.firstChild.appendChild(k))}var a=[],c=RegExp("^((?:"+location.protocol+")?//"+location.host+
"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),j=o;try{w.querySelectorAll("html:not(a)"),j=s}catch(t){}return function(a,l,q,g){for(var a=("string"===typeof a?[a]:a)||[],k=0,i,m=s,r=!!l,u=a.length,t={},v=j?w.querySelectorAll('script[src]:not([data-calmjs="1"])'):F;i=v[k++];)if(i.setAttribute("data-calmjs","1"),i=i.getAttribute("src"))x[H(i,G)]=1;for(;u--;){if(!c.test(a[u]=H(a[u],G)))m=o;a[u]in x||a[u]in t?a.splice(u,1):t[a[u]]=1}if(0===a.length)return l&&l.call(g||d);if(m&&!r){for(;i=a.shift();){n(i,o,
function(a){x[a]=1;m=o},function(a,b){q&&q.call(g||d,a,b)?m=o:q||e(a,b)});if(m)return;m=s}return l&&l.call(g||d)}f({scope:g||d,d:m,scripts:a,c:l||p,b:q||p})}}();t(["classByName","ownEach","instanceOf","absoluteURL","imports"],function(e,n){d[n].toString=d.toString=function(){return"[object Function]"}});D&&!("execVBscript"in r)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");
r.Class=d})(window,!0,!1,null);
