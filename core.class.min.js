/*
 * core.class.js Library for JavaScript v0.4.1
 *
 * Copyright 2012, Dmitriy Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 21-07-2012
 */
(function(s,u,p,o,C){function f(c,b,d,a,e){function t(){var a=0===+this,b=arguments,m=new e,g=m,j=a?b[0]:{a:m};m.parent=o;if(d){if("string"===typeof d&&!(d=r(c,g=d)||"function"===typeof f.autoload&&f.autoload.call(c,g)||r(c,g)))throw Error("Parent class '"+g+"' not Initialized or Undefined");m.parent=d.call(p,j);var z=function(){};z.prototype=m.parent;g=new z}else g.shared={};if(d||a)f.ownEach(m,function(a,b){"function"===typeof b?(g[a]=function(){var a=j.a.parent,i=j.a.Class;j.a.parent=m.parent;
j.a.Class=g.Class;var c=b.apply(this===g||this==s?j.a:this,arguments);j.a.Class=i;j.a.parent=a;return c},g[a].toString=function(){return b.toString()}):g[a]=b}),j.a=a?j.a:g;g.Class=t;if(!a&&0!==h)if(A){if(v){if(k===p){k="StaticClass"+E+A++;var y=[],u=0,q=["Class "+k];f.ownEach(g,function(a){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:"toString"===a?4:0;if(b){var i=4===b?"("+a+")":(u=1)&&1===b?a.substring(1):a.split(" ").pop();if(1===b||2===b||4===b)q.push("Public "+
(4===b?"Default ":"")+"Property Get ["+i+"]","Call VBCorrectVal("+(1===b?g.__get?'me.[__get].call(me,"'+i+'")':"":g[a]?"me.["+a+"].call(me)":"")+",["+i+"])","End Property");if(1===b||3===b)q.push("Public Property Let ["+i+"](val)",1===b?g.__set?'Call me.[__set].call(me,"'+i+'",val)':"":g[a]?"Call me.["+a+"].call(me,val)":"","End Property","Public Property Set ["+i+"](val)",1===b?g.__set?'Call me.[__set].call(me,"'+i+'",val)':"":g[a]?"Call me.["+a+"].call(me,val)":"","End Property")}if(!b||1<b)50===
y.length&&(q.push("Public ["+y.join("],[")+"]"),y.length=0),y[y.length]=a,h[h.length]=a},1);u?(q.push("Public ["+y.join("],[")+"]","End Class","Function "+k+"Factory()","Set "+k+"Factory=New "+k,"End Function"),execVBScript(q.join("\n"))):(h=0,k=o);y=q=o}if(k){j.a=s[k+"Factory"]();for(z=h.length;n=h[--z];)j.a[n]=g[n];g=j.a}}}else if(f.ownEach(l?g:h,function(a){var b=0===a.indexOf("$")?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:0;if(b){l&&(h[h.length]=a);var c=1===b?a.substring(1):a.split(" ").pop(),
d={enumerable:1,configurable:1,set:o,get:o};if(1===b||2===b)d.get=function(){return(g[1===b?"__get":a]||i).call(this,1===b?c:C)};if(1===b||3===b)d.set=function(d){(g[1===b?"__set":a]||i).call(this,1===b?c:d,1===b?d:C)};if(Object.defineProperty){var e=Object.getOwnPropertyDescriptor(g,c);d.get=d.get||e&&e.get||i;d.set=d.set||e&&e.set||i;Object.defineProperty(g,c,d)}else(1===b||2===b)&&g.__defineGetter__(c,d.get),(1===b||3===b)&&g.__defineSetter__(c,d.set)}},1),l&&!(l=0)&&0===h.length)h=0;return new (a?
function(){return g}:function(){g.constructor&&g.constructor!==Object.prototype.constructor&&g.constructor.apply(g,b);return g})}function r(a,b){for(var i,b=b.split(".");(i=b.shift())&&(a=a[i]););return a}function i(){}var n,m=[],j,l=1,h=[],k=p;if(3>arguments.length||"string"===typeof c||"function"===typeof c&&"object"===typeof b)e=a,a=d,d=b,b=c,c=f;"string"===typeof b?(m=b.replace(/^[\s]+|[\s](?=\s)|[\s]+$/g,"").split(" "),j=m[0]&&"extends"!==m[0]&&m.shift()||0):(e=a,a=d,d=b,b=o);e||((e=a)?"object"===
typeof d?(a=d,d=o):a=o:(e=d,d=a=o));"string"===typeof d&&(n=d);if(e&&(n||"extends"===m.shift()||"function"===typeof b))d=(n||(n=m.shift()))&&!(b=r(c,n))?n:b;if("function"!==typeof e)var z=e,e=function(){return z};t.toString=function(){return"[class "+(j||"Object")+"]"};a&&f.ownEach(a,function(b){t[b]=a[b]});if(j){n=c;t.className=j;b=(m=j.split(".")).shift();do 0===m.length?n[b]=t:(b in n||(n[b]={}),n=n[b]);while(b=m.shift())}return t}var r=s.document,F=r.documentElement,v=eval("/*@cc_on (@_jscript_version+'').replace(/\\d\\./, '');@*/"),
E=(new Date).getTime(),A=(Object.defineProperty||Object.prototype.__defineGetter__)&&(!v||8<v)?0:1,q={},D=Object.prototype.hasOwnProperty,G=Object.prototype.toString,H=!{toString:o}.propertyIsEnumerable("toString"),w="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(","),B=function(){A&&!("execVBscript"in s)&&execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript");var c=r.getElementsByTagName("script");return(c[c.length-1]||{src:"/"}).src.replace(/[^\/]+$/g,"")}();f.ownEach=function(c,b,d){var a,e,f=w.length;if("[object Array]"===G.call(c)){f=c.length;for(a=0;a<f&&!(e=c[a],b.call(c[a],d?e:a,d?a:e)===p);a++);}else{for(a in c)if(e=c[a],(d&&e!==Object.prototype[a]||D.call(c,a))&&b.call(e,a,e)===p){f=p;break}if(f&&H)for(a=0;a<f&&!(e=c[w[a]],(D.call(c,w[a])||d&&e!=o&&e!==Object.prototype[w[a]])&&b.call(e,w[a],e)===p);a++);}};f.instanceOf=function(c,
b){for(;c&&c.Class!=o;){if(c.Class===b)return u;c=c.parent}return p};f.absoluteURL=function(c){return function(b,d){d&&!/^(?:https?:)?\/[\/]?/.test(b)&&(b=("string"===typeof d?d:B)+b);var d=s.location,a,e=d.pathname,b=/^(?:[a-z]+\:)?\/\//.test(b)?b:d.protocol+"//"+d.host+(0===b.indexOf("/")?b:0===b.indexOf("?")?e+b:0===b.indexOf("#")?e+d.search+b:e.replace(/[^\/]+$/g,"")+b);c.href=b;a=c.protocol;e=c.pathname;b=(":"===a?d.protocol:a)+"//";b="http:"===a&&80==c.port||"https:"===a&&443==c.port?b+c.hostname:
b+c.host;return b+(0===e.indexOf("/")?e:"/"+e)+c.search+c.hash}}(r.createElement("A"));f.imports=function(){function c(b,a){if(f.imports.onerror)f.imports.onerror(b,a);else throw Error(404==b?"Module "+a+" not found":'Error executing module "'+a+'".');}function b(b,a,c,d){if(b in q)c(b);else{var e=b+(0<b.indexOf("?")?"&":"?")+(new Date).getTime(),h=new XMLHttpRequest;h.open("GET",f.imports.disableCaching?e:b,a);h.onreadystatechange=function(){if(4===h.readyState){var a=1223===h.status?204:0===h.status&&
"file:"==(self.location||{}).protocol?200:h.status;if(200<=a&&300>a||304===a){try{(s.execScript||function(b){s.eval.call(s,b)})(h.responseText+(!v?"\n//@ sourceURL="+b:""))}catch(e){return d(a,b)}c(b)}else d(a,b)}};h.send(o)}}function d(i){function e(){var b;if(l){l.onload=l.onreadystatechange=l.onerror=o;l.parentNode.removeChild(l);for(b in l)try{l[b]=o,delete l[b]}catch(a){}l=o}}function m(b,e){i.b&&i.b.call(i.scope||f,b,e)?0===a[0].scripts.length&&a.shift():(i.b||c(b,e),a.shift());d()}function j(b){if(!h){h=
u;for(q[b]=1;a.length&&0===a[0].scripts.length;)i=a.shift(),i.c&&i.c.call(i.scope||f);d()}}if(i){if(a.unshift(i),1<a.length)return}else if(0===a.length)return;var i=a[0],l,h=p,k=i.scripts.shift();i.d&&v&&9>v?b(k,u,j,m):k in q?j(k):(l=r.createElement("script"),l.type="text/javascript",l.onerror=function(){e();m(404,k)},"onload"in l||!("readyState"in l)?l.onload=function(){e();j(k)}:l.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)e(),j(k)},l.src=k+(f.imports.disableCaching?
(0<k.indexOf("?")?"&":"?")+(new Date).getTime():""),(F.firstChild||r.getElementsByTagName("head")[0]).appendChild(l))}var a=[],e=RegExp("^((?:"+location.protocol+")?//"+location.host+"(?:/|$)|/[^/]|(?!(?:https?:)?//))","i"),t;a:{try{r.querySelectorAll("html:not(a)");t=u;break a}catch(w){}t=p}return function(a,n,m,j){for(var a="string"===typeof a?[a]:a,l=0,h,k=u,s=!!n,x=a.length,v={},w=t?r.querySelectorAll('script[src]:not([data-calmjs="1"])'):r.getElementsByTagName("script");h=w[l++];)if(h.setAttribute("data-calmjs",
"1"),h=h.getAttribute("src"))q[f.absoluteURL(h,B)]=1;for(;x--;){if(!e.test(a[x]=f.absoluteURL(a[x],B)))k=p;a[x]in q||a[x]in v?a.splice(x,1):v[a[x]]=1}if(0===a.length)return n&&n.call(j||f);if(k&&!s){for(;h=a.shift();){b(h,p,function(a){q[a]=1;k=p},function(a,b){m&&m.call(j||f,a,b)?k=p:m||c(a,b)});if(k)return;k=u}return n&&n.call(j||f)}d({scope:j||f,d:k,scripts:a,c:n||o,b:m||o})}}();f.ownEach.toString=f.instanceOf.toString=f.absoluteURL.toString=f.imports.toString=f.toString=function(){return"[object Function]"};
s.Class=f})(window,!0,!1,null);
