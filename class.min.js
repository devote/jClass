/*
 * Class definition for JavaScript v1.0.0
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 21-03-2013
 */
(function(h,H,q,t,I){function K(b,e){return function(){throw Error("'"+b+"' property is "+(e?"read":"write")+"-only");}}function u(){}function D(b,e,i,a,A){function g(){for(var a=E,c=this instanceof L,e=arguments,j=t,k=new A,l=c&&e[2]||t,f=l||k,m=c?e[0]:{a:k},n=!c||e[1]===I||F!==I?F:e[1];a--;)"string"===typeof i[a]&&(i[a]=O(i[a],b)),u.prototype=j=i[a].call(new L,m,n,l),0<a&&(m.i=t),f=l=new u;if(E||c){var p=function(a){return"function"===typeof a?function(){var d=m.a,b=d.parent,c=d.__class__;d.parent=
j;d.__class__=g;var e=a.apply(this===f||this==h?d:this,arguments);d.parent=b;d.__class__=c;return e}:a};B(k,function(a,d){if(d&&"object"===typeof d&&("set"in d&&(d.set=p(d.set)),"get"in d))d.get=p(d.get);f[a]=p(d)});m.a=c?m.a:f}n||(f.__class__=g,f.parent=j);if(!c&&0!==w){if(!x||y)B(y?f:w,function(a){var d=f[a],b=a,c=!y?w[a]:d&&typeof d==="object"&&a!=="parent"&&(d.set||d.get)?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:x&&a==="toString"?4:0;if(c){y&&(w[a]=c)!==4&&q++;if(c===1){u.prototype=d;
d=new u}else b=a.split(" ").pop();if(x){c!==3&&o.push("Public "+(c===4?"Default ":"")+"Property Get ["+b+"]","Call VBCorrectVal("+(d&&(c!==1||d.get)?"[(accessors)].["+a+"]"+(c===1?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+",["+b+"])","End Property");c!==2&&o.push("Public Property Let ["+b+"](val)",c=(c===4?"Set [(accessors)].["+a+"]=val":d&&(c!==1||d.set)?"Call [(accessors)].["+a+"]"+(c===1?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+
b+"](val)",c)}else{var e=function(a){((c===1?d.set:d)||K(b,1)).call(this,a,d)},g=function(){return((c===1?d.get:d)||K(b,0)).call(this,d)};C.call(f,a)&&delete f[a];if(J){a=z.getOwnPropertyDescriptor(f,b);J(f,b,{enumerable:1,configurable:1,set:c===2&&a&&a.set||e,get:c===3&&a&&a.get||g})}else{f.__defineSetter__(b,c===2&&f.__lookupSetter__(b)||e);f.__defineGetter__(b,c===3&&f.__lookupGetter__(b)||g)}}}else if(x){if(s.length===50){o.push("Public ["+s.join("],[")+"]");s.length=0}s[s.length]=a}},y);y&&!(y=
0)&&0===q?s=o=w=0:x&&(q&&(v="StaticClass"+P+x++,o.unshift("Class "+v),o.push((s.length?"Public ["+s.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+v+"FactoryJS()","End Sub","End Class","Function "+v+"Factory()","Set "+v+"Factory=New "+v,"End Function"),h[v+"FactoryJS"]=function(){return o},h.execVBScript(o.join("\n")),q=s=o=t),o={},m.a=h[v+"Factory"](),B(f,function(a,b){if(w.hasOwnProperty(a))if(w[a]===1){u.prototype=f[a];o[a]=new u}else o[a]=f[a];
else m.a[a]=(!E||n)&&typeof b==="function"&&a!=="__class__"?function(){return b.apply(this===f||this==h?m.a:this,arguments)}:b},1),f=m.a)}C.call(f,r)?m.i=f[r]:C.call(f,"constructor")&&(m.i=f.constructor);return new function(){!c&&typeof m.i==="function"&&m.i.apply(f,e);return f}}var k,n,p,y=1,c=arguments,j=c.length-1,r="constructor",v=t,o=[],s=[],q=0,w=x===t?0:{},l,M,F,E,H=this instanceof D,A=c[j--]||{},a=!c[j]||c[j]instanceof G||"object"!==typeof c[j]?{}:c[j--];k=a.context;n=a.extend;p=a.mixins;
F=a.compact;M=a.statics||(k||n||p||F!==I?{}:a);i=c[j]instanceof G?c[j--]:"function"===typeof c[j]?[c[j--]]:"string"===typeof c[j-1]&&(""+c[j--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];l="string"===typeof c[j]&&c[j--].split(/extends|implements|,/g)||[];b=c[j--]||k||D.defaultContext||h;e=(l.shift()||"").replace(/^\s+|\s+$/g,"");k=(l=l.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?l.split(","):
[];n=(n=n||[])instanceof G?n:[n];p=(p=p||[])instanceof G?p:[p];i=k.concat.apply(k,i.concat.apply(i,n.concat.apply(n,p)));E=i.length;if("function"!==typeof A)var N=A,A=function(){u.prototype=N.constructor.prototype;l=new u;B(N,function(a,b){l[a]=b});return l};g.toString=function(){return"[class "+(e||"Object")+"]"};B(M,function(a,b){g[a]=b});if(g.className=e){k=b;c=(l=e.split(".")).shift();do 0===l.length?k[r=c]=g:(c in k||(k[c]={}),k=k[c]);while(c=l.shift())}return H?new g:g}function O(b,e){var i,
a=b;if("string"===typeof b){for(a=b.split(".");(i=a.shift())&&(e=e[i]););a=e}if("function"!==typeof a)throw Error("Parent class '"+b+"' not Initialized or Undefined");return a}function B(b,e,i){var a=0,h=r.length,g;if("[object Array]"===Q.call(b))for(h=b.length;a<h&&!(g=b[a],e.call(g,i?g:a,i?a:g)===q);a++);else{for(a in b)if(g=b[a],(i&&g!==z.prototype[a]||C.call(b,a))&&e.call(g,a,g)===q){h=q;break}if(h&&R)for(a=0;a<h&&!(g=b[r[a]],(C.call(b,r[a])||i&&r[a]in b&&g!==z.prototype[r[a]])&&e.call(g,r[a],
g)===q);a++);}}var G=h.Array,z=h.Object,L=h.Boolean,Q=z.prototype.toString,J=z.defineProperty,C=z.prototype.hasOwnProperty,P=(new Date).getTime(),R=!{toString:1}.propertyIsEnumerable("toString"),r="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");D.instanceOf=function(b,e){for(;b&&b.__class__!=t;){if(b.__class__===e)return H;b=b.parent}return q};var x=function(b){function e(a){b=a}try{J(b,"t",{set:e})}catch(i){try{b.__defineSetter__("t",e)}catch(a){}}b.t=
0;b&&(b=1,"execVBscript"in h||("execScript"in h?h.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"):b=t));return b}({});h.Class=D})(window,!0,!1,null);
