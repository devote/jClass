/*
 * Class definition for JavaScript v1.0.1
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 11-04-2013
 */
(function(h,N,q,r,K){function O(d,f){return function(){throw Error("'"+d+"' property is "+(f?"read":"write")+"-only");}}function t(){}function H(d,f,j,a,B){function g(){for(var b=I,a=this instanceof P,c=arguments,f=r,k=new B,l=a&&c[2]||r,e=L||l||k,m=a?c[0]:{a:k},i=!a||c[1]===K||z!==K?z:c[1];b--;)"string"===typeof j[b]&&(j[b]=S(j[b],d)),t.prototype=f=j[b].call(new P,m,i,l),0<b&&(m.i=r),e=l=new t;if(I||a||L){var o=function(b){return"function"===typeof b?function(){var v=m.a,a=v.parent,d=v.__class__;
!i&&(v.parent=f);!i&&(v.__class__=g);var c=b.apply(this===e||this==h?v:this,arguments);!i&&(v.parent=a);!i&&(v.__class__=d);return c}:b};C(k,function(b,a){if(a&&"object"===typeof a&&("set"in a&&(a.set=o(a.set)),"get"in a))a.get=o(a.get);e[b]=o(a)});m.a=a?m.a:e}i||(e.__class__=g,e.parent=f);if(!a&&0!==w){if(!x||y)C(y?e:w,function(a){var b=e[a],d=a,c=!y?w[a]:b&&typeof b==="object"&&a!=="parent"&&(b.set||b.get)?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:x&&a==="toString"?4:0;if(c){y&&(w[a]=c)!==
4&&q++;if(c===1){t.prototype=b;b=new t}else d=a.split(" ").pop();if(x){c!==3&&n.push("Public "+(c===4?"Default ":"")+"Property Get ["+d+"]","Call VBCorrectVal("+(b&&(c!==1||b.get)?"[(accessors)].["+a+"]"+(c===1?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+",["+d+"])","End Property");c!==2&&n.push("Public Property Let ["+d+"](val)",c=(c===4?"Set [(accessors)].["+a+"]=val":b&&(c!==1||b.set)?"Call [(accessors)].["+a+"]"+(c===1?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+
"\nEnd Property","Public Property Set ["+d+"](val)",c)}else{var f=function(a){((c===1?b.set:b)||O(d,1)).call(this,a,b)},g=function(){return((c===1?b.get:b)||O(d,0)).call(this,b)};D.call(e,a)&&delete e[a];if(E){a=A.getOwnPropertyDescriptor(e,d);E(e,d,{enumerable:F?0:1,configurable:1,set:c===2&&a&&a.set||f,get:c===3&&a&&a.get||g})}else{e.__defineSetter__(d,c===2&&e.__lookupSetter__(d)||f);e.__defineGetter__(d,c===3&&e.__lookupGetter__(d)||g)}}}else if(x){if(s.length===50){n.push("Public ["+s.join("],[")+
"]");s.length=0}s[s.length]=a}},y);y&&!(y=0)&&0===q?s=n=w=0:x&&(q&&(u="StaticClass"+J+F++,n.unshift("Class "+u),n.push((s.length?"Public ["+s.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+u+"FactoryJS()","End Sub","End Class","Function "+u+"Factory()","Set "+u+"Factory=New "+u,"End Function"),h[u+"FactoryJS"]=function(){return n},h.execVBScript(n.join("\n")),q=s=n=r),n={},m.a=h[u+"Factory"](),C(e,function(a,b){if(w.hasOwnProperty(a))if(w[a]===
1){t.prototype=e[a];n[a]=new t}else n[a]=e[a];else m.a[a]=(!I||i)&&typeof b==="function"&&a!=="__class__"?function(){return b.apply(this===e||this==h?m.a:this,arguments)}:b},1),e=m.a)}D.call(e,p)?m.i=e[p]:D.call(e,"constructor")&&(m.i=e.constructor);return new function(){!a&&typeof m.i==="function"&&m.i.apply(e,c);return e}}var k,i,o,x=F,y=1,b=arguments,c=b.length-1,p="constructor",u=r,n=[],s=[],q=0,w=F===r?0:{},L,l,Q,z,I,M=this instanceof H,B=b[c--]||{};if(b[c]&&"object"===typeof b[c]&&!(b[c]instanceof
G)&&b[c].constructor&&b[c].constructor!==A.prototype.constructor){if(F&&E)try{E(b[c],"t"+J,{configurable:1,set:function(a){x=a}}),b[c]["t"+J]=0,delete b[c]["t"+J]}catch(T){}L=x?r:(z=N,b[c--])}a=!b[c]||b[c]instanceof G||"object"!==typeof b[c]?{}:b[c--];z=z||a.compact;k=a.context;i=a.extend;o=a.mixins;Q=a.statics||(k||i||o||z!==K?{}:a);j=b[c]instanceof G?b[c--]:"function"===typeof b[c]?[b[c--]]:"string"===typeof b[c-1]&&(""+b[c--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,
"").replace(/\s*,\s*/g,",").split(",")||[];l="string"===typeof b[c]&&b[c--].split(/extends|implements|,/g)||[];d=b[c--]||k||H.defaultContext||h;f=(l.shift()||"").replace(/^\s+|\s+$/g,"");k=(l=l.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?l.split(","):[];i=(i=i||[])instanceof G?i:[i];o=(o=o||[])instanceof G?o:[o];j=k.concat.apply(k,j.concat.apply(j,i.concat.apply(i,o)));I=j.length;if("function"!==typeof B)var R=B,B=function(){t.prototype=R.constructor.prototype;l=new t;C(R,function(a,
b){l[a]=b});return l};g.toString=function(){return"[class "+(f||"Object")+"]"};C(Q,function(a,b){g[a]=b});if(g.className=f){k=d;b=(l=f.split(".")).shift();do 0===l.length?k[p=b]=g:(b in k||(k[b]={}),k=k[b]);while(b=l.shift())}return M?new g:g}function S(d,f){var j,a=d;if("string"===typeof d){for(a=d.split(".");(j=a.shift())&&(f=f[j]););a=f}if("function"!==typeof a)throw Error("Parent class '"+d+"' not Initialized or Undefined");return a}function C(d,f,j){var a,h=p.length,g;for(a in d)if(g=d[a],(j&&
g!==A.prototype[a]||D.call(d,a))&&f.call(g,a,g)===q){h=q;break}if(h&&M)for(a=0;a<h&&!(g=d[p[a]],(D.call(d,p[a])||j&&p[a]in d&&g!==A.prototype[p[a]])&&f.call(g,p[a],g)===q);a++);}var G=h.Array,A=h.Object,P=h.Boolean,E=A.defineProperty,D=A.prototype.hasOwnProperty,J=(new Date).getTime(),M=!{toString:1}.propertyIsEnumerable("toString"),p="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");H.instanceOf=function(d,f){for(;d&&d.__class__!=r;){if(d.__class__===
f)return N;d=d.parent}return q};var F=function(d){function f(a){d=a}try{E(d,"t",{set:f})}catch(j){try{d.__defineSetter__("t",f)}catch(a){}}d.t=0;d&&(d=1,"execVBscript"in h||("execScript"in h?h.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"):d=r));return d}({});h.Class=H})(window,!0,!1,null);
