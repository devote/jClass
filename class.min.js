/*
 * jClass - class definition for JavaScript v1.1.0
 *
 * Copyright 2012-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 11-04-2013
 */
(function(e,P,s,p,L){function Q(e,c){return function(){throw Error("'"+e+"' property is "+(c?"read":"write")+"-only");}}function t(){}function T(e,c){var q,b=e;if("string"===typeof e){for(b=e.split(".");(q=b.shift())&&(c=c[q]););b=c}if("function"!==typeof b)throw Error("Parent class '"+e+"' not Initialized or Undefined");return b}function A(e,c,q){var b,l=k.length,h;for(b in e)if(h=e[b],(q&&h!==B.prototype[b]||D.call(e,b))&&c.call(h,b,h)===s){l=s;break}if(l&&M)for(b=0;b<l&&!(h=e[k[b]],(D.call(e,k[b])||
q&&k[b]in e&&h!==B.prototype[k[b]])&&c.call(h,k[b],h)===s);b++);}var E=e.Array,B=e.Object,R=e.Boolean,F=B.defineProperty,D=B.prototype.hasOwnProperty,I=(new Date).getTime(),M=!{toString:1}.propertyIsEnumerable("toString"),k="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");e.jClass=function c(q,b,l,h,k){function u(){var a=J,c=this instanceof R,b=arguments,f=p,h=new k,j=c&&b[2]||p,g=N||j||h,m=c?b[0]:{a:h},i=!c||b[1]===L||C!==L?C:b[1];for(A(O,
function(G,d){h[G]=d});a--;)"string"===typeof l[a]&&(l[a]=T(l[a],q)),t.prototype=f=l[a].call(new R,m,i,j),0<a&&(m.i=p),g=j=new t;if(J||c||N){var n=function(G){return"function"===typeof G?function(){var d=m.a,a=d.parent,c=d.__class__;!i&&(d.parent=f);!i&&(d.__class__=u);var b=G.apply(this===g||this==e?d:this,arguments);!i&&(d.parent=a);!i&&(d.__class__=c);return b}:G};A(h,function(a,d){if(d&&"object"===typeof d&&("set"in d&&(d.set=n(d.set)),"get"in d))d.get=n(d.get);g[a]=n(d)});m.a=c?m.a:g}i||(g.__class__=
u,g.parent=f);if(!c&&0!==x){if(!y||z)A(z?g:x,function(a){var d=g[a],c=a,b=!z?x[a]:d&&typeof d==="object"&&a!=="parent"&&(d.set||d.get)?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:y&&a==="toString"?4:0;if(b){z&&(x[a]=b)!==4&&K++;if(b===1){t.prototype=d;d=new t}else c=a.split(" ").pop();if(y){b!==3&&o.push("Public "+(b===4?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(d&&(b!==1||d.get)?"[(accessors)].["+a+"]"+(b===1?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+
",["+c+"])","End Property");b!==2&&o.push("Public Property Let ["+c+"](val)",b=(b===4?"Set [(accessors)].["+a+"]=val":d&&(b!==1||d.set)?"Call [(accessors)].["+a+"]"+(b===1?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+c+"](val)",b)}else{var e=function(a){((b===1?d.set:d)||Q(c,1)).call(this,a,d)},f=function(){return((b===1?d.get:d)||Q(c,0)).call(this,d)};D.call(g,a)&&delete g[a];if(F){a=B.getOwnPropertyDescriptor(g,c);F(g,c,{enumerable:H?0:1,configurable:1,
set:b===2&&a&&a.set||e,get:b===3&&a&&a.get||f})}else{g.__defineSetter__(c,b===2&&g.__lookupSetter__(c)||e);g.__defineGetter__(c,b===3&&g.__lookupGetter__(c)||f)}}}else if(y){if(r.length===50){o.push("Public ["+r.join("],[")+"]");r.length=0}r[r.length]=a}},z);z&&!(z=0)&&0===K?r=o=x=0:y&&(K&&(v="StaticClass"+I+H++,o.unshift("Class "+v),o.push((r.length?"Public ["+r.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+v+"FactoryJS()","End Sub","End Class",
"Function "+v+"Factory()","Set "+v+"Factory=New "+v,"End Function"),e[v+"FactoryJS"]=function(){return o},e.execVBScript(o.join("\n")),K=r=o=p),o={},m.a=e[v+"Factory"](),A(g,function(a,b){if(x.hasOwnProperty(a))if(x[a]===1){t.prototype=g[a];o[a]=new t}else o[a]=g[a];else m.a[a]=(!J||i)&&typeof b==="function"&&a!=="__class__"?function(){return b.apply(this===g||this==e?m.a:this,arguments)}:b},1),g=m.a)}D.call(g,s)?m.i=g[s]:D.call(g,"constructor")&&(m.i=g.constructor);return new function(){!c&&typeof m.i===
"function"&&m.i.apply(g,b);return g}}var j,n,w,y=H,z=1,a=arguments,f=a.length-1,s="constructor",v=p,o=[],r=[],K=0,x=H===p?0:{},N,i,O,C,J,M=this instanceof c,k=a[f--]||{};if(a[f]&&"object"===typeof a[f]&&!(a[f]instanceof E)&&a[f].constructor&&a[f].constructor!==B.prototype.constructor){if(H&&F)try{F(a[f],"t"+I,{configurable:1,set:function(a){y=a}}),a[f]["t"+I]=0,delete a[f]["t"+I]}catch(U){}N=y?p:(C=P,a[f--])}h=!a[f]||a[f]instanceof E||"object"!==typeof a[f]?{}:a[f--];C=C||h.compact;j=h.context;n=
h.extend;w=h.mixins;O=h.statics||(j||n||w||C!==L?{}:h);l=a[f]instanceof E?a[f--]:"function"===typeof a[f]?[a[f--]]:"string"===typeof a[f-1]&&(""+a[f--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];i="string"===typeof a[f]&&a[f--].split(/extends|implements|,/g)||[];q=a[f--]||j||c.NS||(c.NS=e);b=(i.shift()||"").replace(/^\s+|\s+$/g,"");j=(i=i.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?i.split(","):
[];n=(n=n||[])instanceof E?n:[n];w=(w=w||[])instanceof E?w:[w];l=j.concat.apply(j,l.concat.apply(l,n.concat.apply(n,w)));J=l.length;if("function"!==typeof k)var S=k,k=function(){t.prototype=S.constructor.prototype;i=new t;A(S,function(a,b){i[a]=b});return i};u.toString=function(){return"[class "+(b||"Object")+"]"};A(O,function(a,b){u[a]=b});if(u.className=b){j=q;a=(i=b.split(".")).shift();do 0===i.length?j[s=a]=u:(a in j||(j[a]={}),j=j[a]);while(a=i.shift())}return M?new u:u};jClass.instanceOf=function(c,
e){for(;c&&c.__class__!=p;){if(c.__class__===e)return P;c=c.parent}return s};var H=function(c){function k(b){c=b}try{F(c,"t",{set:k})}catch(b){try{c.__defineSetter__("t",k)}catch(l){}}c.t=0;c&&(c=1,"execVBscript"in e||("execScript"in e?e.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"):c=p));return c}({});jClass.NS=jClass.NS||e})(window,!0,!1,null);
