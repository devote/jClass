/*
 * jClass - class definition for JavaScript v1.2.0
 *
 * Copyright 2012-2014, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 03/12/2014
 */
(function(c,N,r,o,J){function O(c,a){return function(){throw Error("'"+c+"' property is "+(a?"read":"write")+"-only");}}function s(){}function R(c,a){var p,d=c;if("string"===typeof c){for(d=c.split(".");(p=d.shift())&&(a=a[p]););d=a}if("function"!==typeof d)throw Error("Parent class '"+c+"' not Initialized or Undefined");return d}function z(c,a,p){var d,k=j.length,g;for(d in c)if(g=c[d],(p&&g!==A.prototype[d]||C.call(c,d))&&a.call(g,d,g)===r){k=r;break}if(k&&K)for(d=0;d<k&&!(g=c[j[d]],(C.call(c,j[d])||
p&&j[d]in c&&g!==A.prototype[j[d]])&&a.call(g,j[d],g)===r);d++);}var D=c.Array,A=c.Object,P=c.Boolean,E=A.defineProperty,C=A.prototype.hasOwnProperty,G=(new Date).getTime(),K=!{toString:1}.propertyIsEnumerable("toString"),j="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");c.jClass=function a(p,d,k,g,j){function v(){var b=H,a=this instanceof P,d=arguments,e=o,g=new j,i=a&&d[2]||o,f=L||i||g,l=a?d[0]:{a:g},h=!a||d[1]===J||B!==J?B:d[1];for(z(M,
function(S,b){g[S]=b});b--;)"string"===typeof k[b]&&(k[b]=R(k[b],p)),s.prototype=e=k[b].call(new P,l,h,i),0<b&&(l.i=o),f=i=new s;if(H||a||L){var m=function(b){return"function"===typeof b?function(){var a=l.a,d=a.parent;!h&&(a.parent=e);var g=b.apply(this===f||this==c?a:this,arguments);!h&&(a.parent=d);return g}:b};z(g,function(b,a){if(a&&"object"===typeof a&&("set"in a&&(a.set=m(a.set)),"get"in a))a.get=m(a.get);f[b]=m(a)});l.a=a?l.a:f}h||(f.__class__=v,f.parent=e);if(!a&&0!==w){if(!x||y)z(y?f:w,
function(a){var b=f[a],d=a,c=!y?w[a]:b&&typeof b==="object"&&a!=="parent"&&(b.set||b.get)?1:a.indexOf("get ")===0?2:a.indexOf("set ")===0?3:x&&a==="toString"?4:0;if(c){y&&(w[a]=c)!==4&&I++;if(c===1){s.prototype=b;b=new s}else d=a.split(" ").pop();if(x){c!==3&&n.push("Public "+(c===4?"Default ":"")+"Property Get ["+d+"]","Call VBCorrectVal("+(b&&(c!==1||b.get)?"[(accessors)].["+a+"]"+(c===1?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+",["+d+"])","End Property");c!==2&&n.push("Public Property Let ["+
d+"](val)",c=(c===4?"Set [(accessors)].["+a+"]=val":b&&(c!==1||b.set)?"Call [(accessors)].["+a+"]"+(c===1?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+d+"](val)",c)}else{var e=function(a){((c===1?b.set:b)||O(d,1)).call(this,a,b)},g=function(){return((c===1?b.get:b)||O(d,0)).call(this,b)};C.call(f,a)&&delete f[a];if(E){a=A.getOwnPropertyDescriptor(f,d);E(f,d,{enumerable:F?0:1,configurable:1,set:c===2&&a&&a.set||e,get:c===3&&a&&a.get||g})}else{f.__defineSetter__(d,
c===2&&f.__lookupSetter__(d)||e);f.__defineGetter__(d,c===3&&f.__lookupGetter__(d)||g)}}}else if(x){if(q.length===50){n.push("Public ["+q.join("],[")+"]");q.length=0}q[q.length]=a}},y);y&&!(y=0)&&0===I?q=n=w=0:x&&(I&&(t="StaticClass"+G+F++,n.unshift("Class "+t),n.push((q.length?"Public ["+q.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+t+"FactoryJS()","End Sub","End Class","Function "+t+"Factory()","Set "+t+"Factory=New "+t,"End Function"),c[t+
"FactoryJS"]=function(){return n},c.execVBScript(n.join("\n")),I=q=n=o),n={},l.a=c[t+"Factory"](),z(f,function(a,b){if(w.hasOwnProperty(a))if(w[a]===1){s.prototype=f[a];n[a]=new s}else n[a]=f[a];else l.a[a]=(!H||h)&&typeof b==="function"&&a!=="__class__"?function(){return b.apply(this===f||this==c?l.a:this,arguments)}:b},1),f=l.a)}C.call(f,r)?l.i=f[r]:C.call(f,"constructor")&&(l.i=f.constructor);return new function(){!a&&typeof l.i==="function"&&l.i.apply(f,d);return f}}var i,m,u,x=F,y=1,b=arguments,
e=b.length-1,r="constructor",t=o,n=[],q=[],I=0,w=F===o?0:{},L,h,M,B,H,K=this instanceof a,j=b[e--]||{};if(b[e]&&"object"===typeof b[e]&&!(b[e]instanceof D)&&b[e].constructor&&b[e].constructor!==A.prototype.constructor){if(F&&E)try{E(b[e],"t"+G,{configurable:1,set:function(a){x=a}}),b[e]["t"+G]=0,delete b[e]["t"+G]}catch(T){}L=x?o:(B=N,b[e--])}g=!b[e]||b[e]instanceof D||"object"!==typeof b[e]?{}:b[e--];B=B||g.compact;i=g.context;m=g.extend;u=g.mixins;M=g.statics||(i||m||u||B!==J?{}:g);k=b[e]instanceof
D?b[e--]:"function"===typeof b[e]?[b[e--]]:"string"===typeof b[e-1]&&(""+b[e--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];h="string"===typeof b[e]&&b[e--].split(/extends|implements|,/g)||[];p=b[e--]||i||a.NS||(a.NS=c);d=(h.shift()||"").replace(/^\s+|\s+$/g,"");i=(h=h.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?h.split(","):[];m=(m=m||[])instanceof D?m:[m];u=(u=u||[])instanceof D?u:[u];k=i.concat.apply(i,
k.concat.apply(k,m.concat.apply(m,u)));H=k.length;if("function"!==typeof j)var Q=j,j=function(){s.prototype=Q.constructor.prototype;h=new s;z(Q,function(a,b){h[a]=b});return h};v.toString=function(){return"[class "+(d||"Object")+"]"};z(M,function(a,b){v[a]=b});if(v.className=d){i=p;b=(h=d.split(".")).shift();do 0===h.length?i[r=b]=v:(b in i||(i[b]={}),i=i[b]);while(b=h.shift())}return K?new v:v};jClass.instanceOf=function(a,c){for(;a&&a.__class__!=o;){if(a.__class__===c)return N;a=a.parent}return r};
var F=function(a){function j(c){a=c}try{E(a,"t",{set:j})}catch(d){try{a.__defineSetter__("t",j)}catch(k){}}a.t=0;a&&(a=1,"execVBscript"in c||("execScript"in c?c.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"):a=o));return a}({});jClass.NS=jClass.NS||c})(window,!0,!1,null);
