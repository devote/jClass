/*
 * jClass - class definition for JavaScript v1.3.0
 *
 * Copyright 2012-2014, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 03/18/2014
 */
(function(f,T,v,p,K){function P(h,d){return function(){throw Error("'"+h+"' property is "+(d?"read":"write")+"-only");}}function r(){}function U(h,d){var f,a=h;if("string"===typeof h){for(a=h.split(".");(f=a.shift())&&(d=d[f]););a=d}"function"===typeof jClass.autoload&&(a=jClass.autoload(h,d));if("function"!==typeof a)throw Error("Parent class '"+h+"' not Initialized or Undefined");return a}function z(h,d,f){var a,l=k.length,g;for(a in h)if(g=h[a],(f&&g!==A.prototype[a]||C.call(h,a))&&d.call(g,a,
g)===v){l=v;break}if(l&&M)for(a=0;a<l&&!(g=h[k[a]],(C.call(h,k[a])||f&&k[a]in h&&g!==A.prototype[k[a]])&&d.call(g,k[a],g)===v);a++);}function Q(h){for(;h&&h.__class__!=p;){if(h.__class__===this)return h;h=h.parent}return p}var D=f.Array,A=f.Object,R=f.Boolean,E=A.defineProperty,C=A.prototype.hasOwnProperty,G=(new Date).getTime(),M=!{toString:1}.propertyIsEnumerable("toString"),k="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" ");f.jClass=function d(L,
a,l,g,k){function s(){var b=H,a=this instanceof R,d=arguments,c=p,g=new k,j=a&&d[2]||p,e=N||j||g,m=a?d[0]:{a:g},i=!a||d[1]===K||B!==K?B:d[1];for(z(O,function(V,b){g[V]=b});b--;)"string"===typeof l[b]&&(l[b]=U(l[b],L)),r.prototype=c=l[b].call(new R,m,i,j),0<b&&(m.i=p),e=j=new r,i||(e.parent=c);if(H||a||N){var n=function(b){return"function"===typeof b?function(){var I=m.a,a=I.parent;!i&&(I.parent=c);var d=b.apply(this===e||this==f?I:this,arguments);!i&&(I.parent=a);return d}:b};z(g,function(b,a){if(a&&
"object"===typeof a&&("set"in a&&(a.set=n(a.set)),"get"in a))a.get=n(a.get);e[b]=n(a)});m.a=a?m.a:e}i||(e.__class__=s);if(!a&&0!==w){if(!x||y)z(y?e:w,function(a){var b=e[a],d=a,c=!y?w[a]:b&&"object"===typeof b&&"parent"!==a&&(b.set||b.get)?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:x&&"toString"===a?4:0;if(c)if(y&&4!==(w[a]=c)&&J++,1===c?(r.prototype=b,b=new r):d=a.split(" ").pop(),x)3!==c&&o.push("Public "+(4===c?"Default ":"")+"Property Get ["+d+"]","Call VBCorrectVal("+(b&&(1!==c||b.get)?
"[(accessors)].["+a+"]"+(1===c?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+",["+d+"])","End Property"),2!==c&&o.push("Public Property Let ["+d+"](val)",c=(4===c?"Set [(accessors)].["+a+"]=val":b&&(1!==c||b.set)?"Call [(accessors)].["+a+"]"+(1===c?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+d+"](val)",c);else{var g=function(a){((c===1?b.set:b)||P(d,1)).call(this,a,b)},f=function(){return((c===1?b.get:b)||P(d,0)).call(this,b)};C.call(e,
a)&&delete e[a];E?(a=A.getOwnPropertyDescriptor(e,d),E(e,d,{enumerable:F?0:1,configurable:1,set:2===c&&a&&a.set||g,get:3===c&&a&&a.get||f})):(e.__defineSetter__(d,2===c&&e.__lookupSetter__(d)||g),e.__defineGetter__(d,3===c&&e.__lookupGetter__(d)||f))}else x&&(50===q.length&&(o.push("Public ["+q.join("],[")+"]"),q.length=0),q[q.length]=a)},y);y&&!(y=0)&&0===J?q=o=w=0:x&&(J&&(t="StaticClass"+G+F++,o.unshift("Class "+t),o.push((q.length?"Public ["+q.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()",
"Set [(accessors)]="+t+"FactoryJS()","End Sub","End Class","Function "+t+"Factory()","Set "+t+"Factory=New "+t,"End Function"),f[t+"FactoryJS"]=function(){return o},f.execVBScript(o.join("\n")),J=q=o=p),o={},m.a=f[t+"Factory"](),z(e,function(a,b){if(w.hasOwnProperty(a))if(w[a]===1){r.prototype=e[a];o[a]=new r}else o[a]=e[a];else m.a[a]=(!H||i)&&typeof b==="function"&&a!=="__class__"?function(){return b.apply(this===e||this==f?m.a:this,arguments)}:b},1),e=m.a)}C.call(e,v)?m.i=e[v]:C.call(e,"constructor")&&
(m.i=e.constructor);return new function(){!a&&"function"===typeof m.i&&m.i.apply(e,d);return e}}var j,n,u,x=F,y=1,b=arguments,c=b.length-1,v="constructor",t=p,o=[],q=[],J=0,w=F===p?0:{},N,i,O,B,H,M=this instanceof d,k=b[c--]||{};if(b[c]&&"object"===typeof b[c]&&!(b[c]instanceof D)&&b[c].constructor&&b[c].constructor!==A.prototype.constructor){if(F&&E)try{E(b[c],"t"+G,{configurable:1,set:function(a){x=a}}),b[c]["t"+G]=0,delete b[c]["t"+G]}catch(W){}N=x?p:(B=T,b[c--])}g=!b[c]||b[c]instanceof D||"object"!==
typeof b[c]?{}:b[c--];B=B||g.compact;j=g.context;n=g.extend;u=g.mixins;O=g.statics||(j||n||u||B!==K?{}:g);l=b[c]instanceof D?b[c--]:"function"===typeof b[c]?[b[c--]]:"string"===typeof b[c-1]&&(""+b[c--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];i="string"===typeof b[c]&&b[c--].split(/extends|implements|,/g)||[];L=b[c--]||j||d.NS||(d.NS=f);a=(i.shift()||"").replace(/^\s+|\s+$/g,"");j=(i=i.join(",").replace(/^[\s,]+|[\s,]+$/g,
"").replace(/\s*,\s*/g,","))?i.split(","):[];n=(n=n||[])instanceof D?n:[n];u=(u=u||[])instanceof D?u:[u];l=j.concat.apply(j,l.concat.apply(l,n.concat.apply(n,u)));H=l.length;if("function"!==typeof k)var S=k,k=function(){r.prototype=S.constructor.prototype;i=new r;z(S,function(a,b){i[a]=b});return i};s.toString=function(){return"[class "+(a||"Object")+"]"};s.getInstanceOf=Q;z(O,function(a,b){s[a]=b});if(s.className=a){j=L;b=(i=a.split(".")).shift();do 0===i.length?j[v=b]=s:(b in j||(j[b]={}),j=j[b]);
while(b=i.shift())}return M?new s:s};jClass.instanceOf=function(d,f){return!!Q.call(f,d)};var F=function(d){function k(a){d=a}try{E(d,"t",{set:k})}catch(a){try{d.__defineSetter__("t",k)}catch(l){}}d.t=0;d&&(d=1,"execVBscript"in f||("execScript"in f?f.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"):d=p));return d}({});jClass.NS=jClass.NS||f})(window,!0,!1,null);
